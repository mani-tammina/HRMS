<ion-header>
  <ion-toolbar>
    <ion-title>Profile</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="profile-container">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Loading profile...</p>
    </div>

    <!-- Profile Content -->
    <div *ngIf="!isLoading">
      <!-- Profile Header Card -->
      <ion-card class="profile-header-card">
        <div class="header-gradient">
          <ion-avatar class="profile-avatar">
            <img [src]="user?.avatar || 'assets/avatar-placeholder.png'" 
                 alt="Profile" 
                 (error)="handleImageError($event)">
          </ion-avatar>
        </div>
        <div class="profile-info">
          <h1>{{ employeeData?.FullName || user?.name }}</h1>
          <p>{{ employeeData?.WorkEmail || user?.email }}</p>
          <ion-badge [color]="employeeData?.EmploymentStatus === 'Active' ? 'success' : 'medium'">
            {{ employeeData?.EmploymentStatus || 'Active' }}
          </ion-badge>
        </div>
      </ion-card>

      <!-- User Information -->
      <ion-card>
        <ion-card-content>
          <ion-list lines="none">
            <ion-item>
              <ion-icon slot="start" name="person-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Full Name</p>
                <h3>{{ employeeData?.FullName || user?.name }}</h3>
              </ion-label>
            </ion-item>

            <ion-item *ngIf="employeeData?.EmployeeNumber">
              <ion-icon slot="start" name="card-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Employee Number</p>
                <h3>{{ employeeData?.EmployeeNumber }}</h3>
              </ion-label>
            </ion-item>

            <ion-item>
              <ion-icon slot="start" name="mail-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Email</p>
                <h3>{{ employeeData?.WorkEmail || user?.email }}</h3>
              </ion-label>
            </ion-item>

            <ion-item *ngIf="employeeData?.PhoneNumber">
              <ion-icon slot="start" name="call-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Phone Number</p>
                <h3>{{ employeeData?.PhoneNumber }}</h3>
              </ion-label>
            </ion-item>

            <ion-item *ngIf="employeeData?.department_name">
              <ion-icon slot="start" name="business-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Department</p>
                <h3>{{ employeeData?.department_name }}</h3>
              </ion-label>
            </ion-item>

            <ion-item *ngIf="employeeData?.designation_name">
              <ion-icon slot="start" name="briefcase-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Designation</p>
                <h3>{{ employeeData?.designation_name }}</h3>
              </ion-label>
            </ion-item>

            <ion-item *ngIf="employeeData?.location_name">
              <ion-icon slot="start" name="location-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Location</p>
                <h3>{{ employeeData?.location_name }}</h3>
              </ion-label>
            </ion-item>

            <ion-item *ngIf="user?.role">
              <ion-icon slot="start" name="shield-outline" color="primary"></ion-icon>
              <ion-label>
                <p>Role</p>
                <h3>{{ user?.role | titlecase }}</h3>
              </ion-label>
            </ion-item>
          </ion-list>
        </ion-card-content>
      </ion-card>

      <!-- Menu Options -->
      <ion-card>
        <ion-card-content>
          <ion-list>
            <ion-item 
              *ngFor="let item of menuItems" 
              button 
              detail="true"
              (click)="handleMenuClick(item.action)">
              <ion-icon 
                slot="start" 
                [name]="item.icon" 
                [color]="item.color || 'primary'">
              </ion-icon>
              <ion-label [color]="item.color">{{ item.label }}</ion-label>
            </ion-item>
          </ion-list>
        </ion-card-content>
      </ion-card>
    </div>
  </div>
</ion-content>
