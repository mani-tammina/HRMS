"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[173],{4173:(N,_,s)=>{s.r(_),s.d(_,{TeamPage:()=>L});var u=s(467),d=s(177),l=s(4341),i=s(7820),g=s(5312),f=s(2951),c=s(5873),e=s(4438),h=s(1626);function P(t,o){if(1&t){const n=e.RV6();e.j41(0,"ion-datetime",13),e.mxI("ngModelChange",function(a){e.eBV(n);const m=e.XpG();return e.DH7(m.selectedDate,a)||(m.selectedDate=a),e.Njj(a)}),e.bIt("ionChange",function(a){e.eBV(n);const m=e.XpG();return e.Njj(m.onDateChange(a))}),e.k0s()}if(2&t){const n=e.XpG();e.R50("ngModel",n.selectedDate),e.Y8G("max",n.maxDate)}}function M(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",14),e.nrm(2,"ion-icon",15),e.j41(3,"p"),e.EFF(4,"Loading attendance..."),e.k0s()()())}function O(t,o){if(1&t&&(e.j41(0,"div",16)(1,"div",17),e.nrm(2,"ion-icon",18),e.j41(3,"div",19)(4,"div",20),e.EFF(5),e.k0s(),e.j41(6,"div",21),e.EFF(7,"Total Team"),e.k0s()()(),e.j41(8,"div",22),e.nrm(9,"ion-icon",23),e.j41(10,"div",19)(11,"div",20),e.EFF(12),e.k0s(),e.j41(13,"div",21),e.EFF(14,"Present"),e.k0s()()(),e.j41(15,"div",24),e.nrm(16,"ion-icon",25),e.j41(17,"div",19)(18,"div",20),e.EFF(19),e.k0s(),e.j41(20,"div",21),e.EFF(21,"Absent"),e.k0s()()(),e.j41(22,"div",26),e.nrm(23,"ion-icon",27),e.j41(24,"div",19)(25,"div",20),e.EFF(26),e.k0s(),e.j41(27,"div",21),e.EFF(28,"On Leave"),e.k0s()()()()),2&t){const n=e.XpG();e.R7$(5),e.JRh(n.teamAttendance.summary.total_team||0),e.R7$(7),e.JRh(n.teamAttendance.summary.present||0),e.R7$(7),e.JRh(n.teamAttendance.summary.absent||0),e.R7$(7),e.JRh(n.teamAttendance.summary.on_leave||0)}}function v(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",14),e.nrm(2,"ion-icon",28),e.j41(3,"p")(4,"strong"),e.EFF(5,"No team members found"),e.k0s()(),e.j41(6,"small"),e.EFF(7,"You need team members reporting to you to view attendance."),e.k0s()()())}function C(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",23),e.j41(2,"span")(3,"strong"),e.EFF(4,"Check In:"),e.k0s(),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",e.i5U(6,1,n.first_check_in,"short"),"")}}function F(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",25),e.j41(2,"span")(3,"strong"),e.EFF(4,"Check Out:"),e.k0s(),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",e.i5U(6,1,n.last_check_out,"short"),"")}}function b(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",37),e.j41(2,"span")(3,"strong"),e.EFF(4,"Work Hours:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.gross_hours,"h")}}function E(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",38),e.j41(2,"span")(3,"strong"),e.EFF(4,"Mode:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_mode,"")}}function T(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",39),e.j41(2,"span")(3,"strong"),e.EFF(4,"Total Punches:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.total_punches,"")}}function y(t,o){if(1&t&&(e.j41(0,"ion-card",30)(1,"ion-card-content")(2,"div",31)(3,"div",32)(4,"strong"),e.EFF(5),e.k0s(),e.j41(6,"small"),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",33),e.EFF(9),e.k0s()(),e.j41(10,"div",34),e.DNE(11,C,7,4,"div",35)(12,F,7,4,"div",35)(13,b,6,1,"div",35)(14,E,6,1,"div",35)(15,T,6,1,"div",35),e.k0s()()()),2&t){const n=o.$implicit,r=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.JRh(n.EmployeeNumber),e.R7$(),e.Y8G("color",r.getAttendanceStatusColor(n.status)),e.R7$(),e.SpI(" ",n.status," "),e.R7$(2),e.Y8G("ngIf",n.first_check_in),e.R7$(),e.Y8G("ngIf",n.last_check_out),e.R7$(),e.Y8G("ngIf",n.gross_hours),e.R7$(),e.Y8G("ngIf",n.work_mode),e.R7$(),e.Y8G("ngIf",n.total_punches)}}function x(t,o){if(1&t&&(e.j41(0,"div"),e.DNE(1,y,16,10,"ion-card",29),e.k0s()),2&t){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.teamAttendance.attendance)}}function R(t,o){1&t&&e.nrm(0,"div",40)}function k(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",14),e.nrm(2,"ion-icon",28),e.j41(3,"p"),e.EFF(4,"Loading team members..."),e.k0s()()())}function j(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",14),e.nrm(2,"ion-icon",28),e.j41(3,"p"),e.EFF(4,"No team members found"),e.k0s(),e.j41(5,"small"),e.EFF(6,"You may not have any team members reporting to you, or you may not be part of a team yet."),e.k0s()()())}function $(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",45),e.j41(2,"span")(3,"strong"),e.EFF(4,"Designation:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.designation_name,"")}}function I(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",46),e.j41(2,"span")(3,"strong"),e.EFF(4,"Department:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.department_name,"")}}function D(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",38),e.j41(2,"span")(3,"strong"),e.EFF(4,"Location:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.location_name,"")}}function G(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",47),e.j41(2,"span")(3,"strong"),e.EFF(4,"Personal Email:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.PersonalEmail,"")}}function A(t,o){if(1&t&&(e.j41(0,"div",36),e.nrm(1,"ion-icon",48),e.j41(2,"span")(3,"strong"),e.EFF(4,"Contact:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.ContactNumber,"")}}function w(t,o){if(1&t){const n=e.RV6();e.j41(0,"ion-card",41),e.bIt("click",function(){const a=e.eBV(n).$implicit,m=e.XpG();return e.Njj(m.viewMemberDetails(a))}),e.j41(1,"ion-card-header")(2,"div",42)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",43),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",33),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"div",44),e.DNE(12,$,6,1,"div",35)(13,I,6,1,"div",35)(14,D,6,1,"div",35)(15,G,6,1,"div",35)(16,A,6,1,"div",35),e.k0s()()()}if(2&t){const n=o.$implicit;e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(),e.Y8G("color","Working"===n.EmploymentStatus?"success":"medium"),e.R7$(),e.SpI(" ",n.EmploymentStatus," "),e.R7$(3),e.Y8G("ngIf",n.designation_name),e.R7$(),e.Y8G("ngIf",n.department_name),e.R7$(),e.Y8G("ngIf",n.location_name),e.R7$(),e.Y8G("ngIf",n.PersonalEmail),e.R7$(),e.Y8G("ngIf",n.ContactNumber)}}let L=(()=>{class t{constructor(n,r){this.http=n,this.toastController=r,this.teamMembers=[],this.teamInfo=null,this.isLoading=!1,this.isLoadingAttendance=!1,this.selectedDate=(new Date).toISOString().split("T")[0],this.maxDate=(new Date).toISOString(),this.userRole="",this.isManagerOrHR=!1,this.teamAttendance={team_members:[],attendance:[],date:(new Date).toISOString().split("T")[0],summary:{total_team:0,present:0,absent:0,on_leave:0}},(0,f.d)({peopleOutline:c.wx_,briefcaseOutline:c.vOb,businessOutline:c.FL4,locationOutline:c.UN$,mailOutline:c.SM1,callOutline:c.bNN,analyticsOutline:c.jwg,checkmarkCircleOutline:c.gz2,closeCircleOutline:c.p9N,hourglassOutline:c.pGP,fingerPrintOutline:c.RBE})}ngOnInit(){this.loadUserRole(),this.loadTeamMembers(),this.loadTeamAttendance()}loadUserRole(){const n=JSON.parse(localStorage.getItem("user")||"{}");this.userRole=n.role||"",this.isManagerOrHR=["manager","hr","admin"].includes(this.userRole),console.log("User role:",this.userRole,"isManagerOrHR:",this.isManagerOrHR)}loadTeamMembers(){this.isLoading=!0,console.log("Loading team members from:",`${g.c.apiUrl}/employees/my-team/list`),this.http.get(`${g.c.apiUrl}/employees/my-team/list`).subscribe({next:n=>{console.log("Team members loaded successfully:",n),this.teamMembers=n.team||[],this.teamInfo=n,this.isLoading=!1},error:n=>{console.error("Error loading team members:",n),this.showToast(n.error?.error||n.message||"Error loading team members","danger"),this.isLoading=!1}})}handleRefresh(n){this.loadTeamMembers(),this.loadTeamAttendance(),setTimeout(()=>n.target.complete(),1e3)}viewMemberDetails(n){console.log("View member details:",n),this.showToast(`Viewing ${n.FirstName} ${n.LastName}`,"primary")}loadTeamAttendance(){this.isLoadingAttendance=!0,console.log(`Fetching team attendance for date: ${this.selectedDate}`),this.http.get(`${g.c.apiUrl}/attendance/report/team?date=${this.selectedDate}`).subscribe({next:n=>{this.teamAttendance=n||{team_members:[],attendance:[],date:this.selectedDate,summary:{total_team:0,present:0,absent:0,on_leave:0}},this.isLoadingAttendance=!1,console.log("Team attendance loaded:",this.teamAttendance)},error:n=>{this.isLoadingAttendance=!1,console.error("Error loading team attendance:",n),this.showToast(`Error loading team attendance: ${n.error?.error||n.message}`,"danger")}})}onDateChange(n){this.selectedDate=n.detail.value.split("T")[0],this.loadTeamAttendance()}getAttendanceStatusColor(n){return{present:"success",absent:"danger","on-leave":"warning",holiday:"medium","week-off":"medium"}[n]||"medium"}showToast(n){var r=this;return(0,u.A)(function*(a,m="primary"){yield(yield r.toastController.create({message:a,duration:2e3,color:m,position:"bottom"})).present()}).apply(this,arguments)}static{this.\u0275fac=function(r){return new(r||t)(e.rXU(h.Qq),e.rXU(i.K_))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-team"]],standalone:!0,features:[e.aNF],decls:27,vars:13,consts:[[3,"translucent"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"team-container"],[1,"attendance-section"],[1,"section-header"],["name","analytics-outline"],["presentation","date","size","small",3,"ngModel","max","ngModelChange","ionChange",4,"ngIf"],[4,"ngIf"],["class","summary-grid",4,"ngIf"],["class","divider",4,"ngIf"],["color","primary"],["class","team-card","button","",3,"click",4,"ngFor","ngForOf"],["presentation","date","size","small",3,"ngModelChange","ionChange","ngModel","max"],[1,"empty-state"],["name","hourglass-outline","size","large","color","medium"],[1,"summary-grid"],[1,"summary-card",2,"background","linear-gradient(135deg, #667eea 0%, #764ba2 100%)"],["name","people-outline"],[1,"summary-content"],[1,"summary-value",2,"color","white"],[1,"summary-label",2,"color","rgba(255,255,255,0.9)"],[1,"summary-card",2,"background","linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"],["name","checkmark-circle-outline"],[1,"summary-card",2,"background","linear-gradient(135deg, #fa709a 0%, #fee140 100%)"],["name","close-circle-outline"],[1,"summary-card",2,"background","linear-gradient(135deg, #30cfd0 0%, #330867 100%)"],["name","calendar-outline"],["name","people-outline","size","large","color","medium"],["class","attendance-card",4,"ngFor","ngForOf"],[1,"attendance-card"],[1,"attendance-info"],[1,"employee-info"],[3,"color"],[1,"attendance-details"],["class","detail-row",4,"ngIf"],[1,"detail-row"],["name","hourglass-outline"],["name","location-outline"],["name","finger-print-outline"],[1,"divider"],["button","",1,"team-card",3,"click"],[1,"card-header-content"],[1,"employee-details"],[1,"member-details"],["name","briefcase-outline"],["name","business-outline"],["name","mail-outline"],["name","call-outline"]],template:function(r,a){1&r&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"My Team"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-refresher",2),e.bIt("ionRefresh",function(p){return a.handleRefresh(p)}),e.nrm(6,"ion-refresher-content"),e.k0s(),e.j41(7,"div",3)(8,"div",4)(9,"div",5)(10,"h3"),e.nrm(11,"ion-icon",6),e.EFF(12," Today's Team Attendance "),e.k0s(),e.DNE(13,P,1,2,"ion-datetime",7),e.k0s(),e.DNE(14,M,5,0,"ion-card",8)(15,O,29,4,"div",9)(16,v,8,0,"ion-card",8)(17,x,2,1,"div",8),e.k0s(),e.DNE(18,R,1,0,"div",10),e.j41(19,"div",5)(20,"h3"),e.EFF(21),e.k0s(),e.j41(22,"ion-badge",11),e.EFF(23),e.k0s()(),e.DNE(24,k,5,0,"ion-card",8)(25,j,7,0,"ion-card",8)(26,w,17,11,"ion-card",12),e.k0s()()),2&r&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(9),e.Y8G("ngIf",a.isManagerOrHR),e.R7$(),e.Y8G("ngIf",a.isLoadingAttendance),e.R7$(),e.Y8G("ngIf",!a.isLoadingAttendance&&(null==a.teamAttendance?null:a.teamAttendance.summary)),e.R7$(),e.Y8G("ngIf",!a.isLoadingAttendance&&a.teamAttendance&&a.teamAttendance.summary&&0===a.teamAttendance.summary.total_team),e.R7$(),e.Y8G("ngIf",!a.isLoadingAttendance&&(null==a.teamAttendance?null:a.teamAttendance.attendance)&&a.teamAttendance.attendance.length>0),e.R7$(),e.Y8G("ngIf",a.teamMembers.length>0),e.R7$(3),e.JRh((null==a.teamInfo?null:a.teamInfo.message)||"Team Members"),e.R7$(2),e.JRh(a.teamMembers.length),e.R7$(),e.Y8G("ngIf",a.isLoading),e.R7$(),e.Y8G("ngIf",!a.isLoading&&0===a.teamMembers.length),e.R7$(),e.Y8G("ngForOf",a.teamMembers))},dependencies:[d.MD,d.Sq,d.bT,d.vh,l.YN,l.BC,l.vS,i.W9,i.eU,i.BC,i.ai,i.To,i.Ki,i.b_,i.ME,i.tN,i.I9,i.In,i.iq,i.A9],styles:[".team-container[_ngcontent-%COMP%]{padding:16px;max-width:1200px;margin:0 auto}.attendance-section[_ngcontent-%COMP%]{margin-bottom:24px}.divider[_ngcontent-%COMP%]{height:1px;background:var(--ion-color-light);margin:32px 0}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding:0 4px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2em;font-weight:600;display:flex;align-items:center;gap:8px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.section-header[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{max-width:140px}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-bottom:20px}.summary-card[_ngcontent-%COMP%]{border-radius:12px;padding:16px;text-align:center;box-shadow:0 4px 12px #0000001a;transition:transform .2s}.summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.summary-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;margin-bottom:8px;display:block;opacity:.9}.summary-card[_ngcontent-%COMP%]   .summary-content[_ngcontent-%COMP%]{color:#fff}.summary-card[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:2em;font-weight:700;margin-bottom:4px}.summary-card[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:.85em;opacity:.95}.attendance-card[_ngcontent-%COMP%]{margin-bottom:12px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.attendance-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid var(--ion-color-light)}.attendance-info[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:1em;margin-bottom:4px}.attendance-info[_ngcontent-%COMP%]   .employee-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.85em}.attendance-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:6px 0;font-size:.9em}.attendance-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:1.1em;flex-shrink:0}.attendance-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-dark)}.attendance-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-weight:500}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;font-size:1em;font-weight:500}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--ion-color-medium-shade)}.team-card[_ngcontent-%COMP%]{margin-bottom:12px;border-radius:12px;box-shadow:0 2px 8px #0000001a;transition:transform .2s,box-shadow .2s}.team-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.card-header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:12px}.card-header-content[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:600;margin-bottom:4px}.employee-details[_ngcontent-%COMP%]{font-size:.85em;color:var(--ion-color-medium);margin:0}.member-details[_ngcontent-%COMP%]{margin-top:8px}.member-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:6px 0;font-size:.9em}.member-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:1.1em;flex-shrink:0}.member-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-dark)}.member-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-weight:500}@media (max-width: 768px){.team-container[_ngcontent-%COMP%]{padding:12px}.card-header-content[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})}}return t})()}}]);