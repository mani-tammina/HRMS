"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4561],{4561:(v,p,c)=>{c.r(p),c.d(p,{MasterDataPage:()=>F});var l=c(467),g=c(177),m=c(4341),o=c(7820),u=c(2951),_=c(5873),e=c(4438),h=c(3741);function M(i,s){if(1&i&&(e.j41(0,"ion-select-option",10),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.SpI(" ",t.name," ")}}function f(i,s){if(1&i&&(e.j41(0,"p",31),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI("Code: ",t.code,"")}}function D(i,s){if(1&i&&(e.j41(0,"p",32),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.description)}}function C(i,s){if(1&i&&(e.j41(0,"ion-badge",33),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.Y8G("color",t.is_active?"success":"danger"),e.R7$(),e.SpI(" ",t.is_active?"Active":"Inactive"," ")}}function y(i,s){if(1&i){const t=e.RV6();e.j41(0,"ion-card",19)(1,"ion-card-content")(2,"div",20)(3,"div",21)(4,"h3"),e.EFF(5),e.k0s(),e.DNE(6,f,2,1,"p",22)(7,D,2,1,"p",23),e.k0s(),e.j41(8,"div",24),e.DNE(9,C,2,2,"ion-badge",25),e.k0s()(),e.j41(10,"div",26)(11,"ion-button",27),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.openEditModal(n))}),e.nrm(12,"ion-icon",28),e.EFF(13," Edit "),e.k0s(),e.j41(14,"ion-button",29),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.deleteItem(n))}),e.nrm(15,"ion-icon",30),e.EFF(16," Delete "),e.k0s()()()()}if(2&i){const t=s.$implicit;e.R7$(5),e.JRh(t.name),e.R7$(),e.Y8G("ngIf",t.code),e.R7$(),e.Y8G("ngIf",t.description),e.R7$(2),e.Y8G("ngIf",void 0!==t.is_active)}}function b(i,s){if(1&i&&(e.j41(0,"div",34),e.nrm(1,"ion-icon",35),e.j41(2,"h3"),e.EFF(3,"No records found"),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(5),e.JRh(t.searchTerm?"Try a different search term":"Click + to add new record")}}function P(i,s){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"ion-searchbar",11),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.searchTerm,n)||(r.searchTerm=n),e.Njj(n)}),e.bIt("ionInput",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.searchData())}),e.k0s(),e.j41(2,"div",12)(3,"ion-badge",0),e.EFF(4),e.k0s(),e.j41(5,"span",13),e.EFF(6),e.k0s()(),e.j41(7,"ion-card",14)(8,"ion-card-content")(9,"strong"),e.EFF(10,"Debug Info:"),e.k0s(),e.nrm(11,"br"),e.EFF(12),e.nrm(13,"br"),e.EFF(14),e.nrm(15,"br"),e.EFF(16),e.nrm(17,"br"),e.EFF(18),e.k0s()(),e.DNE(19,y,17,4,"ion-card",15)(20,b,6,1,"div",8),e.j41(21,"ion-fab",16)(22,"ion-fab-button",17),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.openCreateModal())}),e.nrm(23,"ion-icon",18),e.k0s()()()}if(2&i){const t=e.XpG();e.R7$(),e.R50("ngModel",t.searchTerm),e.R7$(3),e.SpI("",t.filteredData.length," records"),e.R7$(2),e.JRh(t.getSelectedTypeName()),e.R7$(6),e.SpI(" masterData.length: ",t.masterData.length,""),e.R7$(2),e.SpI(" filteredData.length: ",t.filteredData.length,""),e.R7$(2),e.SpI(" isLoading: ",t.isLoading,""),e.R7$(2),e.SpI(" selectedType: ",t.selectedType," "),e.R7$(),e.Y8G("ngForOf",t.filteredData),e.R7$(),e.Y8G("ngIf",0===t.filteredData.length&&!t.isLoading)}}function T(i,s){1&i&&(e.j41(0,"div",34),e.nrm(1,"ion-icon",36),e.j41(2,"h3"),e.EFF(3,"Select a Master Data Type"),e.k0s(),e.j41(4,"p"),e.EFF(5,"Choose a type from the dropdown above to manage data"),e.k0s()())}function E(i,s){if(1&i){const t=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2,"Active"),e.k0s(),e.j41(3,"ion-toggle",42),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG(2);return e.DH7(r.currentItem.is_active,n)||(r.currentItem.is_active=n),e.Njj(n)}),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.currentItem.is_active)}}function I(i,s){if(1&i){const t=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-buttons",37)(5,"ion-button",17),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.closeModal())}),e.EFF(6,"Close"),e.k0s()()()(),e.j41(7,"ion-content",3)(8,"ion-list")(9,"ion-item")(10,"ion-label",4),e.EFF(11,"Name *"),e.k0s(),e.j41(12,"ion-input",38),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.currentItem.name,n)||(r.currentItem.name=n),e.Njj(n)}),e.k0s()(),e.j41(13,"ion-item")(14,"ion-label",4),e.EFF(15,"Code"),e.k0s(),e.j41(16,"ion-input",39),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.currentItem.code,n)||(r.currentItem.code=n),e.Njj(n)}),e.k0s()(),e.j41(17,"ion-item")(18,"ion-label",4),e.EFF(19,"Description"),e.k0s(),e.j41(20,"ion-textarea",40),e.mxI("ngModelChange",function(n){e.eBV(t);const r=e.XpG();return e.DH7(r.currentItem.description,n)||(r.currentItem.description=n),e.Njj(n)}),e.k0s()(),e.DNE(21,E,4,1,"ion-item",7),e.k0s(),e.j41(22,"ion-button",41),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.saveItem())}),e.EFF(23),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(3),e.Lme("",t.isEditMode?"Edit":"Create"," ",t.getSelectedTypeName(),""),e.R7$(9),e.R50("ngModel",t.currentItem.name),e.R7$(4),e.R50("ngModel",t.currentItem.code),e.R7$(4),e.R50("ngModel",t.currentItem.description),e.R7$(),e.Y8G("ngIf",t.hasActiveField()),e.R7$(2),e.SpI(" ",t.isEditMode?"Update":"Create"," ")}}let F=(()=>{class i{constructor(t,a,n,r,d){this.masterDataService=t,this.loadingController=a,this.toastController=n,this.alertController=r,this.modalController=d,this.selectedType="",this.masterData=[],this.filteredData=[],this.isLoading=!1,this.searchTerm="",this.showModal=!1,this.isEditMode=!1,this.currentItem={},this.masterDataTypes=[{id:"locations",name:"Locations",icon:"location"},{id:"departments",name:"Departments",icon:"business"},{id:"designations",name:"Designations",icon:"briefcase"},{id:"business-units",name:"Business Units",icon:"git-network"},{id:"legal-entities",name:"Legal Entities",icon:"document-text"},{id:"cost-centers",name:"Cost Centers",icon:"cash"},{id:"sub-departments",name:"Sub Departments",icon:"git-branch"},{id:"bands",name:"Bands",icon:"ribbon"},{id:"pay-grades",name:"Pay Grades",icon:"trending-up"},{id:"leave-plans",name:"Leave Plans",icon:"calendar"},{id:"shift-policies",name:"Shift Policies",icon:"time"},{id:"weekly-off-policies",name:"Weekly Off Policies",icon:"calendar-clear"},{id:"attendance-policies",name:"Attendance Policies",icon:"checkmark-done"},{id:"attendance-capture-schemes",name:"Attendance Capture Schemes",icon:"finger-print"},{id:"holiday-lists",name:"Holiday Lists",icon:"sunny"},{id:"expense-policies",name:"Expense Policies",icon:"wallet"}],(0,u.d)({addOutline:_.EKF,createOutline:_.hmR,trashOutline:_.P1A,searchOutline:_.jBE})}ngOnInit(){}onTypeChange(){this.selectedType&&this.loadMasterData()}loadMasterData(){var t=this;return(0,l.A)(function*(){console.log(`=== Loading master data for type: ${t.selectedType} ===`),t.isLoading=!0;const a=yield t.loadingController.create({message:"Loading data..."});yield a.present(),t.masterDataService.getMasterData(t.selectedType).subscribe({next:n=>{console.log(`Master data response for ${t.selectedType}:`,n),console.log("Data type:",typeof n),console.log("Is array:",Array.isArray(n)),t.masterData=Array.isArray(n)?n:[],t.filteredData=t.masterData,console.log(`Loaded ${t.masterData.length} records`),console.log("First record:",t.masterData[0]),t.isLoading=!1,a.dismiss()},error:n=>{console.error("Error loading master data:",n),t.isLoading=!1,a.dismiss(),t.showToast("Failed to load data","danger")}})})()}searchData(){if(!this.searchTerm)return void(this.filteredData=this.masterData);const t=this.searchTerm.toLowerCase();this.filteredData=this.masterData.filter(a=>a.name?.toLowerCase().includes(t)||a.code?.toLowerCase().includes(t)||a.description?.toLowerCase().includes(t))}openCreateModal(){this.isEditMode=!1,this.currentItem={},this.hasActiveField()&&(this.currentItem.is_active=!0),this.showModal=!0}openEditModal(t){this.isEditMode=!0,this.currentItem={...t},this.showModal=!0}closeModal(){this.showModal=!1,this.currentItem={}}saveItem(){var t=this;return(0,l.A)(function*(){if(!t.currentItem.name||""===t.currentItem.name.trim())return void t.showToast("Name is required","warning");const a=yield t.loadingController.create({message:t.isEditMode?"Updating...":"Creating..."});yield a.present(),t.isEditMode?t.masterDataService.updateMasterData(t.selectedType,t.currentItem.id,t.currentItem).subscribe({next:()=>{a.dismiss(),t.showToast("Updated successfully","success"),t.closeModal(),t.loadMasterData()},error:n=>{a.dismiss(),t.showToast("Failed to update","danger")}}):t.masterDataService.createMasterData(t.selectedType,t.currentItem).subscribe({next:()=>{a.dismiss(),t.showToast("Created successfully","success"),t.closeModal(),t.loadMasterData()},error:n=>{a.dismiss(),t.showToast("Failed to create","danger")}})})()}deleteItem(t){var a=this;return(0,l.A)(function*(){yield(yield a.alertController.create({header:"Confirm Delete",message:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>{a.confirmDelete(t.id)}}]})).present()})()}confirmDelete(t){var a=this;return(0,l.A)(function*(){const n=yield a.loadingController.create({message:"Deleting..."});yield n.present(),a.masterDataService.deleteMasterData(a.selectedType,t).subscribe({next:()=>{n.dismiss(),a.showToast("Deleted successfully","success"),a.loadMasterData()},error:r=>{n.dismiss(),a.showToast("Failed to delete","danger")}})})()}getSelectedTypeName(){const t=this.masterDataTypes.find(a=>a.id===this.selectedType);return t?t.name:""}hasActiveField(){return"leave-plans"===this.selectedType||"shift-policies"===this.selectedType}showToast(t,a){var n=this;return(0,l.A)(function*(){yield(yield n.toastController.create({message:t,duration:3e3,color:a,position:"bottom"})).present()})()}static{this.\u0275fac=function(a){return new(a||i)(e.rXU(h.u),e.rXU(o.Xi),e.rXU(o.K_),e.rXU(o.hG),e.rXU(o.W3))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-master-data"]],standalone:!0,features:[e.aNF],decls:21,vars:5,consts:[["color","primary"],["slot","start"],["defaultHref","/admin/dashboard"],[1,"ion-padding"],["position","stacked"],["placeholder","Choose a type",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"didDismiss","isOpen"],[3,"value"],["placeholder","Search by name, code or description","animated","",3,"ngModelChange","ionInput","ngModel"],[1,"data-summary"],[1,"type-name"],["color","light",2,"margin","8px"],["class","data-card",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"click"],["name","add-outline"],[1,"data-card"],[1,"card-header"],[1,"item-info"],["class","code",4,"ngIf"],["class","description",4,"ngIf"],[1,"item-actions"],[3,"color",4,"ngIf"],[1,"action-buttons"],["fill","outline","size","small",3,"click"],["name","create-outline","slot","start"],["fill","outline","color","danger","size","small",3,"click"],["name","trash-outline","slot","start"],[1,"code"],[1,"description"],[3,"color"],[1,"empty-state"],["name","search-outline"],["name","settings-outline"],["slot","end"],["placeholder","Enter name","required","",3,"ngModelChange","ngModel"],["placeholder","Enter code",3,"ngModelChange","ngModel"],["placeholder","Enter description","rows","3",3,"ngModelChange","ngModel"],["expand","block",1,"save-btn",3,"click"],["slot","end",3,"ngModelChange","ngModel"]],template:function(a,n){1&a&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Master Data Management"),e.k0s()()(),e.j41(6,"ion-content",3)(7,"ion-card")(8,"ion-card-header")(9,"ion-card-title"),e.EFF(10,"Select Master Data Type"),e.k0s()(),e.j41(11,"ion-card-content")(12,"ion-item")(13,"ion-label",4),e.EFF(14,"Master Data Type"),e.k0s(),e.j41(15,"ion-select",5),e.mxI("ngModelChange",function(d){return e.DH7(n.selectedType,d)||(n.selectedType=d),d}),e.bIt("ionChange",function(){return n.onTypeChange()}),e.DNE(16,M,2,2,"ion-select-option",6),e.k0s()()()(),e.DNE(17,P,24,9,"div",7)(18,T,6,0,"div",8),e.k0s(),e.j41(19,"ion-modal",9),e.bIt("didDismiss",function(){return n.closeModal()}),e.DNE(20,I,24,7,"ng-template"),e.k0s()),2&a&&(e.R7$(15),e.R50("ngModel",n.selectedType),e.R7$(),e.Y8G("ngForOf",n.masterDataTypes),e.R7$(),e.Y8G("ngIf",n.selectedType),e.R7$(),e.Y8G("ngIf",!n.selectedType),e.R7$(),e.Y8G("isOpen",n.showModal))},dependencies:[g.MD,g.Sq,g.bT,m.YN,m.BC,m.YS,m.vS,o.W9,o.eU,o.BC,o.ai,o.QW,o.el,o.b_,o.I9,o.ME,o.tN,o.nf,o.uz,o.he,o.Jm,o.iq,o.Q8,o.YW,o.Nm,o.Ip,o.$w,o.nc,o.BY,o.Sb,o.S1,o.In],styles:[".data-summary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem;background:var(--ion-color-light);border-radius:8px;margin-bottom:1rem}.data-summary[_ngcontent-%COMP%]   .type-name[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-dark)}.data-card[_ngcontent-%COMP%]{margin-bottom:1rem}.data-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.data-card[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]{flex:1}.data-card[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin:0 0 .5rem;color:var(--ion-color-dark)}.data-card[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{font-size:.85rem;color:var(--ion-color-medium);margin:.25rem 0;font-family:monospace}.data-card[_ngcontent-%COMP%]   .item-info[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium);margin:.5rem 0 0}.data-card[_ngcontent-%COMP%]   .item-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end}.data-card[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-end;padding-top:.5rem;border-top:1px solid var(--ion-color-light)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;margin:1rem 0 .5rem;color:var(--ion-color-dark)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem}.save-btn[_ngcontent-%COMP%]{margin-top:2rem}ion-modal[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background:transparent}ion-modal[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: var(--ion-color-light);margin-bottom:1rem;border-radius:8px}ion-searchbar[_ngcontent-%COMP%]{padding:0;margin-bottom:1rem}ion-fab-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}"]})}}return i})()}}]);