"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[706],{6706:(w,_,a)=>{a.r(_),a.d(_,{RegisterPage:()=>b});var d=a(467),l=a(4341),p=a(3799),i=a(9907),f=a(177),h=a(5312),y=a(2951),u=a(5873),e=a(4438),P=a(8010),E=a(1626);function v(r,g){if(1&r){const t=e.RV6();e.j41(0,"div")(1,"ion-text",7)(2,"p"),e.EFF(3,"Enter your work email to verify your employee record."),e.k0s()(),e.j41(4,"form",8)(5,"ion-item"),e.nrm(6,"ion-icon",9)(7,"ion-input",10),e.k0s(),e.j41(8,"ion-button",11),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.checkEmployee())}),e.nrm(9,"ion-icon",12),e.EFF(10," Verify Email "),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(4),e.Y8G("formGroup",t.registerForm)}}function k(r,g){if(1&r&&(e.j41(0,"div",26)(1,"ion-text",27)(2,"strong"),e.EFF(3,"Department:"),e.k0s()(),e.j41(4,"ion-text"),e.EFF(5),e.k0s()()),2&r){const t=e.XpG(3);e.R7$(5),e.JRh(t.employeeData.Department)}}function x(r,g){if(1&r&&(e.j41(0,"div",26)(1,"ion-text",27)(2,"strong"),e.EFF(3,"Designation:"),e.k0s()(),e.j41(4,"ion-text"),e.EFF(5),e.k0s()()),2&r){const t=e.XpG(3);e.R7$(5),e.JRh(t.employeeData.Designation)}}function C(r,g){if(1&r&&(e.j41(0,"div",23)(1,"ion-text",24)(2,"h3"),e.nrm(3,"ion-icon",25),e.EFF(4," Employee Verified "),e.k0s()(),e.j41(5,"div",26)(6,"ion-text",27)(7,"strong"),e.EFF(8,"Name:"),e.k0s()(),e.j41(9,"ion-text"),e.EFF(10),e.k0s()(),e.j41(11,"div",26)(12,"ion-text",27)(13,"strong"),e.EFF(14,"Employee No:"),e.k0s()(),e.j41(15,"ion-text"),e.EFF(16),e.k0s()(),e.DNE(17,k,6,1,"div",28)(18,x,6,1,"div",28),e.k0s()),2&r){const t=e.XpG(2);e.R7$(10),e.JRh(t.employeeData.FullName),e.R7$(6),e.JRh(t.employeeData.EmployeeNumber),e.R7$(),e.Y8G("ngIf",t.employeeData.Department),e.R7$(),e.Y8G("ngIf",t.employeeData.Designation)}}function F(r,g){1&r&&(e.j41(0,"ion-text",29)(1,"small"),e.EFF(2,"Password must be at least 6 characters"),e.k0s()())}function M(r,g){1&r&&(e.j41(0,"ion-text",29)(1,"small"),e.EFF(2,"Passwords do not match"),e.k0s()())}function O(r,g){if(1&r){const t=e.RV6();e.j41(0,"div"),e.DNE(1,C,19,4,"div",13),e.j41(2,"ion-text",7)(3,"p"),e.EFF(4,"Create a password for your account."),e.k0s()(),e.j41(5,"form",8)(6,"ion-item"),e.nrm(7,"ion-icon",9)(8,"ion-input",14),e.k0s(),e.j41(9,"ion-item"),e.nrm(10,"ion-icon",15)(11,"ion-input",16),e.k0s(),e.DNE(12,F,3,0,"ion-text",17),e.j41(13,"ion-item"),e.nrm(14,"ion-icon",15)(15,"ion-input",18),e.k0s(),e.DNE(16,M,3,0,"ion-text",17),e.j41(17,"div",19)(18,"ion-button",20),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetForm())}),e.EFF(19," Back "),e.k0s(),e.j41(20,"ion-button",21),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.createUser())}),e.nrm(21,"ion-icon",22),e.EFF(22," Create Account "),e.k0s()()()()}if(2&r){let t,o;const n=e.XpG();e.R7$(),e.Y8G("ngIf",n.employeeData),e.R7$(4),e.Y8G("formGroup",n.registerForm),e.R7$(7),e.Y8G("ngIf",(null==(t=n.registerForm.get("password"))?null:t.hasError("minlength"))&&(null==(t=n.registerForm.get("password"))?null:t.touched)),e.R7$(4),e.Y8G("ngIf",(null==(o=n.registerForm.get("confirmPassword"))?null:o.hasError("passwordMismatch"))&&(null==(o=n.registerForm.get("confirmPassword"))?null:o.touched)),e.R7$(4),e.Y8G("disabled",n.registerForm.invalid)}}let b=(()=>{class r{constructor(t,o,n,c,s,m){this.fb=t,this.authService=o,this.http=n,this.router=c,this.toastController=s,this.loadingController=m,this.isLoading=!1,this.employeeChecked=!1,this.employeeData=null,this.currentStep="check",(0,y.d)({mailOutline:u.SM1,lockClosedOutline:u.eso,checkmarkCircleOutline:u.gz2,personOutline:u.wAZ}),this.registerForm=this.fb.group({email:["",[l.k0.required,l.k0.email]],password:["",[l.k0.required,l.k0.minLength(6)]],confirmPassword:["",[l.k0.required]]},{validators:this.passwordMatchValidator})}passwordMatchValidator(t){const o=t.get("password"),n=t.get("confirmPassword");return o&&n&&o.value!==n.value?(n.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}checkEmployee(){var t=this;return(0,d.A)(function*(){const o=t.registerForm.get("email")?.value;if(!o)return void(yield t.showToast("Please enter your work email","warning"));const n=yield t.loadingController.create({message:"Checking employee record..."});var c;yield n.present(),t.http.get(`${h.c.apiUrl}/auth/employee/check?email=${o}`).subscribe({next:(c=(0,d.A)(function*(s){n.dismiss(),s.found?s.hasUserAccount?(yield t.showToast("User account already exists. Please login instead.","warning"),t.router.navigate(["/login"])):(t.employeeChecked=!0,t.employeeData=s.employee,t.currentStep="create",yield t.showToast("Employee found! Please set your password.","success")):yield t.showToast("Employee not found with this email. Please contact HR.","danger")}),function(m){return c.apply(this,arguments)}),error:function(){var c=(0,d.A)(function*(s){n.dismiss(),yield t.showToast(s.error?.message||"Failed to check employee record","danger")});return function(m){return c.apply(this,arguments)}}()})})()}createUser(){var t=this;return(0,d.A)(function*(){if(t.registerForm.invalid)return void(yield t.showToast("Please fill all required fields correctly","warning"));const o=t.registerForm.get("email")?.value,n=t.registerForm.get("password")?.value,c=yield t.loadingController.create({message:"Creating user account..."});var s;yield c.present(),t.http.post(`${h.c.apiUrl}/auth/user/create`,{email:o,password:n,role:"employee"}).subscribe({next:(s=(0,d.A)(function*(m){c.dismiss(),yield t.showToast("Account created successfully! You can now login.","success"),t.router.navigate(["/login"])}),function(R){return s.apply(this,arguments)}),error:function(){var s=(0,d.A)(function*(m){c.dismiss(),yield t.showToast(m.error?.error||"Failed to create user account","danger")});return function(R){return s.apply(this,arguments)}}()})})()}resetForm(){this.currentStep="check",this.employeeChecked=!1,this.employeeData=null,this.registerForm.reset()}showToast(t,o){var n=this;return(0,d.A)(function*(){(yield n.toastController.create({message:t,duration:3e3,color:o,position:"top"})).present()})()}static{this.\u0275fac=function(o){return new(o||r)(e.rXU(l.ok),e.rXU(P.u),e.rXU(E.Qq),e.rXU(p.Ix),e.rXU(i.K_),e.rXU(i.Xi))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-register"]],standalone:!0,features:[e.aNF],decls:20,vars:4,consts:[["slot","start"],["defaultHref","/login"],[1,"ion-padding",3,"fullscreen"],[1,"register-container"],[4,"ngIf"],[1,"login-link"],["routerLink","/login"],["color","medium",1,"description"],[3,"formGroup"],["name","mail-outline","slot","start"],["label","Work Email","labelPlacement","floating","type","email","formControlName","email","placeholder","Enter your work email"],["expand","block",1,"register-button",3,"click"],["name","checkmark-circle-outline","slot","start"],["class","employee-info",4,"ngIf"],["label","Work Email","labelPlacement","floating","type","email","formControlName","email","readonly",""],["name","lock-closed-outline","slot","start"],["label","Password","labelPlacement","floating","type","password","formControlName","password","placeholder","Enter your password"],["color","danger","class","error-text",4,"ngIf"],["label","Confirm Password","labelPlacement","floating","type","password","formControlName","confirmPassword","placeholder","Re-enter your password"],[1,"button-group"],["expand","block","fill","outline",3,"click"],["expand","block",1,"register-button",3,"click","disabled"],["name","person-outline","slot","start"],[1,"employee-info"],["color","success"],["name","checkmark-circle-outline"],[1,"info-item"],["color","medium"],["class","info-item",4,"ngIf"],["color","danger",1,"error-text"]],template:function(o,n){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Employee Registration"),e.k0s()()(),e.j41(6,"ion-content",2)(7,"div",3)(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),e.EFF(11),e.k0s()(),e.j41(12,"ion-card-content"),e.DNE(13,v,11,1,"div",4)(14,O,23,5,"div",4),e.j41(15,"div",5)(16,"ion-text"),e.EFF(17," Already have an account? "),e.j41(18,"a",6),e.EFF(19,"Login"),e.k0s()()()()()()()),2&o&&(e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(5),e.SpI(" ","check"===n.currentStep?"Verify Your Email":"Set Your Password"," "),e.R7$(2),e.Y8G("ngIf","check"===n.currentStep),e.R7$(),e.Y8G("ngIf","create"===n.currentStep))},dependencies:[f.MD,f.bT,l.X1,l.qT,l.BC,l.cb,l.j4,l.JD,p.Wk,i.W9,i.eU,i.BC,i.ai,i.QW,i.el,i.b_,i.I9,i.ME,i.tN,i.uz,i.$w,i.Jm,i.IO,i.iq],styles:[".register-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;min-height:100%;max-width:500px;margin:0 auto;padding:1rem}ion-card[_ngcontent-%COMP%]{box-shadow:var(--shadow-md);border-radius:var(--radius-lg)}ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{text-align:center;font-size:1.5rem;font-weight:600;color:var(--text-primary)}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:2rem 1.5rem}ion-item[_ngcontent-%COMP%]{--padding-start: 0;margin-bottom:1rem}.register-button[_ngcontent-%COMP%]{margin-top:1.5rem;height:48px;font-weight:600}.description[_ngcontent-%COMP%]{display:block;margin-bottom:1.5rem;text-align:center}.description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0;font-size:.9rem}.employee-info[_ngcontent-%COMP%]{background:var(--ion-color-light);padding:1rem;border-radius:var(--radius-md);margin-bottom:1.5rem}.employee-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0 0 1rem;font-size:1.1rem}.employee-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}.employee-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;border-bottom:1px solid var(--ion-color-light-shade)}.employee-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.error-text[_ngcontent-%COMP%]{display:block;padding:0 1rem;margin-top:-.5rem;margin-bottom:.5rem}.button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:1.5rem}.button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:48px;font-weight:600}.login-link[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:600;text-decoration:none}"]})}}return r})()}}]);