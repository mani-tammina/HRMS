"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[925],{5925:(x,m,c)=>{c.r(m),c.d(m,{ManagerApprovalsPage:()=>E});var g=c(467),_=c(177),r=c(773),d=c(5312),v=c(2951),p=c(5873),e=c(4438),h=c(1626);function u(o,l){1&o&&(e.j41(0,"ion-card")(1,"ion-card-content",12),e.nrm(2,"ion-icon",13),e.j41(3,"p"),e.EFF(4,"No pending leave requests"),e.k0s()()())}function M(o,l){if(1&o){const n=e.RV6();e.j41(0,"ion-card",14)(1,"ion-card-header")(2,"div",15)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",16),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",17),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"div",18)(12,"div",19),e.nrm(13,"ion-icon",5),e.j41(14,"span")(15,"strong"),e.EFF(16,"Period:"),e.k0s(),e.EFF(17),e.nI1(18,"date"),e.nI1(19,"date"),e.k0s()(),e.j41(20,"div",19),e.nrm(21,"ion-icon",7),e.j41(22,"span")(23,"strong"),e.EFF(24,"Duration:"),e.k0s(),e.EFF(25),e.k0s()(),e.j41(26,"div",19),e.nrm(27,"ion-icon",20),e.j41(28,"span")(29,"strong"),e.EFF(30,"Reason:"),e.k0s(),e.EFF(31),e.k0s()(),e.j41(32,"div",19),e.nrm(33,"ion-icon",5),e.j41(34,"span")(35,"strong"),e.EFF(36,"Applied:"),e.k0s(),e.EFF(37),e.nI1(38,"date"),e.k0s()()(),e.j41(39,"div",21)(40,"ion-button",22),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.approveLeave(i))}),e.nrm(41,"ion-icon",23),e.EFF(42," Approve "),e.k0s(),e.j41(43,"ion-button",24),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.rejectLeave(i))}),e.nrm(44,"ion-icon",25),e.EFF(45," Reject "),e.k0s()()()()}if(2&o){const n=l.$implicit,t=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(2),e.JRh(n.type_name),e.R7$(8),e.Lme(" ",e.i5U(18,12,n.start_date,"MMM d")," - ",e.i5U(19,15,n.end_date,"MMM d, y"),""),e.R7$(8),e.SpI(" ",n.total_days," day(s)"),e.R7$(6),e.SpI(" ",n.reason,""),e.R7$(6),e.SpI(" ",e.i5U(38,18,n.applied_at,"MMM d, y h:mm a"),""),e.R7$(3),e.Y8G("disabled",t.isLoading),e.R7$(3),e.Y8G("disabled",t.isLoading)}}function P(o,l){if(1&o&&(e.j41(0,"div")(1,"div",9)(2,"h3"),e.EFF(3,"Pending Leave Requests"),e.k0s(),e.j41(4,"ion-badge",10),e.EFF(5),e.k0s()(),e.DNE(6,u,5,0,"ion-card",8)(7,M,46,21,"ion-card",11),e.k0s()),2&o){const n=e.XpG();e.R7$(5),e.JRh(n.pendingLeaves.length),e.R7$(),e.Y8G("ngIf",0===n.pendingLeaves.length),e.R7$(),e.Y8G("ngForOf",n.pendingLeaves)}}function f(o,l){1&o&&(e.j41(0,"ion-card")(1,"ion-card-content",12),e.nrm(2,"ion-icon",13),e.j41(3,"p"),e.EFF(4,"No pending timesheets"),e.k0s()()())}function j(o,l){if(1&o&&(e.j41(0,"div",19),e.nrm(1,"ion-icon",29),e.j41(2,"span")(3,"strong"),e.EFF(4,"Project:"),e.k0s(),e.EFF(5),e.k0s()()),2&o){const n=e.XpG().$implicit;e.R7$(5),e.Lme(" ",n.project_name," (",n.project_code,")")}}function F(o,l){if(1&o&&(e.j41(0,"div",19),e.nrm(1,"ion-icon",20),e.j41(2,"span")(3,"strong"),e.EFF(4,"Description:"),e.k0s(),e.EFF(5),e.k0s()()),2&o){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_description,"")}}function C(o,l){if(1&o){const n=e.RV6();e.j41(0,"ion-card",14)(1,"ion-card-header")(2,"div",15)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",16),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",26),e.EFF(9),e.nI1(10,"titlecase"),e.k0s()()(),e.j41(11,"ion-card-content")(12,"div",27)(13,"div",19),e.nrm(14,"ion-icon",5),e.j41(15,"span")(16,"strong"),e.EFF(17,"Date:"),e.k0s(),e.EFF(18),e.nI1(19,"date"),e.k0s()(),e.j41(20,"div",19),e.nrm(21,"ion-icon",7),e.j41(22,"span")(23,"strong"),e.EFF(24,"Hours:"),e.k0s(),e.EFF(25),e.k0s()(),e.DNE(26,j,6,2,"div",28)(27,F,6,1,"div",28),e.j41(28,"div",19),e.nrm(29,"ion-icon",5),e.j41(30,"span")(31,"strong"),e.EFF(32,"Submitted:"),e.k0s(),e.EFF(33),e.nI1(34,"date"),e.k0s()()(),e.j41(35,"div",21)(36,"ion-button",22),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.approveTimesheet(i))}),e.nrm(37,"ion-icon",23),e.EFF(38," Approve "),e.k0s(),e.j41(39,"ion-button",24),e.bIt("click",function(){const i=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.rejectTimesheet(i))}),e.nrm(40,"ion-icon",25),e.EFF(41," Reject "),e.k0s()()()()}if(2&o){const n=l.$implicit,t=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(),e.Y8G("color","project"===n.timesheet_type?"primary":"secondary"),e.R7$(),e.SpI(" ",e.bMT(10,13,n.timesheet_type)," "),e.R7$(9),e.SpI(" ",e.i5U(19,15,n.date,"MMM d, y"),""),e.R7$(7),e.SpI(" ",n.total_hours,"h"),e.R7$(),e.Y8G("ngIf",n.project_name),e.R7$(),e.Y8G("ngIf",n.work_description),e.R7$(6),e.SpI(" ",e.i5U(34,18,n.submission_date,"MMM d, y h:mm a"),""),e.R7$(3),e.Y8G("disabled",t.isLoading),e.R7$(3),e.Y8G("disabled",t.isLoading)}}function O(o,l){if(1&o&&(e.j41(0,"div")(1,"div",9)(2,"h3"),e.EFF(3,"Pending Timesheets"),e.k0s(),e.j41(4,"ion-badge",10),e.EFF(5),e.k0s()(),e.DNE(6,f,5,0,"ion-card",8)(7,C,42,21,"ion-card",11),e.k0s()),2&o){const n=e.XpG();e.R7$(5),e.JRh(n.pendingTimesheets.length),e.R7$(),e.Y8G("ngIf",0===n.pendingTimesheets.length),e.R7$(),e.Y8G("ngForOf",n.pendingTimesheets)}}let E=(()=>{class o{constructor(n,t,i){this.http=n,this.toastController=t,this.alertController=i,this.selectedSegment="leaves",this.pendingLeaves=[],this.pendingTimesheets=[],this.isLoading=!1,(0,v.d)({checkmarkCircleOutline:p.gz2,closeCircleOutline:p.p9N,timeOutline:p.CVk,calendarOutline:p.RXF,documentTextOutline:p.pXZ,peopleOutline:p.wx_})}ngOnInit(){this.loadData()}segmentChanged(n){this.selectedSegment=n.detail.value}loadData(){this.loadPendingLeaves(),this.loadPendingTimesheets()}loadPendingLeaves(){this.http.get(`${d.c.apiUrl}/leaves/pending`).subscribe({next:n=>{this.pendingLeaves=n,console.log("Pending leaves:",n)},error:n=>{console.error("Error loading pending leaves:",n),this.showToast("Error loading pending leaves","danger")}})}loadPendingTimesheets(){this.http.get(`${d.c.apiUrl}/timesheets/manager/pending-timesheets`).subscribe({next:n=>{this.pendingTimesheets=n,console.log("Pending timesheets:",n)},error:n=>{console.error("Error loading pending timesheets:",n),this.showToast("Error loading pending timesheets","danger")}})}approveLeave(n){var t=this;return(0,g.A)(function*(){yield(yield t.alertController.create({header:"Approve Leave",message:`Approve leave request for ${n.FirstName} ${n.LastName}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:()=>{t.isLoading=!0,t.http.put(`${d.c.apiUrl}/leaves/approve/${n.id}`,{}).subscribe({next:()=>{t.isLoading=!1,t.showToast("Leave approved successfully","success"),t.loadPendingLeaves()},error:a=>{t.isLoading=!1,t.showToast(a.error?.error||"Error approving leave","danger")}})}}]})).present()})()}rejectLeave(n){var t=this;return(0,g.A)(function*(){yield(yield t.alertController.create({header:"Reject Leave",message:`Reject leave request for ${n.FirstName} ${n.LastName}?`,inputs:[{name:"rejection_reason",type:"textarea",placeholder:"Rejection reason (optional)"}],buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",handler:a=>{t.isLoading=!0,t.http.put(`${d.c.apiUrl}/leaves/reject/${n.id}`,{rejection_reason:a.rejection_reason}).subscribe({next:()=>{t.isLoading=!1,t.showToast("Leave rejected","success"),t.loadPendingLeaves()},error:s=>{t.isLoading=!1,t.showToast(s.error?.error||"Error rejecting leave","danger")}})}}]})).present()})()}approveTimesheet(n){var t=this;return(0,g.A)(function*(){yield(yield t.alertController.create({header:"Approve Timesheet",message:`Approve timesheet for ${n.FirstName} ${n.LastName}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:()=>{t.isLoading=!0,console.log("Approving timesheet:",n),t.http.put(`${d.c.apiUrl}/timesheets/manager/approve/${n.id}`,{}).subscribe({next:a=>{console.log("Approval response:",a),t.isLoading=!1,t.showToast("Timesheet verified successfully","success"),t.loadPendingTimesheets()},error:a=>{console.error("Approval error:",a),t.isLoading=!1,t.showToast(a.error?.error||a.error?.message||a.message||"Error approving timesheet","danger")}})}}]})).present()})()}rejectTimesheet(n){var t=this;return(0,g.A)(function*(){yield(yield t.alertController.create({header:"Reject Timesheet",message:`Reject timesheet for ${n.FirstName} ${n.LastName}?`,inputs:[{name:"rejection_reason",type:"textarea",placeholder:"Rejection reason (required)",attributes:{required:!0}}],buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",handler:a=>a.rejection_reason?.trim()?(t.isLoading=!0,console.log("Rejecting timesheet:",n),t.http.put(`${d.c.apiUrl}/timesheets/manager/reject/${n.id}`,{rejection_reason:a.rejection_reason}).subscribe({next:s=>{console.log("Rejection response:",s),t.isLoading=!1,t.showToast("Timesheet rejected","success"),t.loadPendingTimesheets()},error:s=>{console.error("Rejection error:",s),t.isLoading=!1,t.showToast(s.error?.error||s.error?.message||s.message||"Error rejecting timesheet","danger")}}),!0):(t.showToast("Rejection reason is required","warning"),!1)}]})).present()})()}handleRefresh(n){this.loadData(),setTimeout(()=>n.target.complete(),1e3)}showToast(n,t){var i=this;return(0,g.A)(function*(){yield(yield i.toastController.create({message:n,duration:3e3,color:t,position:"top"})).present()})()}static{this.\u0275fac=function(t){return new(t||o)(e.rXU(h.Qq),e.rXU(r.K_),e.rXU(r.hG))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-manager-approvals"]],standalone:!0,features:[e.aNF],decls:19,vars:4,consts:[[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"approvals-container"],[3,"ionChange","value"],["value","leaves"],["name","calendar-outline"],["value","timesheets"],["name","time-outline"],[4,"ngIf"],[1,"section-header"],["color","warning"],["class","approval-card",4,"ngFor","ngForOf"],[1,"empty-state"],["name","checkmark-circle-outline","size","large","color","success"],[1,"approval-card"],[1,"card-header-content"],[1,"employee-details"],["color","primary"],[1,"leave-details"],[1,"detail-row"],["name","document-text-outline"],[1,"action-buttons"],["expand","block","color","success",3,"click","disabled"],["slot","start","name","checkmark-circle-outline"],["expand","block","color","danger","fill","outline",3,"click","disabled"],["slot","start","name","close-circle-outline"],[3,"color"],[1,"timesheet-details"],["class","detail-row",4,"ngIf"],["name","briefcase-outline"]],template:function(t,i){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Team Approvals"),e.k0s()()(),e.j41(4,"ion-content",0)(5,"ion-refresher",1),e.bIt("ionRefresh",function(s){return i.handleRefresh(s)}),e.nrm(6,"ion-refresher-content"),e.k0s(),e.j41(7,"div",2)(8,"ion-segment",3),e.bIt("ionChange",function(s){return i.segmentChanged(s)}),e.j41(9,"ion-segment-button",4),e.nrm(10,"ion-icon",5),e.j41(11,"ion-label"),e.EFF(12,"Leave Requests"),e.k0s()(),e.j41(13,"ion-segment-button",6),e.nrm(14,"ion-icon",7),e.j41(15,"ion-label"),e.EFF(16,"Timesheets"),e.k0s()()(),e.DNE(17,P,8,3,"div",8)(18,O,8,3,"div",8),e.k0s()()),2&t&&(e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(4),e.Y8G("value",i.selectedSegment),e.R7$(9),e.Y8G("ngIf","leaves"===i.selectedSegment),e.R7$(),e.Y8G("ngIf","timesheets"===i.selectedSegment))},dependencies:[_.MD,_.Sq,_.bT,_.PV,_.vh,r.W9,r.eU,r.BC,r.ai,r.Gp,r.eP,r.b_,r.ME,r.tN,r.I9,r.he,r.In,r.Jm,r.iq,r.To,r.Ki],styles:[".approvals-container[_ngcontent-%COMP%]{padding:16px;max-width:800px;margin:0 auto}ion-segment[_ngcontent-%COMP%]{margin-bottom:20px}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:20px 0 12px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600}.approval-card[_ngcontent-%COMP%]{margin-bottom:16px}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:18px;margin-bottom:4px}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin:0}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]{margin:16px 0}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-bottom:12px}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:20px;flex-shrink:0;margin-top:2px}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;line-height:1.5}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-right:4px}.approval-card[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:20px}"]})}}return o})()}}]);