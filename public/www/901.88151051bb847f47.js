"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[901],{3901:(A,d,s)=>{s.r(d),s.d(d,{ProfilePage:()=>L});var _=s(467),u=s(4341),l=s(773),p=s(177),g=s(5312),h=s(2951),a=s(5873),e=s(4438),P=s(8010),E=s(1626),y=s(3799);function b(t,r){if(1&t){const n=e.RV6();e.j41(0,"ion-buttons",6)(1,"ion-button",7),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.toggleEditMode())}),e.EFF(2,"Cancel"),e.k0s()()}}function D(t,r){if(1&t){const n=e.RV6();e.j41(0,"ion-buttons",8)(1,"ion-button",9),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.saveProfile())}),e.j41(2,"strong"),e.EFF(3,"Save"),e.k0s()()()}if(2&t){const n=e.XpG();e.R7$(),e.Y8G("disabled",!n.profileForm.valid)}}function F(t,r){1&t&&(e.j41(0,"div",10),e.nrm(1,"ion-spinner",11),e.j41(2,"p"),e.EFF(3,"Loading profile..."),e.k0s()())}function M(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",24),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Employee Number"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.EmployeeNumber)}}function j(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",23),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Personal Email"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.PersonalEmail)}}function O(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",25),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Date of Birth"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.nI1(7,"date"),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(e.i5U(7,1,null==n.employeeData?null:n.employeeData.DateOfBirth,"MMM d, y"))}}function v(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",22),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Gender"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.Gender)}}function R(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",26),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Blood Group"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.BloodGroup)}}function C(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",27),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Marital Status"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.MaritalStatus)}}function k(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",28),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Department"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.department_name)}}function G(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",29),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Designation"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.designation_name)}}function x(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",30),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Location"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(null==n.employeeData?null:n.employeeData.location_name)}}function I(t,r){if(1&t&&(e.j41(0,"ion-item"),e.nrm(1,"ion-icon",31),e.j41(2,"ion-label")(3,"p"),e.EFF(4,"Role"),e.k0s(),e.j41(5,"h3"),e.EFF(6),e.nI1(7,"titlecase"),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(6),e.JRh(e.bMT(7,1,null==n.user?null:n.user.role))}}function $(t,r){if(1&t&&(e.j41(0,"ion-list",21)(1,"ion-item"),e.nrm(2,"ion-icon",22),e.j41(3,"ion-label")(4,"p"),e.EFF(5,"Full Name"),e.k0s(),e.j41(6,"h3"),e.EFF(7),e.k0s()()(),e.DNE(8,M,7,1,"ion-item",5),e.j41(9,"ion-item"),e.nrm(10,"ion-icon",23),e.j41(11,"ion-label")(12,"p"),e.EFF(13,"Work Email"),e.k0s(),e.j41(14,"h3"),e.EFF(15),e.k0s()()(),e.DNE(16,j,7,1,"ion-item",5)(17,O,8,4,"ion-item",5)(18,v,7,1,"ion-item",5)(19,R,7,1,"ion-item",5)(20,C,7,1,"ion-item",5)(21,k,7,1,"ion-item",5)(22,G,7,1,"ion-item",5)(23,x,7,1,"ion-item",5)(24,I,8,3,"ion-item",5),e.k0s()),2&t){const n=e.XpG(2);e.R7$(7),e.JRh((null==n.employeeData?null:n.employeeData.FullName)||(null==n.user?null:n.user.name)),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.EmployeeNumber),e.R7$(7),e.JRh((null==n.employeeData?null:n.employeeData.WorkEmail)||(null==n.user?null:n.user.email)),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.PersonalEmail),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.DateOfBirth),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.Gender),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.BloodGroup),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.MaritalStatus),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.department_name),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.designation_name),e.R7$(),e.Y8G("ngIf",null==n.employeeData?null:n.employeeData.location_name),e.R7$(),e.Y8G("ngIf",null==n.user?null:n.user.role)}}function T(t,r){if(1&t&&(e.j41(0,"form",32)(1,"ion-list",33)(2,"ion-item"),e.nrm(3,"ion-input",34),e.k0s(),e.j41(4,"ion-item"),e.nrm(5,"ion-input",35),e.k0s(),e.j41(6,"ion-item"),e.nrm(7,"ion-input",36),e.k0s(),e.j41(8,"ion-item"),e.nrm(9,"ion-input",37),e.k0s(),e.j41(10,"ion-item"),e.nrm(11,"ion-input",38),e.k0s(),e.j41(12,"div",39)(13,"h3"),e.EFF(14,"Current Address"),e.k0s()(),e.j41(15,"ion-item"),e.nrm(16,"ion-input",40),e.k0s(),e.j41(17,"ion-item"),e.nrm(18,"ion-input",41),e.k0s(),e.j41(19,"ion-item"),e.nrm(20,"ion-input",42),e.k0s(),e.j41(21,"ion-item"),e.nrm(22,"ion-input",43),e.k0s(),e.j41(23,"ion-item"),e.nrm(24,"ion-input",44),e.k0s(),e.j41(25,"ion-item"),e.nrm(26,"ion-input",45),e.k0s(),e.j41(27,"div",39)(28,"h3"),e.EFF(29,"Family Information"),e.k0s()(),e.j41(30,"ion-item"),e.nrm(31,"ion-input",46),e.k0s(),e.j41(32,"ion-item"),e.nrm(33,"ion-input",47),e.k0s(),e.j41(34,"ion-item"),e.nrm(35,"ion-input",48),e.k0s()()()),2&t){const n=e.XpG(2);e.Y8G("formGroup",n.profileForm)}}function B(t,r){if(1&t){const n=e.RV6();e.j41(0,"ion-item",49),e.bIt("click",function(){const i=e.eBV(n).$implicit,m=e.XpG(2);return e.Njj(m.handleMenuClick(i.action))}),e.nrm(1,"ion-icon",50),e.j41(2,"ion-label",17),e.EFF(3),e.k0s()()}if(2&t){const n=r.$implicit;e.R7$(),e.Y8G("name",n.icon)("color",n.color||"primary"),e.R7$(),e.Y8G("color",n.color),e.R7$(),e.JRh(n.label)}}function N(t,r){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"ion-card",12)(2,"div",13)(3,"ion-avatar",14)(4,"img",15),e.bIt("error",function(i){e.eBV(n);const m=e.XpG();return e.Njj(m.handleImageError(i))}),e.k0s()()(),e.j41(5,"div",16)(6,"h1"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s(),e.j41(10,"ion-badge",17),e.EFF(11),e.k0s()()(),e.j41(12,"ion-card")(13,"ion-card-content"),e.DNE(14,$,25,12,"ion-list",18)(15,T,36,1,"form",19),e.k0s()(),e.j41(16,"ion-card")(17,"ion-card-content")(18,"ion-list"),e.DNE(19,B,4,4,"ion-item",20),e.k0s()()()()}if(2&t){const n=e.XpG();e.R7$(4),e.Y8G("src",(null==n.user?null:n.user.avatar)||"assets/avatar-placeholder.png",e.B4B),e.R7$(3),e.JRh((null==n.employeeData?null:n.employeeData.FullName)||(null==n.user?null:n.user.name)),e.R7$(2),e.JRh((null==n.employeeData?null:n.employeeData.WorkEmail)||(null==n.user?null:n.user.email)),e.R7$(),e.Y8G("color","Active"===(null==n.employeeData?null:n.employeeData.EmploymentStatus)?"success":"medium"),e.R7$(),e.SpI(" ",(null==n.employeeData?null:n.employeeData.EmploymentStatus)||"Active"," "),e.R7$(3),e.Y8G("ngIf",!n.isEditMode),e.R7$(),e.Y8G("ngIf",n.isEditMode),e.R7$(4),e.Y8G("ngForOf",n.menuItems)}}let L=(()=>{class t{constructor(n,o,i,m,c,f){this.authService=n,this.http=o,this.router=i,this.alertController=m,this.fb=c,this.toastController=f,this.user=null,this.employeeData=null,this.isLoading=!0,this.isEditMode=!1,this.menuItems=[{icon:"person-outline",label:"Edit Profile",action:"edit-profile"},{icon:"settings-outline",label:"Settings",action:"settings"},{icon:"notifications-outline",label:"Notifications",action:"notifications"},{icon:"log-out-outline",label:"Logout",action:"logout",color:"danger"}],(0,h.d)({personOutline:a.wAZ,mailOutline:a.SM1,callOutline:a.bNN,businessOutline:a.FL4,briefcaseOutline:a.vOb,calendarOutline:a.RXF,logOutOutline:a.z_V,settingsOutline:a.s8q,notificationsOutline:a.rqk,cardOutline:a.VR9,locationOutline:a.UN$,shieldOutline:a.uLY,waterOutline:a.MQo,heartOutline:a.neQ})}ngOnInit(){this.userSubscription=this.authService.currentUser$.subscribe(n=>{this.user=n,n&&this.loadEmployeeProfile()}),this.initializeForm()}initializeForm(){this.profileForm=this.fb.group({PersonalEmail:["",[u.k0.email]],DateOfBirth:[""],Gender:[""],BloodGroup:[""],MaritalStatus:[""],current_address_line1:[""],current_address_line2:[""],current_city:[""],current_state:[""],current_zip:[""],current_country:[""],father_name:[""],mother_name:[""],spouse_name:[""]})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe()}loadEmployeeProfile(){this.isLoading=!0,this.http.get(`${g.c.apiUrl}/employees/profile/me`).subscribe({next:n=>{this.employeeData=n,this.populateForm(n),this.isLoading=!1},error:n=>{console.error("Error loading profile:",n),this.isLoading=!1}})}populateForm(n){n&&this.profileForm.patchValue({PersonalEmail:n.PersonalEmail||"",DateOfBirth:n.DateOfBirth?n.DateOfBirth.split("T")[0]:"",Gender:n.Gender||"",BloodGroup:n.BloodGroup||"",MaritalStatus:n.MaritalStatus||"",current_address_line1:n.current_address_line1||"",current_address_line2:n.current_address_line2||"",current_city:n.current_city||"",current_state:n.current_state||"",current_zip:n.current_zip||"",current_country:n.current_country||"",father_name:n.father_name||"",mother_name:n.mother_name||"",spouse_name:n.spouse_name||""})}toggleEditMode(){this.isEditMode=!this.isEditMode,this.isEditMode||this.populateForm(this.employeeData)}saveProfile(){var n=this;return(0,_.A)(function*(){if(n.profileForm.valid){n.isLoading=!0;const o=n.profileForm.value,i={};Object.keys(o).forEach(m=>{const c=o[m];null!=c&&""!==c&&(i[m]=c)}),console.log("Sending update data:",i),n.http.put(`${g.c.apiUrl}/employees/profile/me`,i).subscribe({next:(m=(0,_.A)(function*(c){yield n.showToast("Profile updated successfully!","success"),n.isEditMode=!1,n.loadEmployeeProfile()}),function(f){return m.apply(this,arguments)}),error:function(){var m=(0,_.A)(function*(c){console.error("Error updating profile:",c);const f=c.error?.error||c.error?.message||"Failed to update profile";yield n.showToast(f,"danger"),n.isLoading=!1});return function(f){return m.apply(this,arguments)}}()})}var m})()}showToast(n,o){var i=this;return(0,_.A)(function*(){yield(yield i.toastController.create({message:n,duration:3e3,color:o,position:"top"})).present()})()}handleMenuClick(n){var o=this;return(0,_.A)(function*(){"logout"===n?yield o.confirmLogout():"notifications"===n?o.router.navigate(["/notifications"]):"edit-profile"===n?o.toggleEditMode():console.log("Action:",n)})()}confirmLogout(){var n=this;return(0,_.A)(function*(){yield(yield n.alertController.create({header:"Confirm Logout",message:"Are you sure you want to logout?",buttons:[{text:"Cancel",role:"cancel"},{text:"Logout",handler:()=>{n.authService.logout()}}]})).present()})()}handleImageError(n){n.target.src="assets/avatar-placeholder.png"}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(P.u),e.rXU(E.Qq),e.rXU(y.Ix),e.rXU(l.hG),e.rXU(u.ok),e.rXU(l.K_))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-profile"]],standalone:!0,features:[e.aNF],decls:10,vars:6,consts:[["slot","start",4,"ngIf"],["slot","end",4,"ngIf"],[3,"fullscreen"],[1,"profile-container"],["class","loading-container",4,"ngIf"],[4,"ngIf"],["slot","start"],[3,"click"],["slot","end"],[3,"click","disabled"],[1,"loading-container"],["name","crescent"],[1,"profile-header-card"],[1,"header-gradient"],[1,"profile-avatar"],["alt","Profile",3,"error","src"],[1,"profile-info"],[3,"color"],["lines","none",4,"ngIf"],[3,"formGroup",4,"ngIf"],["button","","detail","true",3,"click",4,"ngFor","ngForOf"],["lines","none"],["slot","start","name","person-outline","color","primary"],["slot","start","name","mail-outline","color","primary"],["slot","start","name","card-outline","color","primary"],["slot","start","name","calendar-outline","color","primary"],["slot","start","name","water-outline","color","primary"],["slot","start","name","heart-outline","color","primary"],["slot","start","name","business-outline","color","primary"],["slot","start","name","briefcase-outline","color","primary"],["slot","start","name","location-outline","color","primary"],["slot","start","name","shield-outline","color","primary"],[3,"formGroup"],["lines","full"],["label","Personal Email","labelPlacement","floating","type","email","formControlName","PersonalEmail"],["label","Date of Birth","labelPlacement","floating","type","date","formControlName","DateOfBirth"],["label","Gender","labelPlacement","floating","formControlName","Gender","placeholder","Male/Female/Other"],["label","Blood Group","labelPlacement","floating","formControlName","BloodGroup","placeholder","A+, B+, O+, etc."],["label","Marital Status","labelPlacement","floating","formControlName","MaritalStatus","placeholder","Single/Married"],[1,"section-header"],["label","Address Line 1","labelPlacement","floating","formControlName","current_address_line1"],["label","Address Line 2","labelPlacement","floating","formControlName","current_address_line2"],["label","City","labelPlacement","floating","formControlName","current_city"],["label","State","labelPlacement","floating","formControlName","current_state"],["label","Zip Code","labelPlacement","floating","formControlName","current_zip"],["label","Country","labelPlacement","floating","formControlName","current_country"],["label","Father's Name","labelPlacement","floating","formControlName","father_name"],["label","Mother's Name","labelPlacement","floating","formControlName","mother_name"],["label","Spouse Name","labelPlacement","floating","formControlName","spouse_name"],["button","","detail","true",3,"click"],["slot","start",3,"name","color"]],template:function(o,i){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar"),e.DNE(2,b,3,0,"ion-buttons",0),e.j41(3,"ion-title"),e.EFF(4),e.k0s(),e.DNE(5,D,4,1,"ion-buttons",1),e.k0s()(),e.j41(6,"ion-content",2)(7,"div",3),e.DNE(8,F,4,0,"div",4)(9,N,20,8,"div",5),e.k0s()()),2&o&&(e.R7$(2),e.Y8G("ngIf",i.isEditMode),e.R7$(2),e.JRh(i.isEditMode?"Edit Profile":"Profile"),e.R7$(),e.Y8G("ngIf",i.isEditMode),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading))},dependencies:[p.MD,p.Sq,p.bT,p.PV,p.vh,u.X1,u.qT,u.BC,u.cb,u.j4,u.JD,l.W9,l.eU,l.BC,l.ai,l.b_,l.I9,l.nf,l.uz,l.he,l.iq,l.Jm,l.mC,l.In,l.w2,l.$w,l.QW],styles:[".profile-container[_ngcontent-%COMP%]{padding:1rem;max-width:800px;margin:0 auto}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:60vh}.loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{transform:scale(1.5);margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.9rem}.profile-header-card[_ngcontent-%COMP%]{margin-bottom:1.5rem;overflow:hidden}.profile-header-card[_ngcontent-%COMP%]   .header-gradient[_ngcontent-%COMP%]{background:var(--gradient-primary);height:120px;display:flex;align-items:flex-end;justify-content:center;padding-bottom:50px}.profile-header-card[_ngcontent-%COMP%]   .profile-avatar[_ngcontent-%COMP%]{width:100px;height:100px;border:4px solid white;box-shadow:var(--shadow-md)}.profile-header-card[_ngcontent-%COMP%]   .profile-info[_ngcontent-%COMP%]{text-align:center;padding:50px 1rem 1rem;margin-top:-50px}.profile-header-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin:0 0 .5rem}.profile-header-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;margin-bottom:.5rem}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium);margin-bottom:.25rem}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;margin:0}.section-header[_ngcontent-%COMP%]{padding:1rem 0 .5rem;margin-top:1rem;border-top:1px solid var(--ion-color-light)}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600;color:var(--ion-color-primary)}"]})}}return t})()}}]);