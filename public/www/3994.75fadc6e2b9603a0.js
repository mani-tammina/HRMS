"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3994],{3994:(S,p,l)=>{l.r(p),l.d(p,{AnalyticsDashboardPage:()=>G});var h=l(467),u=l(177),g=l(4341),r=l(7820),m=l(2951),c=l(5873),v=l(8933),_=l(6233),t=l(4438),y=l(5312),b=l(1626);let f=(()=>{class a{constructor(e){this.http=e,this.apiUrl=`${y.c.apiUrl}/dashboard`}getAdminDashboard(){return this.http.get(`${this.apiUrl}/admin`)}getManagerDashboard(){return this.http.get(`${this.apiUrl}/manager`)}getEmployeeDashboard(){return this.http.get(`${this.apiUrl}/employee`)}getAttendanceAnalytics(e,i,n){let s={start_date:e,end_date:i};return n&&(s.department_id=n.toString()),this.http.get(`${this.apiUrl}/analytics/attendance`,{params:s})}getLeaveAnalytics(e,i,n){let s={start_date:e,end_date:i};return n&&(s.department_id=n.toString()),this.http.get(`${this.apiUrl}/analytics/leaves`,{params:s})}getTimesheetAnalytics(e,i,n){let s={start_date:e,end_date:i};return n&&(s.project_id=n.toString()),this.http.get(`${this.apiUrl}/analytics/timesheets`,{params:s})}getPayrollAnalytics(e,i){const n={month:e.toString(),year:i.toString()};return this.http.get(`${this.apiUrl}/analytics/payroll`,{params:n})}static{this.\u0275fac=function(i){return new(i||a)(t.KVO(b.Qq))}}static{this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var C=l(8010),j=l(6119);const P=(a,o)=>o.department,w=(a,o)=>o.work_mode,A=(a,o)=>o.leave_type,k=(a,o)=>o.project_name;function R(a,o){if(1&a){const e=t.RV6();t.j41(0,"ion-card",8)(1,"ion-card-content")(2,"ion-select",11),t.mxI("ngModelChange",function(n){t.eBV(e);const s=t.XpG();return t.DH7(s.selectedPeriod,n)||(s.selectedPeriod=n),t.Njj(n)}),t.bIt("ionChange",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.onPeriodChange(n))}),t.j41(3,"ion-select-option",12),t.EFF(4,"Last 7 Days"),t.k0s(),t.j41(5,"ion-select-option",13),t.EFF(6,"Last 30 Days"),t.k0s(),t.j41(7,"ion-select-option",14),t.EFF(8,"Last 3 Months"),t.k0s()()()()}if(2&a){const e=t.XpG();t.R7$(2),t.R50("ngModel",e.selectedPeriod)}}function M(a,o){1&a&&t.nrm(0,"app-loading",9)}function D(a,o){if(1&a&&(t.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",15),t.nrm(3,"app-stat-card",16),t.k0s(),t.j41(4,"ion-col",15),t.nrm(5,"app-stat-card",17),t.k0s(),t.j41(6,"ion-col",15),t.nrm(7,"app-stat-card",18),t.k0s(),t.j41(8,"ion-col",15),t.nrm(9,"app-stat-card",19),t.k0s()()(),t.j41(10,"ion-grid")(11,"ion-row")(12,"ion-col",20),t.nrm(13,"app-stat-card",21),t.k0s(),t.j41(14,"ion-col",20),t.nrm(15,"app-stat-card",22),t.k0s(),t.j41(16,"ion-col",20),t.nrm(17,"app-stat-card",23),t.k0s()()(),t.j41(18,"ion-grid")(19,"ion-row")(20,"ion-col",24),t.nrm(21,"app-stat-card",25),t.k0s(),t.j41(22,"ion-col",24),t.nrm(23,"app-stat-card",26),t.k0s()()()),2&a){const e=t.XpG();t.R7$(3),t.Y8G("value",e.adminDashboard.total_employees),t.R7$(2),t.Y8G("value",e.adminDashboard.active_employees)("subtitle",e.adminDashboard.on_leave_today+" on leave today"),t.R7$(2),t.Y8G("value",e.adminDashboard.present_today)("subtitle",e.adminDashboard.attendance_rate+"% rate"),t.R7$(2),t.Y8G("value",e.adminDashboard.avg_work_hours+"h"),t.R7$(4),t.Y8G("value",e.adminDashboard.active_projects),t.R7$(2),t.Y8G("value",e.adminDashboard.pending_leaves),t.R7$(2),t.Y8G("value",e.adminDashboard.pending_timesheets),t.R7$(4),t.Y8G("value",e.adminDashboard.recent_joinings),t.R7$(2),t.Y8G("value",e.adminDashboard.upcoming_birthdays)}}function O(a,o){if(1&a&&(t.j41(0,"div",31)(1,"div",34)(2,"span",35),t.EFF(3),t.k0s(),t.j41(4,"span",36),t.EFF(5),t.k0s()(),t.j41(6,"div",37),t.nrm(7,"div",38),t.k0s()()),2&a){const e=o.$implicit;t.R7$(3),t.JRh(e.department),t.R7$(2),t.SpI("",e.attendance_rate,"%"),t.R7$(2),t.xc7("width",e.attendance_rate,"%")}}function $(a,o){if(1&a&&(t.j41(0,"div",33)(1,"div",39),t.EFF(2),t.k0s(),t.j41(3,"div",40),t.EFF(4),t.k0s(),t.j41(5,"div",41),t.EFF(6),t.k0s()()),2&a){const e=o.$implicit;t.R7$(2),t.JRh(e.work_mode),t.R7$(2),t.JRh(e.count),t.R7$(2),t.SpI("",e.percentage,"%")}}function F(a,o){if(1&a&&(t.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",15),t.nrm(3,"app-stat-card",27),t.k0s(),t.j41(4,"ion-col",15),t.nrm(5,"app-stat-card",28),t.k0s(),t.j41(6,"ion-col",15),t.nrm(7,"app-stat-card",29),t.k0s(),t.j41(8,"ion-col",15),t.nrm(9,"app-stat-card",30),t.k0s()()(),t.j41(10,"ion-card")(11,"ion-card-header")(12,"ion-card-title"),t.EFF(13,"Department-wise Attendance"),t.k0s()(),t.j41(14,"ion-card-content"),t.Z7z(15,O,8,4,"div",31,P),t.k0s()(),t.j41(17,"ion-card")(18,"ion-card-header")(19,"ion-card-title"),t.EFF(20,"Work Mode Distribution"),t.k0s()(),t.j41(21,"ion-card-content")(22,"div",32),t.Z7z(23,$,7,3,"div",33,w),t.k0s()()()),2&a){const e=t.XpG();t.R7$(3),t.Y8G("value",e.attendanceAnalytics.overall_stats.total_working_days),t.R7$(2),t.Y8G("value",e.attendanceAnalytics.overall_stats.avg_attendance_rate+"%"),t.R7$(2),t.Y8G("value",e.attendanceAnalytics.overall_stats.total_present),t.R7$(2),t.Y8G("value",e.attendanceAnalytics.overall_stats.total_late),t.R7$(6),t.Dyx(e.attendanceAnalytics.department_wise),t.R7$(8),t.Dyx(e.attendanceAnalytics.work_mode_distribution)}}function x(a,o){if(1&a&&(t.j41(0,"div",31)(1,"div",34)(2,"span",35),t.EFF(3),t.k0s(),t.j41(4,"span",36),t.EFF(5),t.k0s()(),t.j41(6,"div",37),t.nrm(7,"div",38),t.k0s()()),2&a){const e=o.$implicit;t.R7$(3),t.JRh(e.leave_type),t.R7$(2),t.Lme("",e.count," (",e.percentage,"%)"),t.R7$(2),t.xc7("width",e.percentage,"%")}}function T(a,o){if(1&a&&(t.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",15),t.nrm(3,"app-stat-card",42),t.k0s(),t.j41(4,"ion-col",15),t.nrm(5,"app-stat-card",43),t.k0s(),t.j41(6,"ion-col",15),t.nrm(7,"app-stat-card",44),t.k0s(),t.j41(8,"ion-col",15),t.nrm(9,"app-stat-card",45),t.k0s()()(),t.j41(10,"ion-card")(11,"ion-card-header")(12,"ion-card-title"),t.EFF(13,"Leave Type Distribution"),t.k0s()(),t.j41(14,"ion-card-content"),t.Z7z(15,x,8,5,"div",31,A),t.k0s()()),2&a){const e=t.XpG();t.R7$(3),t.Y8G("value",e.leaveAnalytics.overall_stats.total_leaves),t.R7$(2),t.Y8G("value",e.leaveAnalytics.overall_stats.approved_leaves),t.R7$(2),t.Y8G("value",e.leaveAnalytics.overall_stats.pending_leaves),t.R7$(2),t.Y8G("value",e.leaveAnalytics.overall_stats.rejected_leaves),t.R7$(6),t.Dyx(e.leaveAnalytics.leave_type_distribution)}}function L(a,o){if(1&a&&(t.j41(0,"div",50)(1,"div",51)(2,"div",52),t.EFF(3),t.k0s(),t.j41(4,"div",53),t.EFF(5),t.k0s()(),t.j41(6,"div",54),t.EFF(7),t.k0s()()),2&a){const e=o.$implicit;t.R7$(3),t.JRh(e.project_name),t.R7$(2),t.SpI("",e.employee_count," employees"),t.R7$(2),t.SpI("",e.total_hours,"h")}}function E(a,o){if(1&a&&(t.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",15),t.nrm(3,"app-stat-card",46),t.k0s(),t.j41(4,"ion-col",15),t.nrm(5,"app-stat-card",47),t.k0s(),t.j41(6,"ion-col",15),t.nrm(7,"app-stat-card",48),t.k0s(),t.j41(8,"ion-col",15),t.nrm(9,"app-stat-card",49),t.k0s()()(),t.j41(10,"ion-card")(11,"ion-card-header")(12,"ion-card-title"),t.EFF(13,"Project-wise Hours"),t.k0s()(),t.j41(14,"ion-card-content"),t.Z7z(15,L,8,3,"div",50,k),t.k0s()()),2&a){const e=t.XpG();t.R7$(3),t.Y8G("value",e.timesheetAnalytics.overall_stats.total_submissions),t.R7$(2),t.Y8G("value",e.timesheetAnalytics.overall_stats.avg_hours_per_day+"h"),t.R7$(2),t.Y8G("value",e.timesheetAnalytics.overall_stats.total_hours+"h"),t.R7$(2),t.Y8G("value",e.timesheetAnalytics.overall_stats.compliance_rate+"%"),t.R7$(6),t.Dyx(e.timesheetAnalytics.project_wise_hours)}}let G=(()=>{class a{constructor(e,i,n){this.dashboardService=e,this.authService=i,this.errorHandler=n,this.user=null,this.selectedView="overview",this.selectedPeriod="month",this.adminDashboard=null,this.attendanceAnalytics=null,this.leaveAnalytics=null,this.timesheetAnalytics=null,this.isLoading=!1,this.dateRange={start_date:"",end_date:""},(0,m.d)({statsChartOutline:c.IEp,peopleOutline:c.wx_,calendarOutline:c.RXF,timeOutline:c.CVk,trendingUpOutline:c.F0Q,trendingDownOutline:c.Cps,briefcaseOutline:c.vOb})}ngOnInit(){this.authService.currentUser$.subscribe(e=>{this.user=e}),this.setDateRange(),this.loadData()}setDateRange(){const e=new Date;let i=new Date;switch(this.selectedPeriod){case"week":i.setDate(e.getDate()-7);break;case"month":i.setMonth(e.getMonth()-1);break;case"quarter":i.setMonth(e.getMonth()-3)}this.dateRange={start_date:i.toISOString().split("T")[0],end_date:e.toISOString().split("T")[0]}}loadData(){"overview"===this.selectedView?this.loadOverview():"attendance"===this.selectedView?this.loadAttendanceAnalytics():"leaves"===this.selectedView?this.loadLeaveAnalytics():"timesheets"===this.selectedView&&this.loadTimesheetAnalytics()}loadOverview(){var i,e=this;this.isLoading=!0,this.dashboardService.getAdminDashboard().subscribe({next:i=>{this.adminDashboard=i.dashboard,this.isLoading=!1},error:(i=(0,h.A)(function*(n){yield e.errorHandler.handleError(n,"Failed to load dashboard"),e.isLoading=!1}),function(s){return i.apply(this,arguments)})})}loadAttendanceAnalytics(){var i,e=this;this.isLoading=!0,this.dashboardService.getAttendanceAnalytics(this.dateRange.start_date,this.dateRange.end_date).subscribe({next:i=>{this.attendanceAnalytics=i.analytics,this.isLoading=!1},error:(i=(0,h.A)(function*(n){yield e.errorHandler.handleError(n,"Failed to load attendance analytics"),e.isLoading=!1}),function(s){return i.apply(this,arguments)})})}loadLeaveAnalytics(){var i,e=this;this.isLoading=!0,this.dashboardService.getLeaveAnalytics(this.dateRange.start_date,this.dateRange.end_date).subscribe({next:i=>{this.leaveAnalytics=i.analytics,this.isLoading=!1},error:(i=(0,h.A)(function*(n){yield e.errorHandler.handleError(n,"Failed to load leave analytics"),e.isLoading=!1}),function(s){return i.apply(this,arguments)})})}loadTimesheetAnalytics(){var i,e=this;this.isLoading=!0,this.dashboardService.getTimesheetAnalytics(this.dateRange.start_date,this.dateRange.end_date).subscribe({next:i=>{this.timesheetAnalytics=i.analytics,this.isLoading=!1},error:(i=(0,h.A)(function*(n){yield e.errorHandler.handleError(n,"Failed to load timesheet analytics"),e.isLoading=!1}),function(s){return i.apply(this,arguments)})})}onViewChange(e){this.selectedView=e.detail.value,this.loadData()}onPeriodChange(e){this.selectedPeriod=e.detail.value,this.setDateRange(),this.loadData()}handleRefresh(e){this.loadData(),setTimeout(()=>e.target.complete(),1e3)}getTrendDirection(e){return e>0?"up":e<0?"down":"neutral"}static{this.\u0275fac=function(i){return new(i||a)(t.rXU(f),t.rXU(C.u),t.rXU(j.c))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-analytics-dashboard"]],standalone:!0,features:[t.aNF],decls:29,vars:7,consts:[["slot","start"],["defaultHref","/admin"],[1,"page-container"],[3,"ngModelChange","ionChange","ngModel"],["value","overview"],["value","attendance"],["value","leaves"],["value","timesheets"],[1,"period-card"],["message","Loading analytics...","type","spinner"],["slot","fixed",3,"ionRefresh"],["interface","popover",3,"ngModelChange","ionChange","ngModel"],["value","week"],["value","month"],["value","quarter"],["size","6","sizeMd","3"],["title","Total Employees","icon","people-outline","iconColor","primary",3,"value"],["title","Active","icon","checkmark-circle-outline","iconColor","success",3,"value","subtitle"],["title","Present Today","icon","calendar-outline","iconColor","primary",3,"value","subtitle"],["title","Avg Work Hours","icon","time-outline","iconColor","tertiary",3,"value"],["size","6","sizeMd","4"],["title","Active Projects","icon","briefcase-outline","iconColor","primary",3,"value"],["title","Pending Leaves","icon","document-text-outline","iconColor","warning",3,"value"],["title","Pending Timesheets","icon","time-outline","iconColor","warning",3,"value"],["size","6"],["title","Recent Joinings","subtitle","This month","icon","person-add-outline","iconColor","success",3,"value"],["title","Upcoming Birthdays","subtitle","Next 7 days","icon","gift-outline","iconColor","tertiary",3,"value"],["title","Working Days","icon","calendar-outline","iconColor","primary",3,"value"],["title","Attendance Rate","icon","trending-up-outline","iconColor","success",3,"value"],["title","Present","icon","checkmark-circle-outline","iconColor","success",3,"value"],["title","Late Arrivals","icon","time-outline","iconColor","warning",3,"value"],[1,"analytics-row"],[1,"distribution-grid"],[1,"distribution-item"],[1,"row-info"],[1,"row-label"],[1,"row-value"],[1,"progress-bar"],[1,"progress-fill"],[1,"item-label"],[1,"item-value"],[1,"item-percentage"],["title","Total Leaves","icon","calendar-outline","iconColor","primary",3,"value"],["title","Approved","icon","checkmark-circle-outline","iconColor","success",3,"value"],["title","Pending","icon","time-outline","iconColor","warning",3,"value"],["title","Rejected","icon","close-circle-outline","iconColor","danger",3,"value"],["title","Total Submissions","icon","document-text-outline","iconColor","primary",3,"value"],["title","Avg Hours/Day","icon","time-outline","iconColor","tertiary",3,"value"],["title","Total Hours","icon","trending-up-outline","iconColor","success",3,"value"],["title","Compliance Rate","icon","checkmark-circle-outline","iconColor","success",3,"value"],[1,"project-row"],[1,"project-info"],[1,"project-name"],[1,"project-meta"],[1,"project-hours"]],template:function(i,n){1&i&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t.nrm(3,"ion-back-button",1),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Analytics Dashboard"),t.k0s()()(),t.j41(6,"ion-content")(7,"div",2)(8,"ion-segment",3),t.mxI("ngModelChange",function(d){return t.DH7(n.selectedView,d)||(n.selectedView=d),d}),t.bIt("ionChange",function(d){return n.onViewChange(d)}),t.j41(9,"ion-segment-button",4)(10,"ion-label"),t.EFF(11,"Overview"),t.k0s()(),t.j41(12,"ion-segment-button",5)(13,"ion-label"),t.EFF(14,"Attendance"),t.k0s()(),t.j41(15,"ion-segment-button",6)(16,"ion-label"),t.EFF(17,"Leaves"),t.k0s()(),t.j41(18,"ion-segment-button",7)(19,"ion-label"),t.EFF(20,"Timesheets"),t.k0s()()(),t.DNE(21,R,9,1,"ion-card",8)(22,M,1,0,"app-loading",9)(23,D,24,11)(24,F,25,4)(25,T,17,4)(26,E,17,4),t.j41(27,"ion-refresher",10),t.bIt("ionRefresh",function(d){return n.handleRefresh(d)}),t.nrm(28,"ion-refresher-content"),t.k0s()()()),2&i&&(t.R7$(8),t.R50("ngModel",n.selectedView),t.R7$(13),t.vxM("overview"!==n.selectedView?21:-1),t.R7$(),t.vxM(n.isLoading?22:-1),t.R7$(),t.vxM(!n.isLoading&&"overview"===n.selectedView&&n.adminDashboard?23:-1),t.R7$(),t.vxM(!n.isLoading&&"attendance"===n.selectedView&&n.attendanceAnalytics?24:-1),t.R7$(),t.vxM(!n.isLoading&&"leaves"===n.selectedView&&n.leaveAnalytics?25:-1),t.R7$(),t.vxM(!n.isLoading&&"timesheets"===n.selectedView&&n.timesheetAnalytics?26:-1))},dependencies:[u.MD,g.YN,g.BC,g.vS,r.W9,r.eU,r.BC,r.ai,r.QW,r.el,r.b_,r.I9,r.ME,r.tN,r.lO,r.ln,r.hU,r.Gp,r.eP,r.he,r.Nm,r.Ip,r.To,r.Ki,v.q,_.q],styles:[".page-container[_ngcontent-%COMP%]{padding:1rem}ion-segment[_ngcontent-%COMP%]{margin-bottom:1rem}.period-card[_ngcontent-%COMP%]{margin-bottom:1rem}.period-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:.5rem 1rem}.period-card[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{width:100%}.analytics-row[_ngcontent-%COMP%]{margin-bottom:1.5rem}.analytics-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.analytics-row[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.5rem}.analytics-row[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]   .row-label[_ngcontent-%COMP%]{font-weight:500;color:var(--text-primary)}.analytics-row[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]   .row-value[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:600}.analytics-row[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{height:8px;background:var(--ion-color-light);border-radius:4px;overflow:hidden}.analytics-row[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,var(--ion-color-primary),var(--ion-color-primary-tint));transition:width .3s ease}.distribution-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem}.distribution-grid[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]{text-align:center;padding:1.5rem 1rem;background:var(--ion-color-light);border-radius:8px}.distribution-grid[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:var(--text-secondary);margin-bottom:.5rem}.distribution-grid[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .item-value[_ngcontent-%COMP%]{display:block;font-size:1.75rem;font-weight:700;color:var(--text-primary);margin-bottom:.25rem}.distribution-grid[_ngcontent-%COMP%]   .distribution-item[_ngcontent-%COMP%]   .item-percentage[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:var(--ion-color-primary);font-weight:600}.project-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 0;border-bottom:1px solid var(--border-color)}.project-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.project-row[_ngcontent-%COMP%]   .project-info[_ngcontent-%COMP%]{flex:1}.project-row[_ngcontent-%COMP%]   .project-info[_ngcontent-%COMP%]   .project-name[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary);margin-bottom:.25rem}.project-row[_ngcontent-%COMP%]   .project-info[_ngcontent-%COMP%]   .project-meta[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary)}.project-row[_ngcontent-%COMP%]   .project-hours[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--ion-color-primary)}"]})}}return a})()}}]);