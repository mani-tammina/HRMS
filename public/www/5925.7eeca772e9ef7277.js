"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5925],{5925:(z,v,p)=>{p.r(v),p.d(v,{ManagerApprovalsPage:()=>X});var l=p(467),_=p(177),u=p(4341),d=p(7820),g=p(5312),h=p(2951),c=p(5873),e=p(4438),f=p(1626);function F(a,r){1&a&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",17),e.j41(3,"p"),e.EFF(4,"No pending leave requests"),e.k0s()()())}function M(a,r){if(1&a){const n=e.RV6();e.j41(0,"ion-card",18)(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",21),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"div",22)(12,"div",23),e.nrm(13,"ion-icon",5),e.j41(14,"span")(15,"strong"),e.EFF(16,"Period:"),e.k0s(),e.EFF(17),e.nI1(18,"date"),e.nI1(19,"date"),e.k0s()(),e.j41(20,"div",23),e.nrm(21,"ion-icon",9),e.j41(22,"span")(23,"strong"),e.EFF(24,"Duration:"),e.k0s(),e.EFF(25),e.k0s()(),e.j41(26,"div",23),e.nrm(27,"ion-icon",24),e.j41(28,"span")(29,"strong"),e.EFF(30,"Reason:"),e.k0s(),e.EFF(31),e.k0s()(),e.j41(32,"div",23),e.nrm(33,"ion-icon",5),e.j41(34,"span")(35,"strong"),e.EFF(36,"Applied:"),e.k0s(),e.EFF(37),e.nI1(38,"date"),e.k0s()()(),e.j41(39,"div",25)(40,"ion-button",26),e.bIt("click",function(){const o=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.approveLeave(o))}),e.nrm(41,"ion-icon",27),e.EFF(42," Approve "),e.k0s(),e.j41(43,"ion-button",28),e.bIt("click",function(){const o=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.rejectLeave(o))}),e.nrm(44,"ion-icon",29),e.EFF(45," Reject "),e.k0s()()()()}if(2&a){const n=r.$implicit,t=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(2),e.JRh(n.type_name),e.R7$(8),e.Lme(" ",e.i5U(18,12,n.start_date,"MMM d")," - ",e.i5U(19,15,n.end_date,"MMM d, y"),""),e.R7$(8),e.SpI(" ",n.total_days," day(s)"),e.R7$(6),e.SpI(" ",n.reason,""),e.R7$(6),e.SpI(" ",e.i5U(38,18,n.applied_at,"MMM d, y h:mm a"),""),e.R7$(3),e.Y8G("disabled",t.isLoading),e.R7$(3),e.Y8G("disabled",t.isLoading)}}function j(a,r){if(1&a&&(e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3,"Pending Leave Requests"),e.k0s(),e.j41(4,"ion-badge",14),e.EFF(5),e.k0s()(),e.DNE(6,F,5,0,"ion-card",12)(7,M,46,21,"ion-card",15),e.k0s()),2&a){const n=e.XpG();e.R7$(5),e.JRh(n.pendingLeaves.length),e.R7$(),e.Y8G("ngIf",0===n.pendingLeaves.length),e.R7$(),e.Y8G("ngForOf",n.pendingLeaves)}}function P(a,r){1&a&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",17),e.j41(3,"p"),e.EFF(4,"No pending WFH/Remote requests"),e.k0s()()())}function k(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",24),e.j41(2,"span")(3,"strong"),e.EFF(4,"Reason:"),e.k0s(),e.EFF(5),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.reason,"")}}function x(a,r){if(1&a){const n=e.RV6();e.j41(0,"ion-card",18)(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",30),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"div",22)(12,"div",23),e.nrm(13,"ion-icon",5),e.j41(14,"span")(15,"strong"),e.EFF(16,"Date:"),e.k0s(),e.EFF(17),e.nI1(18,"date"),e.k0s()(),e.j41(19,"div",23),e.nrm(20,"ion-icon",7),e.j41(21,"span")(22,"strong"),e.EFF(23,"Work Mode:"),e.k0s(),e.EFF(24),e.k0s()(),e.DNE(25,k,6,1,"div",31),e.j41(26,"div",23),e.nrm(27,"ion-icon",9),e.j41(28,"span")(29,"strong"),e.EFF(30,"Applied:"),e.k0s(),e.EFF(31),e.nI1(32,"date"),e.k0s()()(),e.j41(33,"div",25)(34,"ion-button",26),e.bIt("click",function(){const o=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.approveWFH(o))}),e.nrm(35,"ion-icon",27),e.EFF(36," Approve "),e.k0s(),e.j41(37,"ion-button",28),e.bIt("click",function(){const o=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.rejectWFH(o))}),e.nrm(38,"ion-icon",29),e.EFF(39," Reject "),e.k0s()()()()}if(2&a){const n=r.$implicit,t=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.JRh(n.EmployeeNumber),e.R7$(),e.Y8G("color","WFH"===n.leave_type?"success":"tertiary"),e.R7$(),e.JRh(n.leave_type),e.R7$(8),e.SpI(" ",e.i5U(18,11,n.start_date,"MMM d, y (EEEE)"),""),e.R7$(7),e.SpI(" ",n.leave_type,""),e.R7$(),e.Y8G("ngIf",n.reason),e.R7$(6),e.SpI(" ",e.i5U(32,14,n.applied_at,"MMM d, y h:mm a"),""),e.R7$(3),e.Y8G("disabled",t.isLoading),e.R7$(3),e.Y8G("disabled",t.isLoading)}}function E(a,r){if(1&a&&(e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3,"Pending WFH/Remote Requests"),e.k0s(),e.j41(4,"ion-badge",14),e.EFF(5),e.k0s()(),e.DNE(6,P,5,0,"ion-card",12)(7,x,40,17,"ion-card",15),e.k0s()),2&a){const n=e.XpG();e.R7$(5),e.JRh(n.pendingWFH.length),e.R7$(),e.Y8G("ngIf",0===n.pendingWFH.length),e.R7$(),e.Y8G("ngForOf",n.pendingWFH)}}function R(a,r){1&a&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",17),e.j41(3,"p"),e.EFF(4,"No pending timesheets"),e.k0s()()())}function b(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",33),e.j41(2,"span")(3,"strong"),e.EFF(4,"Project:"),e.k0s(),e.EFF(5),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.Lme(" ",n.project_name," (",n.project_code,")")}}function A(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",24),e.j41(2,"span")(3,"strong"),e.EFF(4,"Description:"),e.k0s(),e.EFF(5),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_description,"")}}function $(a,r){if(1&a){const n=e.RV6();e.j41(0,"ion-card",18)(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",30),e.EFF(9),e.nI1(10,"titlecase"),e.k0s()()(),e.j41(11,"ion-card-content")(12,"div",32)(13,"div",23),e.nrm(14,"ion-icon",5),e.j41(15,"span")(16,"strong"),e.EFF(17,"Date:"),e.k0s(),e.EFF(18),e.nI1(19,"date"),e.k0s()(),e.j41(20,"div",23),e.nrm(21,"ion-icon",9),e.j41(22,"span")(23,"strong"),e.EFF(24,"Hours:"),e.k0s(),e.EFF(25),e.k0s()(),e.DNE(26,b,6,2,"div",31)(27,A,6,1,"div",31),e.j41(28,"div",23),e.nrm(29,"ion-icon",5),e.j41(30,"span")(31,"strong"),e.EFF(32,"Submitted:"),e.k0s(),e.EFF(33),e.nI1(34,"date"),e.k0s()()(),e.j41(35,"div",25)(36,"ion-button",26),e.bIt("click",function(){const o=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.approveTimesheet(o))}),e.nrm(37,"ion-icon",27),e.EFF(38," Approve "),e.k0s(),e.j41(39,"ion-button",28),e.bIt("click",function(){const o=e.eBV(n).$implicit,i=e.XpG(2);return e.Njj(i.rejectTimesheet(o))}),e.nrm(40,"ion-icon",29),e.EFF(41," Reject "),e.k0s()()()()}if(2&a){const n=r.$implicit,t=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(),e.Y8G("color","project"===n.timesheet_type?"primary":"secondary"),e.R7$(),e.SpI(" ",e.bMT(10,13,n.timesheet_type)," "),e.R7$(9),e.SpI(" ",e.i5U(19,15,n.date,"MMM d, y"),""),e.R7$(7),e.SpI(" ",n.total_hours,"h"),e.R7$(),e.Y8G("ngIf",n.project_name),e.R7$(),e.Y8G("ngIf",n.work_description),e.R7$(6),e.SpI(" ",e.i5U(34,18,n.submission_date,"MMM d, y h:mm a"),""),e.R7$(3),e.Y8G("disabled",t.isLoading),e.R7$(3),e.Y8G("disabled",t.isLoading)}}function C(a,r){if(1&a&&(e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3,"Pending Timesheets"),e.k0s(),e.j41(4,"ion-badge",14),e.EFF(5),e.k0s()(),e.DNE(6,R,5,0,"ion-card",12)(7,$,42,21,"ion-card",15),e.k0s()),2&a){const n=e.XpG();e.R7$(5),e.JRh(n.pendingTimesheets.length),e.R7$(),e.Y8G("ngIf",0===n.pendingTimesheets.length),e.R7$(),e.Y8G("ngForOf",n.pendingTimesheets)}}function y(a,r){if(1&a&&(e.j41(0,"ion-card",41)(1,"ion-card-header")(2,"ion-card-title",42),e.EFF(3,"Debug Info"),e.k0s()(),e.j41(4,"ion-card-content")(5,"pre",43),e.EFF(6),e.nI1(7,"json"),e.k0s()()()),2&a){const n=e.XpG(2);e.R7$(6),e.JRh(e.bMT(7,1,n.getDebugData()))}}function O(a,r){1&a&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",44),e.j41(3,"p"),e.EFF(4,"Loading attendance data..."),e.k0s()()())}function T(a,r){if(1&a&&(e.j41(0,"div",45)(1,"ion-card",46)(2,"ion-card-content"),e.nrm(3,"ion-icon",47),e.j41(4,"div",48),e.EFF(5),e.k0s(),e.j41(6,"div",49),e.EFF(7,"Total Team"),e.k0s()()(),e.j41(8,"ion-card",50)(9,"ion-card-content"),e.nrm(10,"ion-icon",51),e.j41(11,"div",48),e.EFF(12),e.k0s(),e.j41(13,"div",49),e.EFF(14,"Present"),e.k0s()()(),e.j41(15,"ion-card",52)(16,"ion-card-content"),e.nrm(17,"ion-icon",53),e.j41(18,"div",48),e.EFF(19),e.k0s(),e.j41(20,"div",49),e.EFF(21,"Absent"),e.k0s()()(),e.j41(22,"ion-card",54)(23,"ion-card-content"),e.nrm(24,"ion-icon",55),e.j41(25,"div",48),e.EFF(26),e.k0s(),e.j41(27,"div",49),e.EFF(28,"On Leave"),e.k0s()()()()),2&a){const n=e.XpG(2);e.R7$(),e.xc7("background","linear-gradient(135deg, #667eea 0%, #764ba2 100%)"),e.R7$(4),e.JRh(n.teamAttendance.summary.total_team||0),e.R7$(3),e.xc7("background","linear-gradient(135deg, #11998e 0%, #38ef7d 100%)"),e.R7$(4),e.JRh(n.teamAttendance.summary.present||0),e.R7$(3),e.xc7("background","linear-gradient(135deg, #eb3349 0%, #f45c43 100%)"),e.R7$(4),e.JRh(n.teamAttendance.summary.absent||0),e.R7$(3),e.xc7("background","linear-gradient(135deg, #f7971e 0%, #ffd200 100%)"),e.R7$(4),e.JRh(n.teamAttendance.summary.on_leave||0)}}function I(a,r){1&a&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",56),e.j41(3,"p")(4,"strong"),e.EFF(5,"No team members found"),e.k0s()(),e.j41(6,"small"),e.EFF(7,"You need team members reporting to you to view attendance. Please contact HR if this is incorrect."),e.k0s()()())}function L(a,r){if(1&a&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",57),e.j41(3,"p"),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"small"),e.EFF(7),e.k0s()()()),2&a){const n=e.XpG(2);e.R7$(4),e.SpI("No attendance records for ",e.i5U(5,2,n.selectedDate,"MMM d, y"),""),e.R7$(3),e.SpI("Your ",n.teamAttendance.summary.total_team," team members haven't marked attendance yet for this date")}}function G(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",59),e.j41(2,"span")(3,"strong"),e.EFF(4,"Check In:"),e.k0s(),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",e.i5U(6,1,n.check_in_time,"h:mm a"),"")}}function D(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",60),e.j41(2,"span")(3,"strong"),e.EFF(4,"Check Out:"),e.k0s(),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",e.i5U(6,1,n.check_out_time,"h:mm a"),"")}}function w(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",61),e.j41(2,"span")(3,"strong"),e.EFF(4,"Work Hours:"),e.k0s(),e.EFF(5),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_hours,"h")}}function N(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",62),e.j41(2,"span")(3,"strong"),e.EFF(4,"Mode:"),e.k0s(),e.EFF(5),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_mode,"")}}function S(a,r){if(1&a&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",63),e.j41(2,"span")(3,"strong"),e.EFF(4,"Total Punches:"),e.k0s(),e.EFF(5),e.k0s()()),2&a){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.total_punches,"")}}function W(a,r){if(1&a&&(e.j41(0,"ion-card",18)(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",30),e.nrm(9,"ion-icon",58),e.EFF(10),e.nI1(11,"titlecase"),e.k0s()()(),e.j41(12,"ion-card-content")(13,"div",22),e.DNE(14,G,7,4,"div",31)(15,D,7,4,"div",31)(16,w,6,1,"div",31)(17,N,6,1,"div",31)(18,S,6,1,"div",31),e.k0s()()()),2&a){const n=r.$implicit,t=e.XpG(3);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.JRh(n.EmployeeNumber),e.R7$(),e.Y8G("color",t.getAttendanceStatusColor(n.status)),e.R7$(),e.Y8G("name",t.getAttendanceStatusIcon(n.status)),e.R7$(),e.SpI(" ",e.bMT(11,11,n.status)," "),e.R7$(4),e.Y8G("ngIf",n.check_in_time),e.R7$(),e.Y8G("ngIf",n.check_out_time),e.R7$(),e.Y8G("ngIf",n.work_hours),e.R7$(),e.Y8G("ngIf",n.work_mode),e.R7$(),e.Y8G("ngIf",n.total_punches)}}function Y(a,r){if(1&a&&(e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3),e.k0s()(),e.DNE(4,W,19,13,"ion-card",15),e.k0s()),2&a){const n=e.XpG(2);e.R7$(3),e.SpI("Attendance Details (",n.teamAttendance.attendance.length," records)"),e.R7$(),e.Y8G("ngForOf",n.teamAttendance.attendance)}}function U(a,r){if(1&a){const n=e.RV6();e.j41(0,"div")(1,"div",13)(2,"h3"),e.nrm(3,"ion-icon",34),e.EFF(4," Team Attendance Report "),e.k0s(),e.j41(5,"div",35)(6,"ion-button",36),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.toggleDebugInfo())}),e.nrm(7,"ion-icon",37),e.k0s(),e.j41(8,"ion-datetime",38),e.mxI("ngModelChange",function(o){e.eBV(n);const i=e.XpG();return e.DH7(i.selectedDate,o)||(i.selectedDate=o),e.Njj(o)}),e.bIt("ionChange",function(o){e.eBV(n);const i=e.XpG();return e.Njj(i.onDateChange(o))}),e.k0s()()(),e.DNE(9,y,8,3,"ion-card",39)(10,O,5,0,"ion-card",12)(11,T,29,12,"div",40)(12,I,8,0,"ion-card",12)(13,L,8,5,"ion-card",12)(14,Y,5,2,"div",12),e.k0s()}if(2&a){const n=e.XpG();e.R7$(8),e.R50("ngModel",n.selectedDate),e.Y8G("max",n.maxDate),e.R7$(),e.Y8G("ngIf",n.showDebugInfo),e.R7$(),e.Y8G("ngIf",n.isLoadingAttendance),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance&&(null==n.teamAttendance?null:n.teamAttendance.summary)),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance&&n.teamAttendance&&n.teamAttendance.summary&&0===n.teamAttendance.summary.total_team),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance&&n.teamAttendance&&n.teamAttendance.summary&&n.teamAttendance.summary.total_team>0&&(!n.teamAttendance.attendance||0===n.teamAttendance.attendance.length)),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance&&(null==n.teamAttendance?null:n.teamAttendance.attendance)&&n.teamAttendance.attendance.length>0)}}let X=(()=>{class a{constructor(n,t,o){this.http=n,this.toastController=t,this.alertController=o,this.selectedSegment="leaves",this.pendingLeaves=[],this.pendingWFH=[],this.pendingTimesheets=[],this.teamAttendance={team_members:[],attendance:[],date:(new Date).toISOString().split("T")[0],summary:{total_team:0,present:0,absent:0,on_leave:0}},this.selectedDate=(new Date).toISOString().split("T")[0],this.maxDate=(new Date).toISOString(),this.isLoading=!1,this.isLoadingAttendance=!1,this.showDebugInfo=!1,(0,h.d)({checkmarkCircleOutline:c.gz2,closeCircleOutline:c.p9N,timeOutline:c.CVk,calendarOutline:c.RXF,documentTextOutline:c.pXZ,peopleOutline:c.wx_,briefcaseOutline:c.vOb,businessOutline:c.FL4,locationOutline:c.UN$,mailOutline:c.SM1,callOutline:c.bNN,analyticsOutline:c.jwg,hourglassOutline:c.pGP,fingerPrintOutline:c.RBE,checkmarkCircle:c.AUS,closeCircle:c.P0k,calendar:c.BJj,sunny:c.clu,bed:c.M1M,helpCircle:c.MGW,bugOutline:c.$7f})}ngOnInit(){this.loadData()}ionViewWillEnter(){this.loadData()}segmentChanged(n){this.selectedSegment=n.detail.value}loadData(){this.loadPendingLeaves(),this.loadPendingWFH(),this.loadPendingTimesheets(),this.loadTeamAttendance()}loadPendingLeaves(){this.http.get(`${g.c.apiUrl}/leaves/pending`).subscribe({next:n=>{this.pendingLeaves=n,console.log("Pending leaves:",n)},error:n=>{console.error("Error loading pending leaves:",n),this.showToast("Error loading pending leaves","danger")}})}loadPendingWFH(){this.http.get(`${g.c.apiUrl}/leaves/wfh-requests/pending`).subscribe({next:n=>{this.pendingWFH=n,console.log("Pending WFH requests:",n)},error:n=>{console.error("Error loading pending WFH requests:",n),this.showToast("Error loading pending WFH requests","danger")}})}loadPendingTimesheets(){this.http.get(`${g.c.apiUrl}/timesheets/manager/pending-timesheets`).subscribe({next:n=>{this.pendingTimesheets=n,console.log("Pending timesheets:",n)},error:n=>{console.error("Error loading pending timesheets:",n),this.showToast("Error loading pending timesheets","danger")}})}approveLeave(n){var t=this;return(0,l.A)(function*(){yield(yield t.alertController.create({header:"Approve Leave",message:`Approve leave request for ${n.FirstName} ${n.LastName}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:()=>{t.isLoading=!0,t.http.put(`${g.c.apiUrl}/leaves/approve/${n.id}`,{}).subscribe({next:()=>{t.isLoading=!1,t.showToast("Leave approved successfully","success"),t.loadPendingLeaves()},error:i=>{t.isLoading=!1,t.showToast(i.error?.error||"Error approving leave","danger")}})}}]})).present()})()}rejectLeave(n){var t=this;return(0,l.A)(function*(){yield(yield t.alertController.create({header:"Reject Leave",message:`Reject leave request for ${n.FirstName} ${n.LastName}?`,inputs:[{name:"rejection_reason",type:"textarea",placeholder:"Rejection reason (optional)"}],buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",handler:i=>{t.isLoading=!0,t.http.put(`${g.c.apiUrl}/leaves/reject/${n.id}`,{rejection_reason:i.rejection_reason}).subscribe({next:()=>{t.isLoading=!1,t.showToast("Leave rejected","success"),t.loadPendingLeaves()},error:s=>{t.isLoading=!1,t.showToast(s.error?.error||"Error rejecting leave","danger")}})}}]})).present()})()}approveTimesheet(n){var t=this;return(0,l.A)(function*(){yield(yield t.alertController.create({header:"Approve Timesheet",message:`Approve timesheet for ${n.FirstName} ${n.LastName}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:()=>{t.isLoading=!0,console.log("Approving timesheet:",n),t.http.put(`${g.c.apiUrl}/timesheets/manager/approve/${n.id}`,{}).subscribe({next:i=>{console.log("Approval response:",i),t.isLoading=!1,t.showToast("Timesheet verified successfully","success"),t.loadPendingTimesheets()},error:i=>{console.error("Approval error:",i),t.isLoading=!1,t.showToast(i.error?.error||i.error?.message||i.message||"Error approving timesheet","danger")}})}}]})).present()})()}rejectTimesheet(n){var t=this;return(0,l.A)(function*(){yield(yield t.alertController.create({header:"Reject Timesheet",message:`Reject timesheet for ${n.FirstName} ${n.LastName}?`,inputs:[{name:"rejection_reason",type:"textarea",placeholder:"Rejection reason (required)",attributes:{required:!0}}],buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",handler:i=>i.rejection_reason?.trim()?(t.isLoading=!0,console.log("Rejecting timesheet:",n),t.http.put(`${g.c.apiUrl}/timesheets/manager/reject/${n.id}`,{rejection_reason:i.rejection_reason}).subscribe({next:s=>{console.log("Rejection response:",s),t.isLoading=!1,t.showToast("Timesheet rejected","success"),t.loadPendingTimesheets()},error:s=>{console.error("Rejection error:",s),t.isLoading=!1,t.showToast(s.error?.error||s.error?.message||s.message||"Error rejecting timesheet","danger")}}),!0):(t.showToast("Rejection reason is required","warning"),!1)}]})).present()})()}approveWFH(n){var t=this;return(0,l.A)(function*(){var i;yield(yield t.alertController.create({header:"Approve WFH Request",message:`Approve ${n.FirstName} ${n.LastName}'s WFH request for ${n.start_date}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:(i=(0,l.A)(function*(){return t.isLoading=!0,t.http.put(`${g.c.apiUrl}/leaves/approve/${n.id}`,{}).subscribe({next:(s=(0,l.A)(function*(){yield t.showToast("WFH request approved successfully","success"),t.loadPendingWFH(),t.isLoading=!1}),function(){return s.apply(this,arguments)}),error:function(){var s=(0,l.A)(function*(m){yield t.showToast(m.error?.error||"Failed to approve WFH request","danger"),t.isLoading=!1});return function(H){return s.apply(this,arguments)}}()}),!0;var s}),function(){return i.apply(this,arguments)})}]})).present()})()}rejectWFH(n){var t=this;return(0,l.A)(function*(){var i;yield(yield t.alertController.create({header:"Reject WFH Request",message:`Reject ${n.FirstName} ${n.LastName}'s WFH request for ${n.start_date}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",role:"destructive",handler:(i=(0,l.A)(function*(){return t.isLoading=!0,t.http.put(`${g.c.apiUrl}/leaves/reject/${n.id}`,{}).subscribe({next:(s=(0,l.A)(function*(){yield t.showToast("WFH request rejected","success"),t.loadPendingWFH(),t.isLoading=!1}),function(){return s.apply(this,arguments)}),error:function(){var s=(0,l.A)(function*(m){yield t.showToast(m.error?.error||"Failed to reject WFH request","danger"),t.isLoading=!1});return function(H){return s.apply(this,arguments)}}()}),!0;var s}),function(){return i.apply(this,arguments)})}]})).present()})()}handleRefresh(n){this.loadData(),setTimeout(()=>n.target.complete(),1e3)}loadTeamAttendance(){this.isLoadingAttendance=!0,console.log(`Fetching team attendance for date: ${this.selectedDate}`),this.http.get(`${g.c.apiUrl}/attendance/report/team?date=${this.selectedDate}`).subscribe({next:n=>{this.teamAttendance=n||{team_members:[],attendance:[],date:this.selectedDate,summary:{total_team:0,present:0,absent:0,on_leave:0}},this.isLoadingAttendance=!1,console.log("Team attendance loaded:",this.teamAttendance),console.log("Summary:",this.teamAttendance.summary),console.log("Attendance records:",this.teamAttendance.attendance?.length||0)},error:n=>{this.isLoadingAttendance=!1,console.error("Error loading team attendance:",n),console.error("Error details:",n.error),this.showToast(`Error loading team attendance: ${n.error?.error||n.message}`,"danger")}})}onDateChange(n){this.selectedDate=n.detail.value.split("T")[0],this.loadTeamAttendance()}getAttendanceStatusColor(n){return{present:"success",absent:"danger","on-leave":"warning",holiday:"medium","week-off":"medium"}[n]||"medium"}getAttendanceStatusIcon(n){return{present:"checkmark-circle",absent:"close-circle","on-leave":"calendar",holiday:"sunny","week-off":"bed"}[n]||"help-circle"}toggleDebugInfo(){this.showDebugInfo=!this.showDebugInfo}getDebugData(){return{selectedDate:this.selectedDate,isLoadingAttendance:this.isLoadingAttendance,teamAttendance:this.teamAttendance,hasSummary:!!this.teamAttendance?.summary,hasAttendance:!!this.teamAttendance?.attendance,attendanceCount:this.teamAttendance?.attendance?.length||0}}showToast(n,t){var o=this;return(0,l.A)(function*(){yield(yield o.toastController.create({message:n,duration:3e3,color:t,position:"top"})).present()})()}static{this.\u0275fac=function(t){return new(t||a)(e.rXU(f.Qq),e.rXU(d.K_),e.rXU(d.hG))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-manager-approvals"]],standalone:!0,features:[e.aNF],decls:29,vars:6,consts:[[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"approvals-container"],[3,"ionChange","value"],["value","leaves"],["name","calendar-outline"],["value","wfh"],["name","home-outline"],["value","timesheets"],["name","time-outline"],["value","attendance"],["name","checkmark-circle-outline"],[4,"ngIf"],[1,"section-header"],["color","warning"],["class","approval-card",4,"ngFor","ngForOf"],[1,"empty-state"],["name","checkmark-circle-outline","size","large","color","success"],[1,"approval-card"],[1,"card-header-content"],[1,"employee-details"],["color","primary"],[1,"leave-details"],[1,"detail-row"],["name","document-text-outline"],[1,"action-buttons"],["expand","block","color","success",3,"click","disabled"],["slot","start","name","checkmark-circle-outline"],["expand","block","color","danger","fill","outline",3,"click","disabled"],["slot","start","name","close-circle-outline"],[3,"color"],["class","detail-row",4,"ngIf"],[1,"timesheet-details"],["name","briefcase-outline"],["name","analytics-outline"],[2,"display","flex","gap","8px","align-items","center"],["size","small","fill","clear",3,"click"],["name","bug-outline","slot","icon-only"],["presentation","date","size","small",3,"ngModelChange","ionChange","ngModel","max"],["style","background: #f0f0f0;",4,"ngIf"],["class","summary-grid",4,"ngIf"],[2,"background","#f0f0f0"],[2,"font-size","14px"],[2,"font-size","11px","overflow-x","auto"],["name","hourglass-outline","size","large","color","primary"],[1,"summary-grid"],[1,"summary-card"],["name","people-outline",2,"font-size","24px","color","white","opacity","0.8"],[1,"summary-value",2,"color","white"],[1,"summary-label",2,"color","rgba(255,255,255,0.9)"],[1,"summary-card","present"],["name","checkmark-circle",2,"font-size","24px","color","white","opacity","0.8"],[1,"summary-card","absent"],["name","close-circle",2,"font-size","24px","color","white","opacity","0.8"],[1,"summary-card","on-leave"],["name","calendar",2,"font-size","24px","color","white","opacity","0.8"],["name","people-outline","size","large","color","medium"],["name","calendar-outline","size","large","color","medium"],["slot","start",3,"name"],["name","time-outline","color","success"],["name","time-outline","color","danger"],["name","hourglass-outline"],["name","location-outline"],["name","finger-print-outline"]],template:function(t,o){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Manager Approvals"),e.k0s()()(),e.j41(4,"ion-content",0)(5,"ion-refresher",1),e.bIt("ionRefresh",function(s){return o.handleRefresh(s)}),e.nrm(6,"ion-refresher-content"),e.k0s(),e.j41(7,"div",2)(8,"ion-segment",3),e.bIt("ionChange",function(s){return o.segmentChanged(s)}),e.j41(9,"ion-segment-button",4),e.nrm(10,"ion-icon",5),e.j41(11,"ion-label"),e.EFF(12,"Leave Requests"),e.k0s()(),e.j41(13,"ion-segment-button",6),e.nrm(14,"ion-icon",7),e.j41(15,"ion-label"),e.EFF(16,"WFH Requests"),e.k0s()(),e.j41(17,"ion-segment-button",8),e.nrm(18,"ion-icon",9),e.j41(19,"ion-label"),e.EFF(20,"Timesheets"),e.k0s()(),e.j41(21,"ion-segment-button",10),e.nrm(22,"ion-icon",11),e.j41(23,"ion-label"),e.EFF(24,"Attendance"),e.k0s()()(),e.DNE(25,j,8,3,"div",12)(26,E,8,3,"div",12)(27,C,8,3,"div",12)(28,U,15,8,"div",12),e.k0s()()),2&t&&(e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(4),e.Y8G("value",o.selectedSegment),e.R7$(17),e.Y8G("ngIf","leaves"===o.selectedSegment),e.R7$(),e.Y8G("ngIf","wfh"===o.selectedSegment),e.R7$(),e.Y8G("ngIf","timesheets"===o.selectedSegment),e.R7$(),e.Y8G("ngIf","attendance"===o.selectedSegment))},dependencies:[_.MD,_.Sq,_.bT,_.TG,_.PV,_.vh,u.YN,u.BC,u.vS,d.W9,d.eU,d.BC,d.ai,d.Gp,d.eP,d.b_,d.ME,d.tN,d.I9,d.he,d.In,d.Jm,d.iq,d.To,d.Ki,d.A9],styles:[".approvals-container[_ngcontent-%COMP%]{padding:16px;max-width:800px;margin:0 auto}ion-segment[_ngcontent-%COMP%]{margin-bottom:20px}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:20px 0 12px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600}.approval-card[_ngcontent-%COMP%]{margin-bottom:16px}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:18px;margin-bottom:4px}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin:0}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]{margin:16px 0}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-bottom:12px}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:20px;flex-shrink:0;margin-top:2px}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;line-height:1.5}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-right:4px}.approval-card[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:20px}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin-bottom:20px}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{margin:0;box-shadow:0 4px 12px #0000001a;border-radius:12px}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:20px 16px;text-align:center}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{display:block;margin:0 auto 8px}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:36px;font-weight:700;margin-bottom:4px;line-height:1}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:13px;text-transform:uppercase;letter-spacing:.5px;font-weight:500}.section-header[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{max-width:200px;font-size:14px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-dark);display:flex;align-items:center;gap:8px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px!important}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;font-size:16px;color:var(--ion-color-dark)}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:13px;line-height:1.4}"]})}}return a})()}}]);