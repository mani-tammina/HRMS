"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[637],{1637:(b,m,a)=>{a.r(m),a.d(m,{RegisterPage:()=>k});var p=a(467),_=a(177),d=a(4341),r=a(773),f=a(2951),c=a(5873),u=a(5312),e=a(4438),h=a(1626),P=a(3799);function C(i,l){1&i&&e.nrm(0,"ion-spinner",15)}function y(i,l){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const n=e.XpG();e.R7$(),e.SpI(" ",n.employeeFound?"Verified \u2713":"Verify Employee"," ")}}function M(i,l){if(1&i&&(e.j41(0,"ion-note",25),e.EFF(1),e.k0s()),2&i){const n=e.XpG(2);e.R7$(),e.Lme(" Manages ",n.rolePreview.reportCount," direct report",1!==n.rolePreview.reportCount?"s":""," ")}}function w(i,l){if(1&i&&(e.j41(0,"div",16)(1,"ion-card",17)(2,"ion-card-content")(3,"div",18),e.nrm(4,"ion-icon",19),e.j41(5,"div",20)(6,"strong"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s(),e.j41(10,"p"),e.EFF(11),e.k0s(),e.j41(12,"p"),e.EFF(13),e.k0s()()(),e.j41(14,"div",21)(15,"ion-badge",22),e.EFF(16),e.k0s(),e.j41(17,"ion-note"),e.nrm(18,"ion-icon",23),e.EFF(19),e.k0s()(),e.DNE(20,M,2,2,"ion-note",24),e.k0s()()()),2&i){const n=e.XpG();e.R7$(7),e.JRh(n.rolePreview.employee.fullName),e.R7$(2),e.JRh(n.rolePreview.employee.employeeNumber),e.R7$(2),e.JRh(n.rolePreview.employee.email),e.R7$(2),e.JRh(n.rolePreview.employee.department),e.R7$(2),e.Y8G("color",n.getRoleBadgeColor(n.rolePreview.suggestedRole)),e.R7$(),e.SpI(" ",n.rolePreview.suggestedRole.toUpperCase()," "),e.R7$(3),e.SpI(" ",n.rolePreview.roleAssignmentReason," "),e.R7$(),e.Y8G("ngIf",n.rolePreview.reportCount>0)}}function O(i,l){if(1&i&&(e.j41(0,"div",33)(1,"ion-note"),e.EFF(2,"Password Strength: "),e.k0s(),e.j41(3,"ion-badge",22),e.EFF(4),e.k0s()()),2&i){const n=e.XpG(2);e.R7$(3),e.Y8G("color",n.getPasswordStrengthColor()),e.R7$(),e.SpI(" ",n.passwordStrength.toUpperCase()," ")}}function x(i,l){1&i&&e.nrm(0,"ion-spinner",15)}function v(i,l){1&i&&(e.j41(0,"span"),e.EFF(1,"Create Account"),e.k0s())}function E(i,l){if(1&i){const n=e.RV6();e.j41(0,"div",26)(1,"ion-item"),e.nrm(2,"ion-icon",27),e.j41(3,"ion-label",5),e.EFF(4,"Password"),e.k0s(),e.j41(5,"ion-input",28),e.mxI("ngModelChange",function(t){e.eBV(n);const s=e.XpG();return e.DH7(s.password,t)||(s.password=t),e.Njj(t)}),e.bIt("ngModelChange",function(){e.eBV(n);const t=e.XpG();return e.Njj(t.checkPasswordStrength())}),e.k0s()(),e.DNE(6,O,5,2,"div",29),e.j41(7,"ion-item"),e.nrm(8,"ion-icon",27),e.j41(9,"ion-label",5),e.EFF(10,"Confirm Password"),e.k0s(),e.j41(11,"ion-input",30),e.mxI("ngModelChange",function(t){e.eBV(n);const s=e.XpG();return e.DH7(s.confirmPassword,t)||(s.confirmPassword=t),e.Njj(t)}),e.k0s()(),e.j41(12,"ion-note",31),e.EFF(13," Password must be at least 8 characters with uppercase, lowercase, numbers, and special characters. "),e.k0s(),e.j41(14,"ion-button",32),e.bIt("click",function(){e.eBV(n);const t=e.XpG();return e.Njj(t.register())}),e.DNE(15,x,1,0,"ion-spinner",8)(16,v,2,0,"span",9),e.k0s()()}if(2&i){const n=e.XpG();e.R7$(5),e.R50("ngModel",n.password),e.R7$(),e.Y8G("ngIf",n.password),e.R7$(5),e.R50("ngModel",n.confirmPassword),e.R7$(3),e.Y8G("disabled",n.isRegistering||!n.password||!n.confirmPassword),e.R7$(),e.Y8G("ngIf",n.isRegistering),e.R7$(),e.Y8G("ngIf",!n.isRegistering)}}function R(i,l){if(1&i){const n=e.RV6();e.j41(0,"div",34)(1,"ion-note",35),e.nrm(2,"ion-icon",36),e.EFF(3," Account already exists for this employee. "),e.k0s(),e.j41(4,"ion-button",37),e.bIt("click",function(){e.eBV(n);const t=e.XpG();return e.Njj(t.goToLogin())}),e.EFF(5," Go to Login "),e.k0s()()}}let k=(()=>{class i{constructor(n,o,t,s){this.http=n,this.router=o,this.alertController=t,this.toastController=s,this.employeeId="",this.password="",this.confirmPassword="",this.isChecking=!1,this.isRegistering=!1,this.employeeFound=!1,this.rolePreview=null,this.passwordStrength="weak",(0,f.d)({personOutline:c.wAZ,lockClosedOutline:c.eso,mailOutline:c.SM1,checkmarkCircle:c.AUS,alertCircle:c.nVl,informationCircle:c.rxM})}ngOnInit(){}checkEmployeeId(){var n=this;return(0,p.A)(function*(){if(n.employeeId&&""!==n.employeeId.trim()){n.isChecking=!0,n.employeeFound=!1,n.rolePreview=null;try{const o=yield n.http.get(`${u.c.apiUrl}/auth/user/preview-role/${n.employeeId}`).toPromise();o&&(n.rolePreview=o,n.employeeFound=!0,o.userExists?yield n.showAlert("Account Already Exists",`An account already exists for ${o.employee.fullName}. Please login instead.`,"warning"):yield n.showToast("Employee verified! You can now register.","success"))}catch(o){console.error("Employee check error:",o),404===o.status?yield n.showAlert("Employee Not Found",o.error?.message||"No employee found with this ID, Number, or Email. Please check and try again.","danger"):400===o.status?yield n.showAlert("Validation Error",o.error?.message||o.error?.error||"Please verify your Employee information with HR.","warning"):yield n.showToast("Failed to verify employee","danger")}finally{n.isChecking=!1}}else yield n.showToast("Please enter your Employee ID, Number, or Work Email","warning")})()}checkPasswordStrength(){const n=this.password;if(!n)return void(this.passwordStrength="weak");let o=0;n.length>=8&&o++,n.length>=12&&o++,/[A-Z]/.test(n)&&o++,/[a-z]/.test(n)&&o++,/[0-9]/.test(n)&&o++,/[^A-Za-z0-9]/.test(n)&&o++,this.passwordStrength=o<=2?"weak":o<=4?"medium":"strong"}register(){var n=this;return(0,p.A)(function*(){if(n.employeeId&&n.password&&n.confirmPassword)if(n.employeeFound&&n.rolePreview)if(n.rolePreview.userExists)yield n.showToast("Account already exists. Please login.","warning");else if(n.password===n.confirmPassword)if(n.password.length<8)yield n.showToast("Password must be at least 8 characters","danger");else{n.isRegistering=!0;try{const o=yield n.http.post(`${u.c.apiUrl}/auth/user/create-auto`,{employee_id:n.employeeId,password:n.password}).toPromise();yield n.showSuccessAlert(o)}catch(o){console.error("Registration error:",o),409===o.status?yield n.showAlert("Account Exists","An account already exists for this employee.","warning"):404===o.status?yield n.showAlert("Employee Not Found",o.error?.message||"Please verify your Employee ID or Number.","danger"):400===o.status?yield n.showAlert("Invalid Request",o.error?.message||o.error?.error||"Please check your input.","warning"):yield n.showToast(o.error?.error||"Registration failed","danger")}finally{n.isRegistering=!1}}else yield n.showToast("Passwords do not match","danger");else yield n.showToast("Please verify your Employee ID first","warning");else yield n.showToast("Please fill in all fields","warning")})()}showSuccessAlert(n){var o=this;return(0,p.A)(function*(){const t=`Welcome, ${n.employee.fullName}!\n\nYour account has been created successfully.\n\nEmail: ${n.user.username}\nRole: ${n.user.role.toUpperCase()}\n\n${n.roleAssignmentReason}`;yield(yield o.alertController.create({header:"\u2705 Registration Successful!",message:t,cssClass:"success-alert",buttons:[{text:"Go to Login",cssClass:"alert-button-confirm",handler:()=>{o.router.navigate(["/login"])}}],backdropDismiss:!1})).present()})()}showAlert(n,o){var t=this;return(0,p.A)(function*(s,g,I="success"){yield(yield t.alertController.create({header:s,message:g,cssClass:`alert-${I}`,buttons:["OK"]})).present()}).apply(this,arguments)}showToast(n){var o=this;return(0,p.A)(function*(t,s="primary"){yield(yield o.toastController.create({message:t,duration:3e3,position:"top",color:s})).present()}).apply(this,arguments)}goToLogin(){this.router.navigate(["/login"])}getRoleBadgeColor(n){switch(n.toLowerCase()){case"hr":return"primary";case"manager":return"success";case"employee":default:return"medium";case"admin":return"danger"}}getPasswordStrengthColor(){switch(this.passwordStrength){case"weak":return"danger";case"medium":return"warning";case"strong":return"success";default:return"medium"}}static{this.\u0275fac=function(o){return new(o||i)(e.rXU(h.Qq),e.rXU(P.Ix),e.rXU(r.hG),e.rXU(r.K_))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-register"]],standalone:!0,features:[e.aNF],decls:30,vars:8,consts:[[1,"ion-padding"],[1,"register-container"],[1,"header-section"],[1,"form-section"],["name","person-outline","slot","start"],["position","floating"],["type","text","placeholder","Enter Employee ID, Number, or Work Email",3,"ngModelChange","ngModel","disabled"],["expand","block",1,"verify-button",3,"click","disabled"],["name","crescent",4,"ngIf"],[4,"ngIf"],["class","employee-info",4,"ngIf"],["class","form-section password-section",4,"ngIf"],["class","existing-account",4,"ngIf"],[1,"login-link"],[3,"click"],["name","crescent"],[1,"employee-info"],["color","light"],[1,"info-row"],["name","checkmark-circle","color","success"],[1,"info-details"],[1,"role-info"],[3,"color"],["name","information-circle","size","small"],["color","medium",4,"ngIf"],["color","medium"],[1,"form-section","password-section"],["name","lock-closed-outline","slot","start"],["type","password","placeholder","Create a strong password",3,"ngModelChange","ngModel"],["class","password-strength",4,"ngIf"],["type","password","placeholder","Re-enter your password",3,"ngModelChange","ngModel"],["color","medium",1,"password-hint"],["expand","block","color","primary",1,"register-button",3,"click","disabled"],[1,"password-strength"],[1,"existing-account"],["color","warning"],["name","alert-circle"],["expand","block","fill","outline",3,"click"]],template:function(o,t){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Register"),e.k0s()()(),e.j41(4,"ion-content",0)(5,"div",1)(6,"div",2)(7,"h1"),e.EFF(8,"Create Your Account"),e.k0s(),e.j41(9,"p"),e.EFF(10,"Register using your Employee ID, Number, or Work Email"),e.k0s()(),e.j41(11,"ion-card")(12,"ion-card-content")(13,"div",3)(14,"ion-item"),e.nrm(15,"ion-icon",4),e.j41(16,"ion-label",5),e.EFF(17,"Employee ID / Number / Email"),e.k0s(),e.j41(18,"ion-input",6),e.mxI("ngModelChange",function(g){return e.DH7(t.employeeId,g)||(t.employeeId=g),g}),e.k0s()(),e.j41(19,"ion-button",7),e.bIt("click",function(){return t.checkEmployeeId()}),e.DNE(20,C,1,0,"ion-spinner",8)(21,y,2,1,"span",9),e.k0s()(),e.DNE(22,w,21,8,"div",10)(23,E,17,6,"div",11)(24,R,6,0,"div",12),e.k0s()(),e.j41(25,"div",13)(26,"ion-text"),e.EFF(27," Already have an account? "),e.j41(28,"a",14),e.bIt("click",function(){return t.goToLogin()}),e.EFF(29,"Login here"),e.k0s()()()()()),2&o&&(e.R7$(18),e.R50("ngModel",t.employeeId),e.Y8G("disabled",t.isChecking||t.employeeFound),e.R7$(),e.Y8G("disabled",t.isChecking||!t.employeeId||t.employeeFound),e.R7$(),e.Y8G("ngIf",t.isChecking),e.R7$(),e.Y8G("ngIf",!t.isChecking),e.R7$(),e.Y8G("ngIf",t.rolePreview&&t.employeeFound),e.R7$(),e.Y8G("ngIf",t.employeeFound&&!(null!=t.rolePreview&&t.rolePreview.userExists)),e.R7$(),e.Y8G("ngIf",null==t.rolePreview?null:t.rolePreview.userExists))},dependencies:[_.MD,_.bT,d.YN,d.BC,d.vS,r.W9,r.eU,r.BC,r.ai,r.b_,r.I9,r.uz,r.he,r.$w,r.Jm,r.IO,r.w2,r.iq,r.JI,r.In],styles:[".register-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px 0}.header-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.header-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:600;color:var(--ion-color-primary);margin-bottom:8px}.header-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:16px}.form-section[_ngcontent-%COMP%]{margin-bottom:24px}.form-section[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:16px}.form-section[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:16px}.verify-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);margin-top:12px}.verify-button[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-right:8px}.employee-info[_ngcontent-%COMP%]{margin:20px 0;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}.employee-info[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{margin:0}.employee-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px}.employee-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;margin-top:4px}.employee-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-details[_ngcontent-%COMP%]{flex:1}.employee-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-details[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:18px;color:var(--ion-color-dark);display:block;margin-bottom:4px}.employee-info[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;color:var(--ion-color-medium);font-size:14px}.employee-info[_ngcontent-%COMP%]   .role-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background:var(--ion-color-light);border-radius:8px;margin-top:12px}.employee-info[_ngcontent-%COMP%]   .role-info[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{font-size:12px;padding:6px 12px;font-weight:600}.employee-info[_ngcontent-%COMP%]   .role-info[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:13px;flex:1}.employee-info[_ngcontent-%COMP%]   .role-info[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.employee-info[_ngcontent-%COMP%] > ion-note[_ngcontent-%COMP%]{display:block;margin-top:8px;font-size:12px}.password-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}.password-strength[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:8px 0 16px}.password-strength[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:13px}.password-strength[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{font-size:11px;padding:4px 8px}.password-hint[_ngcontent-%COMP%]{display:block;font-size:12px;margin-top:8px;padding:8px 12px;background:var(--ion-color-light);border-radius:4px;line-height:1.4}.register-button[_ngcontent-%COMP%]{margin-top:24px;--background: var(--ion-color-success);font-weight:600}.register-button[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-right:8px}.existing-account[_ngcontent-%COMP%]{text-align:center;padding:20px 0;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}.existing-account[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px;font-size:14px;margin-bottom:16px}.existing-account[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.login-link[_ngcontent-%COMP%]{text-align:center;margin-top:24px}.login-link[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.login-link[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;font-weight:500;cursor:pointer}.login-link[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}  .success-alert .alert-message{white-space:pre-line;text-align:left;line-height:1.6;font-size:14px}  .success-alert .alert-button-confirm{font-weight:600;color:var(--ion-color-success)}@media (max-width: 768px){.register-container[_ngcontent-%COMP%]{padding:10px 0}.header-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.header-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}}"]})}}return i})()}}]);