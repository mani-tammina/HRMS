"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[298],{3298:(j,y,s)=>{s.r(y),s.d(y,{PayrollPage:()=>k});var g=s(467),c=s(177),u=s(4341),o=s(9907),m=s(2951),d=s(5873),t=s(4438),f=s(5312),h=s(1626);let P=(()=>{class i{constructor(n){this.http=n,this.apiUrl=`${f.c.apiUrl}/payroll`}generatePayroll(n,e){return this.http.post(`${this.apiUrl}/generate`,{month:n,year:e})}getPayrollRuns(n,e,a){let r={};return n&&(r.month=n.toString()),e&&(r.year=e.toString()),a&&(r.status=a),this.http.get(this.apiUrl,{params:r})}getPayrollRunDetails(n){return this.http.get(`${this.apiUrl}/${n}`)}getMyPayslips(){return this.http.get(`${this.apiUrl}/my-payslips`)}getSalaryStructure(n){return this.http.get(n?`${this.apiUrl}/salary-structure/${n}`:`${this.apiUrl}/my-salary-structure`)}updateSalaryStructure(n,e){return this.http.put(`${this.apiUrl}/salary-structure/${n}`,e)}finalizePayroll(n){return this.http.put(`${this.apiUrl}/${n}/finalize`,{})}markAsPaid(n){return this.http.put(`${this.apiUrl}/${n}/mark-paid`,{})}static{this.\u0275fac=function(e){return new(e||i)(t.KVO(h.Qq))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function F(i,p){if(1&i&&(t.j41(0,"ion-select-option",8),t.EFF(1),t.k0s()),2&i){const n=p.$implicit;t.Y8G("value",n),t.R7$(),t.JRh(n)}}function _(i,p){1&i&&(t.j41(0,"div",9)(1,"ion-card")(2,"ion-card-content")(3,"p"),t.EFF(4,"Loading payslips..."),t.k0s()()()())}function v(i,p){if(1&i){const n=t.RV6();t.j41(0,"ion-button",25),t.bIt("click",function(){t.eBV(n);const a=t.XpG().$implicit,r=t.XpG(2);return t.Njj(r.downloadPayslip(a))}),t.nrm(1,"ion-icon",26),t.EFF(2," Download Payslip "),t.k0s()}}function C(i,p){if(1&i&&(t.j41(0,"ion-card",11)(1,"ion-card-header")(2,"div",12)(3,"div")(4,"ion-card-title"),t.EFF(5),t.k0s(),t.j41(6,"p",13),t.EFF(7),t.k0s()(),t.j41(8,"ion-badge",14),t.EFF(9),t.k0s()()(),t.j41(10,"ion-card-content")(11,"div",15)(12,"div",16)(13,"span",17),t.EFF(14,"Gross Salary:"),t.k0s(),t.j41(15,"span",18),t.EFF(16),t.nI1(17,"number"),t.k0s()(),t.j41(18,"div",16)(19,"span",17),t.EFF(20,"Deductions:"),t.k0s(),t.j41(21,"span",19),t.EFF(22),t.nI1(23,"number"),t.k0s()(),t.j41(24,"div",20)(25,"span",17)(26,"strong"),t.EFF(27,"Net Salary:"),t.k0s()(),t.j41(28,"span",18)(29,"strong"),t.EFF(30),t.nI1(31,"number"),t.k0s()()()(),t.j41(32,"div",21)(33,"div",22),t.nrm(34,"ion-icon",23),t.j41(35,"span"),t.EFF(36),t.k0s()(),t.j41(37,"div",22),t.nrm(38,"ion-icon",23),t.j41(39,"span"),t.EFF(40),t.k0s()(),t.j41(41,"div",22),t.nrm(42,"ion-icon",23),t.j41(43,"span"),t.EFF(44),t.k0s()()(),t.DNE(45,v,3,0,"ion-button",24),t.k0s()()),2&i){const n=p.$implicit,e=t.XpG(2);t.R7$(5),t.Lme("",e.getMonthName(n.month)," ",n.year,""),t.R7$(2),t.Lme("",n.employee_name," (",n.employee_code,")"),t.R7$(),t.Y8G("color",e.getStatusColor(n.status)),t.R7$(),t.JRh(n.status),t.R7$(7),t.SpI("\u20b9",t.i5U(17,13,n.gross_salary,"1.2-2"),""),t.R7$(6),t.SpI("-\u20b9",t.i5U(23,16,n.total_deductions,"1.2-2"),""),t.R7$(8),t.SpI("\u20b9",t.i5U(31,19,n.net_salary,"1.2-2"),""),t.R7$(6),t.SpI("Working Days: ",n.working_days,""),t.R7$(4),t.SpI("Present: ",n.present_days,""),t.R7$(4),t.SpI("Leaves: ",n.leave_days,""),t.R7$(),t.Y8G("ngIf","paid"===n.status)}}function M(i,p){if(1&i&&(t.j41(0,"div"),t.DNE(1,C,46,22,"ion-card",10),t.k0s()),2&i){const n=t.XpG();t.R7$(),t.Y8G("ngForOf",n.filteredPayslips)}}function $(i,p){if(1&i&&(t.j41(0,"ion-card")(1,"ion-card-content",27),t.nrm(2,"ion-icon",28),t.j41(3,"h3"),t.EFF(4,"No Payslips Found"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s()()()),2&i){const n=t.XpG();t.R7$(6),t.SpI("No payslips available for ",n.selectedYear,"")}}let k=(()=>{class i{constructor(n,e,a){this.payrollService=n,this.loadingController=e,this.toastController=a,this.payslips=[],this.filteredPayslips=[],this.isLoading=!1,this.selectedYear=(new Date).getFullYear(),this.years=[],(0,m.d)({downloadOutline:d.fPB,calendarOutline:d.RXF,cashOutline:d.A3w,documentTextOutline:d.pXZ});const r=(new Date).getFullYear();for(let l=0;l<3;l++)this.years.push(r-l)}ngOnInit(){this.loadPayslips()}loadPayslips(n){var e=this;return(0,g.A)(function*(){n||(e.isLoading=!0),e.payrollService.getMyPayslips().subscribe({next:a=>{e.payslips=a.payslips,e.applyFilter(),e.isLoading=!1,n&&n.target.complete()},error:a=>{console.error("Error loading payslips:",a),e.showToast("Failed to load payslips","danger"),e.isLoading=!1,n&&n.target.complete()}})})()}applyFilter(){this.filteredPayslips=this.payslips.filter(n=>n.year===this.selectedYear)}onYearChange(){this.applyFilter()}getMonthName(n){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(n)-1]||n}getStatusColor(n){switch(n?.toLowerCase()){case"paid":return"success";case"finalized":return"warning";default:return"medium"}}downloadPayslip(n){var e=this;return(0,g.A)(function*(){const a=yield e.loadingController.create({message:"Downloading payslip..."});yield a.present(),yield a.dismiss(),e.showToast("Payslip download will be available soon","warning")})()}showToast(n,e){var a=this;return(0,g.A)(function*(){yield(yield a.toastController.create({message:n,duration:3e3,color:e,position:"bottom"})).present()})()}static{this.\u0275fac=function(e){return new(e||i)(t.rXU(P),t.rXU(o.Xi),t.rXU(o.K_))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-payroll"]],standalone:!0,features:[t.aNF],decls:19,vars:5,consts:[["slot","start"],["defaultHref","/tabs/home"],["slot","fixed",3,"ionRefresh"],["lines","none"],["interface","popover",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"loading-container"],["class","payslip-card",4,"ngFor","ngForOf"],[1,"payslip-card"],[1,"payslip-header"],[1,"employee-info"],[3,"color"],[1,"salary-details"],[1,"salary-row"],[1,"label"],[1,"value"],[1,"value","deduction"],[1,"salary-row","net"],[1,"attendance-info"],[1,"info-item"],["name","calendar-outline"],["expand","block",3,"click",4,"ngIf"],["expand","block",3,"click"],["name","download-outline","slot","start"],[1,"empty-state"],["name","document-text-outline","size","large"]],template:function(e,a){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t.nrm(3,"ion-back-button",1),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"My Payslips"),t.k0s()()(),t.j41(6,"ion-content")(7,"ion-refresher",2),t.bIt("ionRefresh",function(l){return a.loadPayslips(l)}),t.nrm(8,"ion-refresher-content"),t.k0s(),t.j41(9,"ion-card")(10,"ion-card-content")(11,"ion-item",3)(12,"ion-label"),t.EFF(13,"Year"),t.k0s(),t.j41(14,"ion-select",4),t.mxI("ngModelChange",function(l){return t.DH7(a.selectedYear,l)||(a.selectedYear=l),l}),t.bIt("ionChange",function(){return a.onYearChange()}),t.DNE(15,F,2,2,"ion-select-option",5),t.k0s()()()(),t.DNE(16,_,5,0,"div",6)(17,M,2,1,"div",7)(18,$,7,1,"ion-card",7),t.k0s()),2&e&&(t.R7$(14),t.R50("ngModel",a.selectedYear),t.R7$(),t.Y8G("ngForOf",a.years),t.R7$(),t.Y8G("ngIf",a.isLoading),t.R7$(),t.Y8G("ngIf",!a.isLoading&&a.filteredPayslips.length>0),t.R7$(),t.Y8G("ngIf",!a.isLoading&&0===a.filteredPayslips.length))},dependencies:[c.MD,c.Sq,c.bT,c.QX,u.YN,u.BC,u.vS,o.W9,o.eU,o.BC,o.ai,o.QW,o.el,o.b_,o.I9,o.ME,o.tN,o.uz,o.he,o.In,o.Jm,o.iq,o.To,o.Ki,o.Nm,o.Ip],styles:[".payslip-card[_ngcontent-%COMP%]{margin:12px}.payslip-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.employee-info[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.9em;margin-top:4px}.salary-details[_ngcontent-%COMP%]{margin:16px 0;padding:16px;background:var(--ion-color-light);border-radius:8px}.salary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0}.salary-row.net[_ngcontent-%COMP%]{border-top:2px solid var(--ion-color-primary);margin-top:8px;padding-top:12px;font-size:1.1em}.value.deduction[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.attendance-info[_ngcontent-%COMP%]{display:flex;gap:16px;margin:16px 0;flex-wrap:wrap}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:.9em;color:var(--ion-color-medium)}.info-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2em}.loading-container[_ngcontent-%COMP%]{padding:20px;text-align:center}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0 8px;color:var(--ion-color-dark)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium)}"]})}}return i})()}}]);