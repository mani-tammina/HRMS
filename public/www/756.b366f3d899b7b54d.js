"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[756],{4756:(j,g,c)=>{c.r(g),c.d(g,{SupportPage:()=>M});var m=c(467),d=c(177),u=c(4341),r=c(7820),f=c(2951),p=c(5873),t=c(4438),k=c(5312),_=c(1626);let C=(()=>{class o{constructor(e){this.http=e,this.apiUrl=`${k.c.apiUrl}/support`}getAllTickets(e,n,i){let a={};return e&&(a.status=e),n&&(a.category=n),i&&(a.priority=i),this.http.get(this.apiUrl,{params:a})}getMyTickets(e){let n={};return e&&(n.status=e),this.http.get(`${this.apiUrl}/my-tickets`,{params:n})}getTicket(e){return this.http.get(`${this.apiUrl}/${e}`)}createTicket(e){return this.http.post(this.apiUrl,e)}updateTicket(e,n){return this.http.put(`${this.apiUrl}/${e}`,n)}closeTicket(e,n){return this.http.put(`${this.apiUrl}/${e}/close`,{resolution_notes:n})}addComment(e,n){return this.http.post(`${this.apiUrl}/${e}/comment`,{comment:n})}static{this.\u0275fac=function(n){return new(n||o)(t.KVO(_.Qq))}}static{this.\u0275prov=t.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var T=c(3799);function b(o,l){if(1&o&&(t.j41(0,"span",26),t.EFF(1),t.k0s()),2&o){const e=t.XpG().$implicit;t.R7$(),t.SpI(" Assigned to: ",e.assigned_to_name," ")}}function v(o,l){if(1&o){const e=t.RV6();t.j41(0,"ion-card",13),t.bIt("click",function(){const i=t.eBV(e).$implicit,a=t.XpG(2);return t.Njj(a.viewTicket(i))}),t.j41(1,"ion-card-content")(2,"div",14)(3,"div",15),t.nrm(4,"ion-icon",16),t.j41(5,"span"),t.EFF(6),t.k0s()(),t.j41(7,"ion-badge",17),t.nrm(8,"ion-icon",18),t.EFF(9),t.k0s()(),t.j41(10,"h3",19),t.EFF(11),t.k0s(),t.j41(12,"p",20),t.EFF(13),t.k0s(),t.j41(14,"div",21)(15,"ion-chip",17)(16,"ion-label"),t.EFF(17),t.k0s()(),t.j41(18,"ion-chip",17)(19,"ion-label"),t.EFF(20),t.k0s()()(),t.j41(21,"div",22)(22,"span",23),t.nrm(23,"ion-icon",24),t.EFF(24),t.k0s(),t.DNE(25,b,2,1,"span",25),t.k0s()()()}if(2&o){const e=l.$implicit,n=t.XpG(2);t.R7$(6),t.SpI("#",e.id,""),t.R7$(),t.Y8G("color",n.getStatusColor(e.status)),t.R7$(),t.Y8G("name",n.getStatusIcon(e.status)),t.R7$(),t.SpI(" ",e.status," "),t.R7$(2),t.JRh(e.subject),t.R7$(2),t.JRh(e.description),t.R7$(2),t.Y8G("color",n.getCategoryColor(e.category)),t.R7$(2),t.JRh(e.category),t.R7$(),t.Y8G("color",n.getPriorityColor(e.priority)),t.R7$(2),t.JRh(e.priority),t.R7$(4),t.SpI(" ",n.formatDate(e.created_at)," "),t.R7$(),t.Y8G("ngIf",e.assigned_to_name)}}function y(o,l){if(1&o&&(t.j41(0,"div"),t.DNE(1,v,26,12,"ion-card",12),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.filteredTickets)}}function F(o,l){1&o&&(t.j41(0,"p"),t.EFF(1,"You haven't created any support tickets yet"),t.k0s())}function P(o,l){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.k0s()),2&o){const e=t.XpG(2);t.R7$(),t.SpI("No tickets with status: ",e.selectedStatus,"")}}function S(o,l){if(1&o){const e=t.RV6();t.j41(0,"ion-card")(1,"ion-card-content",27),t.nrm(2,"ion-icon",28),t.j41(3,"h3"),t.EFF(4,"No Tickets Found"),t.k0s(),t.DNE(5,F,2,0,"p",8)(6,P,2,1,"p",8),t.j41(7,"ion-button",10),t.bIt("click",function(){t.eBV(e);const i=t.XpG();return t.Njj(i.createTicket())}),t.nrm(8,"ion-icon",29),t.EFF(9," Create Ticket "),t.k0s()()()}if(2&o){const e=t.XpG();t.R7$(5),t.Y8G("ngIf","all"===e.selectedStatus),t.R7$(),t.Y8G("ngIf","all"!==e.selectedStatus)}}let M=(()=>{class o{constructor(e,n,i,a){this.supportService=e,this.loadingController=n,this.toastController=i,this.router=a,this.tickets=[],this.filteredTickets=[],this.isLoading=!1,this.selectedStatus="all",this.searchTerm="",(0,f.d)({addOutline:p.EKF,ticketOutline:p.bHE,timeOutline:p.CVk,checkmarkCircleOutline:p.gz2,closeCircleOutline:p.p9N})}ngOnInit(){this.loadTickets()}loadTickets(e){var n=this;return(0,m.A)(function*(){e||(n.isLoading=!0),n.supportService.getMyTickets().subscribe({next:i=>{n.tickets=i.tickets.sort((a,s)=>new Date(s.created_at).getTime()-new Date(a.created_at).getTime()),n.applyFilters(),n.isLoading=!1,e&&e.target.complete()},error:i=>{console.error("Error loading tickets:",i),n.showToast("Failed to load tickets","danger"),n.isLoading=!1,e&&e.target.complete()}})})()}segmentChanged(e){this.selectedStatus=e.detail.value,this.applyFilters()}onSearchChange(e){this.searchTerm=e.detail.value,this.applyFilters()}applyFilters(){let e=[...this.tickets];if("all"!==this.selectedStatus&&(e=e.filter(n=>n.status===this.selectedStatus)),this.searchTerm){const n=this.searchTerm.toLowerCase();e=e.filter(i=>i.subject.toLowerCase().includes(n)||i.description.toLowerCase().includes(n)||i.category.toLowerCase().includes(n))}this.filteredTickets=e}createTicket(){this.router.navigate(["/support/create"])}viewTicket(e){this.router.navigate(["/support",e.id])}getStatusColor(e){switch(e?.toLowerCase()){case"open":return"warning";case"in-progress":return"primary";case"resolved":return"success";default:return"medium"}}getStatusIcon(e){switch(e?.toLowerCase()){case"resolved":return"checkmark-circle-outline";case"closed":return"close-circle-outline";default:return"time-outline"}}getPriorityColor(e){switch(e?.toLowerCase()){case"critical":case"high":return"danger";case"medium":return"warning";case"low":return"success";default:return"medium"}}getCategoryColor(e){switch(e?.toLowerCase()){case"it":return"primary";case"hr":return"secondary";case"payroll":return"success";case"leave":return"warning";case"attendance":return"tertiary";default:return"medium"}}formatDate(e){const n=new Date(e),a=(new Date).getTime()-n.getTime(),s=Math.floor(a/36e5),h=Math.floor(s/24);return s<1?"Just now":s<24?`${s}h ago`:h<7?`${h}d ago`:n.toLocaleDateString("en-US",{month:"short",day:"numeric"})}showToast(e,n){var i=this;return(0,m.A)(function*(){yield(yield i.toastController.create({message:e,duration:3e3,color:n,position:"bottom"})).present()})()}static{this.\u0275fac=function(n){return new(n||o)(t.rXU(C),t.rXU(r.Xi),t.rXU(r.K_),t.rXU(T.Ix))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-support"]],standalone:!0,features:[t.aNF],decls:28,vars:4,consts:[["slot","start"],["defaultHref","/tabs/home"],["placeholder","Search tickets...",3,"ngModelChange","ionInput","ngModel"],[3,"ngModelChange","ionChange","ngModel"],["value","all"],["value","open"],["value","in-progress"],["value","resolved"],[4,"ngIf"],["slot","fixed","vertical","bottom","horizontal","end"],[3,"click"],["name","add-outline"],["class","ticket-card",3,"click",4,"ngFor","ngForOf"],[1,"ticket-card",3,"click"],[1,"ticket-header"],[1,"ticket-id"],["name","ticket-outline"],[3,"color"],[3,"name"],[1,"ticket-subject"],[1,"ticket-description"],[1,"ticket-meta"],[1,"ticket-footer"],[1,"created-date"],["name","time-outline"],["class","assigned-to",4,"ngIf"],[1,"assigned-to"],[1,"empty-state"],["name","ticket-outline","size","large"],["name","add-outline","slot","start"]],template:function(n,i){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t.nrm(3,"ion-back-button",1),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Support Tickets"),t.k0s()(),t.j41(6,"ion-toolbar")(7,"ion-searchbar",2),t.mxI("ngModelChange",function(s){return t.DH7(i.searchTerm,s)||(i.searchTerm=s),s}),t.bIt("ionInput",function(s){return i.onSearchChange(s)}),t.k0s()(),t.j41(8,"ion-toolbar")(9,"ion-segment",3),t.mxI("ngModelChange",function(s){return t.DH7(i.selectedStatus,s)||(i.selectedStatus=s),s}),t.bIt("ionChange",function(s){return i.segmentChanged(s)}),t.j41(10,"ion-segment-button",4)(11,"ion-label"),t.EFF(12,"All"),t.k0s()(),t.j41(13,"ion-segment-button",5)(14,"ion-label"),t.EFF(15,"Open"),t.k0s()(),t.j41(16,"ion-segment-button",6)(17,"ion-label"),t.EFF(18,"In Progress"),t.k0s()(),t.j41(19,"ion-segment-button",7)(20,"ion-label"),t.EFF(21,"Resolved"),t.k0s()()()()(),t.j41(22,"ion-content"),t.DNE(23,y,2,1,"div",8)(24,S,10,2,"ion-card",8),t.j41(25,"ion-fab",9)(26,"ion-fab-button",10),t.bIt("click",function(){return i.createTicket()}),t.nrm(27,"ion-icon",11),t.k0s()()()),2&n&&(t.R7$(7),t.R50("ngModel",i.searchTerm),t.R7$(2),t.R50("ngModel",i.selectedStatus),t.R7$(14),t.Y8G("ngIf",!i.isLoading&&i.filteredTickets.length>0),t.R7$(),t.Y8G("ngIf",!i.isLoading&&0===i.filteredTickets.length))},dependencies:[d.MD,d.Sq,d.bT,u.YN,u.BC,u.vS,r.W9,r.eU,r.BC,r.ai,r.QW,r.el,r.b_,r.I9,r.he,r.In,r.Jm,r.iq,r.Q8,r.YW,r.Gp,r.eP,r.S1,r.ZB],styles:[".ticket-card[_ngcontent-%COMP%]{margin:12px;cursor:pointer;transition:transform .2s,box-shadow .2s}.ticket-card[_ngcontent-%COMP%]:active{transform:scale(.98)}.ticket-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.ticket-id[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-weight:600;color:var(--ion-color-primary);font-size:.9em}.ticket-id[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2em}.ticket-subject[_ngcontent-%COMP%]{margin:8px 0;font-size:1.1em;color:var(--ion-color-dark)}.ticket-description[_ngcontent-%COMP%]{margin:8px 0;color:var(--ion-color-medium);font-size:.9em;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.ticket-meta[_ngcontent-%COMP%]{display:flex;gap:8px;margin:12px 0;flex-wrap:wrap}.ticket-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:12px;padding-top:12px;border-top:1px solid var(--ion-color-light);font-size:.85em;color:var(--ion-color-medium)}.ticket-footer[_ngcontent-%COMP%]   .created-date[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.ticket-footer[_ngcontent-%COMP%]   .created-date[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.1em}.ticket-footer[_ngcontent-%COMP%]   .assigned-to[_ngcontent-%COMP%]{font-weight:500}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0 8px;color:var(--ion-color-dark)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:24px}ion-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 12px}ion-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1em}"]})}}return o})()}}]);