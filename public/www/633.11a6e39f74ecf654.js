"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[633],{4633:(G,g,s)=>{s.r(g),s.d(g,{LeavePlanDetailPage:()=>R});var p=s(467),r=s(177),d=s(4341),l=s(773),u=s(2951),c=s(5873),n=s(4438),m=s(3799),P=s(7097);function f(a,_){if(1&a){const e=n.RV6();n.j41(0,"ion-button",8),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.toggleEdit())}),n.nrm(1,"ion-icon",9),n.k0s()}}function h(a,_){if(1&a){const e=n.RV6();n.j41(0,"ion-button",10),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.savePlan())}),n.nrm(1,"ion-icon",11),n.k0s()}if(2&a){const e=n.XpG();n.Y8G("disabled",e.isSaving)}}function y(a,_){1&a&&(n.j41(0,"div",12),n.nrm(1,"ion-spinner",13),n.j41(2,"p"),n.EFF(3,"Loading plan details..."),n.k0s()())}function M(a,_){if(1&a&&(n.j41(0,"ion-select-option",24),n.EFF(1),n.k0s()),2&a){const e=_.$implicit;n.Y8G("value",e.value),n.R7$(),n.SpI(" ",e.name," ")}}function b(a,_){if(1&a){const e=n.RV6();n.j41(0,"ion-button",25),n.bIt("click",function(){n.eBV(e);const t=n.XpG(2);return n.Njj(t.addAllocation())}),n.nrm(1,"ion-icon",26),n.EFF(2," Add "),n.k0s()}}function E(a,_){if(1&a){const e=n.RV6();n.j41(0,"ion-button",8),n.bIt("click",function(){n.eBV(e);const t=n.XpG(3);return n.Njj(t.addAllocation())}),n.nrm(1,"ion-icon",26),n.EFF(2," Add Allocation "),n.k0s()}}function D(a,_){if(1&a&&(n.j41(0,"div",27)(1,"p"),n.EFF(2,"No allocations added yet"),n.k0s(),n.DNE(3,E,3,0,"ion-button",4),n.k0s()),2&a){const e=n.XpG(2);n.R7$(3),n.Y8G("ngIf",e.isEditing)}}function C(a,_){if(1&a&&(n.j41(0,"ion-select-option",24),n.EFF(1),n.k0s()),2&a){const e=_.$implicit;n.Y8G("value",e.id),n.R7$(),n.Lme(" ",e.type_name," (",e.type_code,") ")}}function j(a,_){if(1&a){const e=n.RV6();n.j41(0,"ion-button",35),n.bIt("click",function(){n.eBV(e);const t=n.XpG().index,o=n.XpG(3);return n.Njj(o.removeAllocation(t))}),n.nrm(1,"ion-icon",36),n.k0s()}}function x(a,_){1&a&&(n.j41(0,"ion-badge",39),n.EFF(1,"Prorated"),n.k0s())}function k(a,_){if(1&a&&(n.j41(0,"div",37)(1,"p")(2,"strong"),n.EFF(3),n.k0s(),n.EFF(4),n.k0s(),n.j41(5,"ion-badge",0),n.EFF(6),n.k0s(),n.DNE(7,x,2,0,"ion-badge",38),n.k0s()),2&a){const e=n.XpG().$implicit;n.R7$(3),n.JRh(e.type_name),n.R7$(),n.SpI(" (",e.type_code,")"),n.R7$(2),n.SpI("",e.days_allocated," days"),n.R7$(),n.Y8G("ngIf",e.prorate_on_joining)}}function L(a,_){if(1&a){const e=n.RV6();n.j41(0,"ion-item")(1,"div",29)(2,"div",30)(3,"ion-select",31),n.mxI("ngModelChange",function(t){const o=n.eBV(e).$implicit;return n.DH7(o.leave_type_id,t)||(o.leave_type_id=t),n.Njj(t)}),n.DNE(4,C,2,3,"ion-select-option",17),n.k0s(),n.j41(5,"ion-input",32),n.mxI("ngModelChange",function(t){const o=n.eBV(e).$implicit;return n.DH7(o.days_allocated,t)||(o.days_allocated=t),n.Njj(t)}),n.k0s()(),n.j41(6,"div",30)(7,"ion-toggle",19),n.mxI("ngModelChange",function(t){const o=n.eBV(e).$implicit;return n.DH7(o.prorate_on_joining,t)||(o.prorate_on_joining=t),n.Njj(t)}),n.EFF(8," Prorate on Joining "),n.k0s(),n.DNE(9,j,2,0,"ion-button",33),n.k0s(),n.DNE(10,k,8,4,"div",34),n.k0s()()}if(2&a){const e=_.$implicit,i=n.XpG(3);n.R7$(3),n.R50("ngModel",e.leave_type_id),n.Y8G("disabled",!i.isEditing),n.R7$(),n.Y8G("ngForOf",i.leaveTypes),n.R7$(),n.R50("ngModel",e.days_allocated),n.Y8G("readonly",!i.isEditing),n.R7$(2),n.R50("ngModel",e.prorate_on_joining),n.Y8G("disabled",!i.isEditing),n.R7$(2),n.Y8G("ngIf",i.isEditing),n.R7$(),n.Y8G("ngIf",!i.isEditing&&e.type_name)}}function I(a,_){if(1&a&&(n.j41(0,"ion-list"),n.DNE(1,L,11,9,"ion-item",28),n.k0s()),2&a){const e=n.XpG(2);n.R7$(),n.Y8G("ngForOf",e.plan.allocations)}}function T(a,_){if(1&a){const e=n.RV6();n.j41(0,"div",40)(1,"ion-button",41),n.bIt("click",function(){n.eBV(e);const t=n.XpG(2);return n.Njj(t.savePlan())}),n.nrm(2,"ion-icon",42),n.EFF(3),n.k0s(),n.j41(4,"ion-button",43),n.bIt("click",function(){n.eBV(e);const t=n.XpG(2);return n.Njj(t.toggleEdit())}),n.EFF(5," Cancel "),n.k0s()()}if(2&a){const e=n.XpG(2);n.R7$(),n.Y8G("disabled",e.isSaving),n.R7$(2),n.SpI(" ",e.isSaving?"Saving...":"Save Changes"," ")}}function O(a,_){if(1&a){const e=n.RV6();n.j41(0,"div")(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),n.EFF(4,"Basic Information"),n.k0s()(),n.j41(5,"ion-card-content")(6,"ion-list")(7,"ion-item")(8,"ion-input",14),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.plan.name,t)||(o.plan.name=t),n.Njj(t)}),n.k0s()(),n.j41(9,"ion-item")(10,"ion-textarea",15),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.plan.description,t)||(o.plan.description=t),n.Njj(t)}),n.k0s()(),n.j41(11,"ion-item")(12,"ion-select",16),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.plan.leave_year_start_month,t)||(o.plan.leave_year_start_month=t),n.Njj(t)}),n.DNE(13,M,2,2,"ion-select-option",17),n.k0s()(),n.j41(14,"ion-item")(15,"ion-input",18),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.plan.leave_year_start_day,t)||(o.plan.leave_year_start_day=t),n.Njj(t)}),n.k0s()(),n.j41(16,"ion-item")(17,"ion-toggle",19),n.mxI("ngModelChange",function(t){n.eBV(e);const o=n.XpG();return n.DH7(o.plan.is_active,t)||(o.plan.is_active=t),n.Njj(t)}),n.EFF(18," Active Status "),n.k0s()()()()(),n.j41(19,"ion-card")(20,"ion-card-header")(21,"ion-card-title"),n.EFF(22," Leave Allocations "),n.DNE(23,b,3,0,"ion-button",20),n.k0s()(),n.j41(24,"ion-card-content"),n.DNE(25,D,4,1,"div",21)(26,I,2,1,"ion-list",7),n.j41(27,"ion-button",22),n.bIt("click",function(){n.eBV(e);const t=n.XpG();return n.Njj(t.goToLeaveTypes())}),n.EFF(28," Manage Leave Types "),n.k0s()()(),n.DNE(29,T,6,2,"div",23),n.k0s()}if(2&a){const e=n.XpG();n.R7$(8),n.R50("ngModel",e.plan.name),n.Y8G("readonly",!e.isEditing),n.R7$(2),n.R50("ngModel",e.plan.description),n.Y8G("readonly",!e.isEditing),n.R7$(2),n.R50("ngModel",e.plan.leave_year_start_month),n.Y8G("disabled",!e.isEditing),n.R7$(),n.Y8G("ngForOf",e.months),n.R7$(2),n.R50("ngModel",e.plan.leave_year_start_day),n.Y8G("readonly",!e.isEditing),n.R7$(2),n.R50("ngModel",e.plan.is_active),n.Y8G("disabled",!e.isEditing),n.R7$(6),n.Y8G("ngIf",e.isEditing),n.R7$(2),n.Y8G("ngIf",!e.plan.allocations||0===e.plan.allocations.length),n.R7$(),n.Y8G("ngIf",e.plan.allocations&&e.plan.allocations.length>0),n.R7$(3),n.Y8G("ngIf",e.isEditing)}}let R=(()=>{class a{constructor(e,i,t,o,v){this.route=e,this.router=i,this.leavePlanService=t,this.alertController=o,this.toastController=v,this.planId=null,this.plan={id:0,name:"",description:"",leave_year_start_month:1,leave_year_start_day:1,is_active:1,allocations:[]},this.leaveTypes=[],this.isLoading=!1,this.isSaving=!1,this.isEditing=!1,this.months=[{value:1,name:"January"},{value:2,name:"February"},{value:3,name:"March"},{value:4,name:"April"},{value:5,name:"May"},{value:6,name:"June"},{value:7,name:"July"},{value:8,name:"August"},{value:9,name:"September"},{value:10,name:"October"},{value:11,name:"November"},{value:12,name:"December"}],(0,u.d)({saveOutline:c.oc8,addOutline:c.EKF,trashOutline:c.P1A,createOutline:c.hmR})}ngOnInit(){const e=this.route.snapshot.paramMap.get("id");e&&(this.planId=parseInt(e),this.loadPlan()),this.loadLeaveTypes()}loadPlan(){this.planId&&(this.isLoading=!0,this.leavePlanService.getLeavePlan(this.planId).subscribe({next:e=>{this.plan=e,this.plan.allocations||(this.plan.allocations=[]),this.isLoading=!1},error:e=>{console.error("Error loading plan:",e),this.showToast("Error loading plan details","danger"),this.isLoading=!1}}))}loadLeaveTypes(){this.leavePlanService.getLeaveTypes().subscribe({next:e=>{this.leaveTypes=e},error:e=>{console.error("Error loading leave types:",e)}})}toggleEdit(){this.isEditing=!this.isEditing}addAllocation(){this.plan.allocations||(this.plan.allocations=[]),this.plan.allocations.push({leave_type_id:0,days_allocated:0,prorate_on_joining:!0})}removeAllocation(e){this.plan.allocations?.splice(e,1)}savePlan(){var e=this;return(0,p.A)(function*(){e.plan.name?(e.isSaving=!0,e.planId&&e.leavePlanService.updateLeavePlan(e.planId,{name:e.plan.name,description:e.plan.description,leave_year_start_month:e.plan.leave_year_start_month,leave_year_start_day:e.plan.leave_year_start_day,is_active:e.plan.is_active?1:0,allocations:e.plan.allocations}).subscribe({next:()=>{e.showToast("Leave plan updated successfully","success"),e.isEditing=!1,e.loadPlan(),e.isSaving=!1},error:t=>{console.error("Error updating plan:",t),e.showToast("Error updating plan","danger"),e.isSaving=!1}})):e.showToast("Plan name is required","warning")})()}getLeaveTypeName(e){const i=this.leaveTypes.find(t=>t.id===e);return i?i.type_name:"Unknown"}showToast(e){var i=this;return(0,p.A)(function*(t,o="primary"){yield(yield i.toastController.create({message:t,duration:2e3,color:o,position:"top"})).present()}).apply(this,arguments)}goToLeaveTypes(){this.router.navigate(["/admin/leave-types"])}static{this.\u0275fac=function(i){return new(i||a)(n.rXU(m.nX),n.rXU(m.Ix),n.rXU(P.c),n.rXU(l.hG),n.rXU(l.K_))}}static{this.\u0275cmp=n.VBU({type:a,selectors:[["app-leave-plan-detail"]],standalone:!0,features:[n.aNF],decls:12,vars:5,consts:[["color","primary"],["slot","start"],["defaultHref","/admin/leave-plans"],["slot","end"],[3,"click",4,"ngIf"],[3,"disabled","click",4,"ngIf"],["class","loading-state",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","icon-only","name","create-outline"],[3,"click","disabled"],["slot","icon-only","name","save-outline"],[1,"loading-state"],["name","crescent","color","primary"],["label","Plan Name","labelPlacement","stacked","placeholder","Enter plan name",3,"ngModelChange","ngModel","readonly"],["label","Description","labelPlacement","stacked","rows","3","placeholder","Enter description",3,"ngModelChange","ngModel","readonly"],["label","Leave Year Start Month","labelPlacement","stacked",3,"ngModelChange","ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],["label","Leave Year Start Day","labelPlacement","stacked","type","number","min","1","max","31","placeholder","1-31",3,"ngModelChange","ngModel","readonly"],[3,"ngModelChange","ngModel","disabled"],["fill","clear","size","small",3,"click",4,"ngIf"],["class","empty-message",4,"ngIf"],["expand","block","fill","outline",2,"margin-top","16px",3,"click"],["class","save-section",4,"ngIf"],[3,"value"],["fill","clear","size","small",3,"click"],["slot","start","name","add-outline"],[1,"empty-message"],[4,"ngFor","ngForOf"],[1,"allocation-item"],[1,"allocation-row"],["label","Leave Type","labelPlacement","stacked",1,"allocation-select",3,"ngModelChange","ngModel","disabled"],["label","Days","labelPlacement","stacked","type","number","min","0",1,"allocation-input",3,"ngModelChange","ngModel","readonly"],["fill","clear","color","danger","size","small",3,"click",4,"ngIf"],["class","readonly-info",4,"ngIf"],["fill","clear","color","danger","size","small",3,"click"],["slot","icon-only","name","trash-outline"],[1,"readonly-info"],["color","secondary",4,"ngIf"],["color","secondary"],[1,"save-section"],["expand","block","color","primary",3,"click","disabled"],["slot","start","name","save-outline"],["expand","block","fill","outline",3,"click"]],template:function(i,t){1&i&&(n.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),n.nrm(3,"ion-back-button",2),n.k0s(),n.j41(4,"ion-title"),n.EFF(5),n.k0s(),n.j41(6,"ion-buttons",3),n.DNE(7,f,2,0,"ion-button",4)(8,h,2,1,"ion-button",5),n.k0s()()(),n.j41(9,"ion-content"),n.DNE(10,y,4,0,"div",6)(11,O,30,15,"div",7),n.k0s()),2&i&&(n.R7$(5),n.JRh(t.plan.name||"Leave Plan Details"),n.R7$(2),n.Y8G("ngIf",!t.isEditing),n.R7$(),n.Y8G("ngIf",t.isEditing),n.R7$(2),n.Y8G("ngIf",t.isLoading),n.R7$(),n.Y8G("ngIf",!t.isLoading))},dependencies:[r.MD,r.Sq,r.bT,d.YN,d.BC,d.vS,l.W9,l.eU,l.BC,l.ai,l.QW,l.el,l.b_,l.I9,l.ME,l.tN,l.nf,l.uz,l.In,l.Jm,l.iq,l.$w,l.nc,l.BY,l.Nm,l.Ip,l.w2],styles:[".loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.loading-state[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{transform:scale(1.5);margin-bottom:20px}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--ion-color-medium)}.allocation-item[_ngcontent-%COMP%]{width:100%;padding:12px 0}.allocation-item[_ngcontent-%COMP%]   .allocation-row[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-end;margin-bottom:12px}.allocation-item[_ngcontent-%COMP%]   .allocation-row[_ngcontent-%COMP%]   .allocation-select[_ngcontent-%COMP%]{flex:2}.allocation-item[_ngcontent-%COMP%]   .allocation-row[_ngcontent-%COMP%]   .allocation-input[_ngcontent-%COMP%]{flex:1}.allocation-item[_ngcontent-%COMP%]   .allocation-row[_ngcontent-%COMP%]   ion-toggle[_ngcontent-%COMP%]{flex:1}.allocation-item[_ngcontent-%COMP%]   .readonly-info[_ngcontent-%COMP%]{padding:8px;background:var(--ion-color-light);border-radius:8px}.allocation-item[_ngcontent-%COMP%]   .readonly-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px}.allocation-item[_ngcontent-%COMP%]   .readonly-info[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{margin-right:8px}.empty-message[_ngcontent-%COMP%]{text-align:center;padding:24px;color:var(--ion-color-medium)}.empty-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:16px}.save-section[_ngcontent-%COMP%]{padding:16px}.save-section[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-bottom:8px}ion-card-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]})}}return a})()}}]);