"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[501],{501:(j,p,c)=>{c.r(p),c.d(p,{VerificationQueuePage:()=>E});var u=c(467),o=c(773),_=c(177),m=c(4341),h=c(2951),l=c(5873),e=c(4438),f=c(3799),k=c(4086);function b(s,d){if(1&s){const t=e.RV6();e.j41(0,"ion-card",16)(1,"ion-card-content")(2,"div",17)(3,"ion-button",18),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.bulkApprove())}),e.nrm(4,"ion-icon",19),e.EFF(5),e.k0s(),e.j41(6,"ion-button",20),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.bulkFlag())}),e.nrm(7,"ion-icon",21),e.EFF(8),e.k0s(),e.j41(9,"ion-button",22),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.bulkReject())}),e.nrm(10,"ion-icon",23),e.EFF(11),e.k0s()()()()}if(2&s){const t=e.XpG();e.R7$(5),e.SpI(" Approve (",t.selectedItems.size,") "),e.R7$(3),e.SpI(" Flag (",t.selectedItems.size,") "),e.R7$(3),e.SpI(" Reject (",t.selectedItems.size,") ")}}function C(s,d){1&s&&(e.j41(0,"ion-chip",34)(1,"ion-label"),e.EFF(2,"Verified"),e.k0s()())}function F(s,d){if(1&s){const t=e.RV6();e.j41(0,"ion-item")(1,"ion-checkbox",25),e.bIt("ionChange",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.toggleSelection(n.work_update_id))}),e.k0s(),e.j41(2,"ion-label")(3,"h2"),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"p")(8,"strong"),e.EFF(9,"Client:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Date:"),e.k0s(),e.EFF(14),e.nI1(15,"date"),e.j41(16,"strong"),e.EFF(17,"Hours:"),e.k0s(),e.EFF(18),e.k0s(),e.j41(19,"p",26),e.EFF(20),e.nI1(21,"slice"),e.k0s(),e.j41(22,"div",27)(23,"ion-chip",28)(24,"ion-label"),e.EFF(25),e.k0s()(),e.j41(26,"ion-chip",28),e.nrm(27,"ion-icon",29),e.j41(28,"ion-label"),e.EFF(29),e.k0s()(),e.DNE(30,C,3,0,"ion-chip",30),e.k0s(),e.j41(31,"p",31),e.EFF(32),e.nI1(33,"date"),e.k0s()(),e.j41(34,"ion-button",32),e.bIt("click",function(){const n=e.eBV(t).$implicit,r=e.XpG(2);return e.Njj(r.viewComparison(n.work_update_id))}),e.nrm(35,"ion-icon",33),e.EFF(36," View "),e.k0s()()}if(2&s){const t=d.$implicit,i=e.XpG(2);e.R7$(),e.Y8G("checked",i.selectedItems.has(t.work_update_id)),e.R7$(3),e.Lme("",t.first_name," ",t.last_name,""),e.R7$(2),e.Lme("",t.employee_code," \u2022 ",t.project_name,""),e.R7$(4),e.SpI(" ",t.client_name,""),e.R7$(4),e.SpI(" ",e.i5U(15,16,t.update_date,"mediumDate")," \u2022 "),e.R7$(4),e.SpI(" ",t.hours_worked,""),e.R7$(2),e.SpI("",e.brH(21,19,t.work_description,0,100),"..."),e.R7$(3),e.Y8G("color",i.getStatusColor(t.work_update_status)),e.R7$(2),e.JRh(t.work_update_status),e.R7$(),e.Y8G("color",t.timesheet_id?"success":"danger"),e.R7$(),e.Y8G("name",t.timesheet_id?"checkmark-circle-outline":"close-circle-outline"),e.R7$(2),e.JRh(t.timesheet_id?"Has Timesheet":"No Timesheet"),e.R7$(),e.Y8G("ngIf",t.is_verified),e.R7$(2),e.SpI(" Submitted: ",e.i5U(33,23,t.submission_timestamp,"short")," ")}}function P(s,d){if(1&s&&(e.j41(0,"ion-list"),e.DNE(1,F,37,26,"ion-item",24),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.filteredQueue)}}function I(s,d){1&s&&(e.j41(0,"div",35),e.nrm(1,"ion-icon",36),e.j41(2,"p"),e.EFF(3,"No items in verification queue"),e.k0s()())}let E=(()=>{class s{constructor(t,i,n,r,a){this.router=t,this.adminTimesheetService=i,this.toastController=n,this.alertController=r,this.loadingController=a,this.queueItems=[],this.selectedItems=new Set,this.filterStatus="submitted",this.searchTerm="",this.isLoading=!1,(0,h.d)({checkmarkCircleOutline:l.gz2,closeCircleOutline:l.p9N,warningOutline:l.bO5,eyeOutline:l.ov$,filterOutline:l.PyO,checkmarkDoneOutline:l.u8Q})}ngOnInit(){this.loadQueue()}loadQueue(){this.isLoading=!0,this.adminTimesheetService.getVerificationQueue(this.filterStatus).subscribe({next:t=>{this.queueItems=t.verificationQueue,this.isLoading=!1},error:t=>{console.error("Error loading verification queue:",t),this.showToast("Failed to load verification queue","danger"),this.isLoading=!1}})}handleRefresh(t){this.loadQueue(),setTimeout(()=>t.target.complete(),1e3)}onFilterChange(t){this.filterStatus=t.detail.value,this.loadQueue()}toggleSelection(t){this.selectedItems.has(t)?this.selectedItems.delete(t):this.selectedItems.add(t)}toggleSelectAll(){this.selectedItems.size===this.filteredQueue.length?this.selectedItems.clear():this.filteredQueue.forEach(t=>this.selectedItems.add(t.work_update_id))}get filteredQueue(){if(!this.searchTerm)return this.queueItems;const t=this.searchTerm.toLowerCase();return this.queueItems.filter(i=>i.first_name.toLowerCase().includes(t)||i.last_name.toLowerCase().includes(t)||i.employee_code.toLowerCase().includes(t)||i.project_name.toLowerCase().includes(t)||i.client_name.toLowerCase().includes(t))}viewComparison(t){this.router.navigate(["/admin/timesheet/verification-comparison",t])}bulkApprove(){var t=this;return(0,u.A)(function*(){0!==t.selectedItems.size?yield(yield t.alertController.create({header:"Bulk Approve",message:`Approve ${t.selectedItems.size} selected work update(s)?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:()=>t.executeBulkAction("approved")}]})).present():t.showToast("Please select items to approve","warning")})()}bulkFlag(){var t=this;return(0,u.A)(function*(){0!==t.selectedItems.size?yield(yield t.alertController.create({header:"Bulk Flag",message:`Flag ${t.selectedItems.size} selected work update(s)?`,inputs:[{name:"notes",type:"textarea",placeholder:"Add notes for flagging..."}],buttons:[{text:"Cancel",role:"cancel"},{text:"Flag",handler:n=>t.executeBulkAction("flagged",n.notes)}]})).present():t.showToast("Please select items to flag","warning")})()}bulkReject(){var t=this;return(0,u.A)(function*(){0!==t.selectedItems.size?yield(yield t.alertController.create({header:"Bulk Reject",message:`Reject ${t.selectedItems.size} selected work update(s)?`,inputs:[{name:"notes",type:"textarea",placeholder:"Add notes for rejection...",attributes:{required:!0}}],buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",handler:n=>n.notes?t.executeBulkAction("rejected",n.notes):(t.showToast("Please provide notes for rejection","warning"),!1)}]})).present():t.showToast("Please select items to reject","warning")})()}executeBulkAction(t,i){var n=this;return(0,u.A)(function*(){const r=yield n.loadingController.create({message:"Processing bulk action..."});yield r.present();const a={workUpdateIds:Array.from(n.selectedItems),verificationStatus:t,verificationNotes:i||""};n.adminTimesheetService.bulkVerify(a).subscribe({next:g=>{r.dismiss(),n.showToast(`${g.successCount} items ${t} successfully`,"success"),n.selectedItems.clear(),n.loadQueue()},error:g=>{r.dismiss(),console.error("Error in bulk action:",g),n.showToast("Failed to complete bulk action","danger")}})})()}getStatusColor(t){return{submitted:"primary",approved:"success",flagged:"warning",rejected:"danger"}[t]||"medium"}showToast(t){var i=this;return(0,u.A)(function*(n,r="primary"){yield(yield i.toastController.create({message:n,duration:3e3,position:"top",color:r})).present()}).apply(this,arguments)}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(f.Ix),e.rXU(k.p),e.rXU(o.K_),e.rXU(o.hG),e.rXU(o.Xi))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-verification-queue"]],standalone:!0,features:[e.aNF],decls:42,vars:7,consts:[["color","primary"],["slot","start"],["defaultHref","/admin/timesheet/dashboard"],[3,"click"],["name","checkmark-done-outline"],["slot","end"],["slot","fixed",3,"ionRefresh"],[3,"ngModelChange","ionChange","ngModel"],["value","submitted"],["value","approved"],["value","flagged"],["value","rejected"],["placeholder","Search by employee, project...","animated","",3,"ngModelChange","ngModel"],["class","bulk-actions-card",4,"ngIf"],[4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"bulk-actions-card"],[1,"bulk-actions"],["size","small","color","success",3,"click"],["name","checkmark-circle-outline","slot","start"],["size","small","color","warning",3,"click"],["name","warning-outline","slot","start"],["size","small","color","danger",3,"click"],["name","close-circle-outline","slot","start"],[4,"ngFor","ngForOf"],["slot","start",3,"ionChange","checked"],[1,"description"],[1,"chips"],[3,"color"],[3,"name"],["color","tertiary",4,"ngIf"],[1,"submission-time"],["slot","end","fill","outline","size","small",3,"click"],["name","eye-outline"],["color","tertiary"],[1,"empty-state"],["name","checkmark-circle-outline","size","large","color","success"]],template:function(i,n){1&i&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Verification Queue"),e.k0s()(),e.j41(6,"ion-toolbar")(7,"ion-buttons",1)(8,"ion-button",3),e.bIt("click",function(){return n.toggleSelectAll()}),e.nrm(9,"ion-icon",4),e.EFF(10," Select All "),e.k0s()(),e.j41(11,"ion-buttons",5)(12,"ion-badge",0),e.EFF(13),e.k0s()()()(),e.j41(14,"ion-content")(15,"ion-refresher",6),e.bIt("ionRefresh",function(a){return n.handleRefresh(a)}),e.nrm(16,"ion-refresher-content"),e.k0s(),e.j41(17,"ion-card")(18,"ion-card-content")(19,"ion-item")(20,"ion-label"),e.EFF(21,"Status Filter"),e.k0s(),e.j41(22,"ion-select",7),e.mxI("ngModelChange",function(a){return e.DH7(n.filterStatus,a)||(n.filterStatus=a),a}),e.bIt("ionChange",function(a){return n.onFilterChange(a)}),e.j41(23,"ion-select-option",8),e.EFF(24,"Submitted"),e.k0s(),e.j41(25,"ion-select-option",9),e.EFF(26,"Approved"),e.k0s(),e.j41(27,"ion-select-option",10),e.EFF(28,"Flagged"),e.k0s(),e.j41(29,"ion-select-option",11),e.EFF(30,"Rejected"),e.k0s()()(),e.j41(31,"ion-searchbar",12),e.mxI("ngModelChange",function(a){return e.DH7(n.searchTerm,a)||(n.searchTerm=a),a}),e.k0s()()(),e.DNE(32,b,12,3,"ion-card",13),e.j41(33,"ion-card")(34,"ion-card-header")(35,"ion-card-title"),e.EFF(36," Pending Verifications "),e.j41(37,"ion-badge",0),e.EFF(38),e.k0s()()(),e.j41(39,"ion-card-content"),e.DNE(40,P,2,1,"ion-list",14)(41,I,4,0,"div",15),e.k0s()()()),2&i&&(e.R7$(13),e.JRh(n.selectedItems.size),e.R7$(9),e.R50("ngModel",n.filterStatus),e.R7$(9),e.R50("ngModel",n.searchTerm),e.R7$(),e.Y8G("ngIf",n.selectedItems.size>0),e.R7$(6),e.JRh(n.filteredQueue.length),e.R7$(2),e.Y8G("ngIf",n.filteredQueue.length>0),e.R7$(),e.Y8G("ngIf",0===n.filteredQueue.length))},dependencies:[_.MD,_.Sq,_.bT,_.P9,_.vh,m.YN,m.BC,m.vS,o.W9,o.eU,o.BC,o.ai,o.QW,o.el,o.b_,o.I9,o.ME,o.tN,o.Jm,o.iq,o.nf,o.uz,o.he,o.In,o.Nm,o.Ip,o.eY,o.S1,o.ZB,o.To,o.Ki],styles:[".bulk-actions-card[_ngcontent-%COMP%]{margin:16px;background-color:var(--ion-color-light)}.bulk-actions-card[_ngcontent-%COMP%]   .bulk-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}.bulk-actions-card[_ngcontent-%COMP%]   .bulk-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1;min-width:120px}.description[_ngcontent-%COMP%]{font-size:.9em;color:var(--ion-color-medium);margin-top:4px}.chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:4px;margin-top:8px}.chips[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:0;height:24px;font-size:.75em}.chips[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1em;margin-right:2px}.submission-time[_ngcontent-%COMP%]{font-size:.85em;color:var(--ion-color-medium);margin-top:4px;font-style:italic}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:1.1em}ion-checkbox[_ngcontent-%COMP%]{margin-right:12px}ion-card[_ngcontent-%COMP%]{margin:16px;box-shadow:0 2px 8px #0000001a}ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 8px;margin-bottom:8px;border-bottom:1px solid var(--ion-color-light)}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:last-child{border-bottom:none}"]})}}return s})()}}]);