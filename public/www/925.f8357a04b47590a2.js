"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[925],{5925:(J,u,d)=>{d.r(u),d.d(u,{ManagerApprovalsPage:()=>W});var _=d(467),p=d(177),g=d(4341),c=d(7843),m=d(5312),v=d(2951),s=d(5873),e=d(4438),h=d(1626);function F(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",17),e.j41(3,"p"),e.EFF(4,"No pending leave requests"),e.k0s()()())}function f(t,o){if(1&t){const n=e.RV6();e.j41(0,"ion-card",18)(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",21),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"div",22)(12,"div",23),e.nrm(13,"ion-icon",5),e.j41(14,"span")(15,"strong"),e.EFF(16,"Period:"),e.k0s(),e.EFF(17),e.nI1(18,"date"),e.nI1(19,"date"),e.k0s()(),e.j41(20,"div",23),e.nrm(21,"ion-icon",7),e.j41(22,"span")(23,"strong"),e.EFF(24,"Duration:"),e.k0s(),e.EFF(25),e.k0s()(),e.j41(26,"div",23),e.nrm(27,"ion-icon",24),e.j41(28,"span")(29,"strong"),e.EFF(30,"Reason:"),e.k0s(),e.EFF(31),e.k0s()(),e.j41(32,"div",23),e.nrm(33,"ion-icon",5),e.j41(34,"span")(35,"strong"),e.EFF(36,"Applied:"),e.k0s(),e.EFF(37),e.nI1(38,"date"),e.k0s()()(),e.j41(39,"div",25)(40,"ion-button",26),e.bIt("click",function(){const i=e.eBV(n).$implicit,r=e.XpG(2);return e.Njj(r.approveLeave(i))}),e.nrm(41,"ion-icon",27),e.EFF(42," Approve "),e.k0s(),e.j41(43,"ion-button",28),e.bIt("click",function(){const i=e.eBV(n).$implicit,r=e.XpG(2);return e.Njj(r.rejectLeave(i))}),e.nrm(44,"ion-icon",29),e.EFF(45," Reject "),e.k0s()()()()}if(2&t){const n=o.$implicit,a=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(2),e.JRh(n.type_name),e.R7$(8),e.Lme(" ",e.i5U(18,12,n.start_date,"MMM d")," - ",e.i5U(19,15,n.end_date,"MMM d, y"),""),e.R7$(8),e.SpI(" ",n.total_days," day(s)"),e.R7$(6),e.SpI(" ",n.reason,""),e.R7$(6),e.SpI(" ",e.i5U(38,18,n.applied_at,"MMM d, y h:mm a"),""),e.R7$(3),e.Y8G("disabled",a.isLoading),e.R7$(3),e.Y8G("disabled",a.isLoading)}}function M(t,o){if(1&t&&(e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3,"Pending Leave Requests"),e.k0s(),e.j41(4,"ion-badge",14),e.EFF(5),e.k0s()(),e.DNE(6,F,5,0,"ion-card",12)(7,f,46,21,"ion-card",15),e.k0s()),2&t){const n=e.XpG();e.R7$(5),e.JRh(n.pendingLeaves.length),e.R7$(),e.Y8G("ngIf",0===n.pendingLeaves.length),e.R7$(),e.Y8G("ngForOf",n.pendingLeaves)}}function P(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",17),e.j41(3,"p"),e.EFF(4,"No pending timesheets"),e.k0s()()())}function j(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",33),e.j41(2,"span")(3,"strong"),e.EFF(4,"Project:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.Lme(" ",n.project_name," (",n.project_code,")")}}function E(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",24),e.j41(2,"span")(3,"strong"),e.EFF(4,"Description:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_description,"")}}function k(t,o){if(1&t){const n=e.RV6();e.j41(0,"ion-card",18)(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",30),e.EFF(9),e.nI1(10,"titlecase"),e.k0s()()(),e.j41(11,"ion-card-content")(12,"div",31)(13,"div",23),e.nrm(14,"ion-icon",5),e.j41(15,"span")(16,"strong"),e.EFF(17,"Date:"),e.k0s(),e.EFF(18),e.nI1(19,"date"),e.k0s()(),e.j41(20,"div",23),e.nrm(21,"ion-icon",7),e.j41(22,"span")(23,"strong"),e.EFF(24,"Hours:"),e.k0s(),e.EFF(25),e.k0s()(),e.DNE(26,j,6,2,"div",32)(27,E,6,1,"div",32),e.j41(28,"div",23),e.nrm(29,"ion-icon",5),e.j41(30,"span")(31,"strong"),e.EFF(32,"Submitted:"),e.k0s(),e.EFF(33),e.nI1(34,"date"),e.k0s()()(),e.j41(35,"div",25)(36,"ion-button",26),e.bIt("click",function(){const i=e.eBV(n).$implicit,r=e.XpG(2);return e.Njj(r.approveTimesheet(i))}),e.nrm(37,"ion-icon",27),e.EFF(38," Approve "),e.k0s(),e.j41(39,"ion-button",28),e.bIt("click",function(){const i=e.eBV(n).$implicit,r=e.XpG(2);return e.Njj(r.rejectTimesheet(i))}),e.nrm(40,"ion-icon",29),e.EFF(41," Reject "),e.k0s()()()()}if(2&t){const n=o.$implicit,a=e.XpG(2);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(),e.Y8G("color","project"===n.timesheet_type?"primary":"secondary"),e.R7$(),e.SpI(" ",e.bMT(10,13,n.timesheet_type)," "),e.R7$(9),e.SpI(" ",e.i5U(19,15,n.date,"MMM d, y"),""),e.R7$(7),e.SpI(" ",n.total_hours,"h"),e.R7$(),e.Y8G("ngIf",n.project_name),e.R7$(),e.Y8G("ngIf",n.work_description),e.R7$(6),e.SpI(" ",e.i5U(34,18,n.submission_date,"MMM d, y h:mm a"),""),e.R7$(3),e.Y8G("disabled",a.isLoading),e.R7$(3),e.Y8G("disabled",a.isLoading)}}function R(t,o){if(1&t&&(e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3,"Pending Timesheets"),e.k0s(),e.j41(4,"ion-badge",14),e.EFF(5),e.k0s()(),e.DNE(6,P,5,0,"ion-card",12)(7,k,42,21,"ion-card",15),e.k0s()),2&t){const n=e.XpG();e.R7$(5),e.JRh(n.pendingTimesheets.length),e.R7$(),e.Y8G("ngIf",0===n.pendingTimesheets.length),e.R7$(),e.Y8G("ngForOf",n.pendingTimesheets)}}function C(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",36),e.j41(3,"p"),e.EFF(4,"Loading attendance data..."),e.k0s()()())}function b(t,o){if(1&t&&(e.j41(0,"div",37)(1,"ion-card",38)(2,"ion-card-content")(3,"div",39),e.EFF(4),e.k0s(),e.j41(5,"div",40),e.EFF(6,"Total Team"),e.k0s()()(),e.j41(7,"ion-card",41)(8,"ion-card-content")(9,"div",39),e.EFF(10),e.k0s(),e.j41(11,"div",40),e.EFF(12,"Present"),e.k0s()()(),e.j41(13,"ion-card",42)(14,"ion-card-content")(15,"div",39),e.EFF(16),e.k0s(),e.j41(17,"div",40),e.EFF(18,"Absent"),e.k0s()()(),e.j41(19,"ion-card",43)(20,"ion-card-content")(21,"div",39),e.EFF(22),e.k0s(),e.j41(23,"div",40),e.EFF(24,"On Leave"),e.k0s()()()()),2&t){const n=e.XpG(2);e.R7$(4),e.JRh(n.teamAttendance.summary.total_team),e.R7$(6),e.JRh(n.teamAttendance.summary.present),e.R7$(6),e.JRh(n.teamAttendance.summary.absent),e.R7$(6),e.JRh(n.teamAttendance.summary.on_leave)}}function $(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",44),e.j41(3,"p"),e.EFF(4,"No team members found"),e.k0s(),e.j41(5,"small"),e.EFF(6,"You need team members reporting to you to view attendance"),e.k0s()()())}function O(t,o){if(1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",45),e.j41(3,"p"),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"small"),e.EFF(7,"Your team members haven't marked attendance yet"),e.k0s()()()),2&t){const n=e.XpG(2);e.R7$(4),e.SpI("No attendance records for ",e.i5U(5,1,n.selectedDate,"MMM d, y"),"")}}function A(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",47),e.j41(2,"span")(3,"strong"),e.EFF(4,"Check In:"),e.k0s(),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",e.i5U(6,1,n.check_in_time,"h:mm a"),"")}}function x(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",48),e.j41(2,"span")(3,"strong"),e.EFF(4,"Check Out:"),e.k0s(),e.EFF(5),e.nI1(6,"date"),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",e.i5U(6,1,n.check_out_time,"h:mm a"),"")}}function T(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",49),e.j41(2,"span")(3,"strong"),e.EFF(4,"Work Hours:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_hours,"h")}}function y(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",50),e.j41(2,"span")(3,"strong"),e.EFF(4,"Mode:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.work_mode,"")}}function I(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",51),e.j41(2,"span")(3,"strong"),e.EFF(4,"Total Punches:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.total_punches,"")}}function L(t,o){if(1&t&&(e.j41(0,"ion-card",18)(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",30),e.nrm(9,"ion-icon",46),e.EFF(10),e.nI1(11,"titlecase"),e.k0s()()(),e.j41(12,"ion-card-content")(13,"div",22),e.DNE(14,A,7,4,"div",32)(15,x,7,4,"div",32)(16,T,6,1,"div",32)(17,y,6,1,"div",32)(18,I,6,1,"div",32),e.k0s()()()),2&t){const n=o.$implicit,a=e.XpG(3);e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.JRh(n.EmployeeNumber),e.R7$(),e.Y8G("color",a.getAttendanceStatusColor(n.status)),e.R7$(),e.Y8G("name",a.getAttendanceStatusIcon(n.status)),e.R7$(),e.SpI(" ",e.bMT(11,11,n.status)," "),e.R7$(4),e.Y8G("ngIf",n.check_in_time),e.R7$(),e.Y8G("ngIf",n.check_out_time),e.R7$(),e.Y8G("ngIf",n.work_hours),e.R7$(),e.Y8G("ngIf",n.work_mode),e.R7$(),e.Y8G("ngIf",n.total_punches)}}function G(t,o){if(1&t&&(e.j41(0,"div"),e.DNE(1,L,19,13,"ion-card",15),e.k0s()),2&t){const n=e.XpG(2);e.R7$(),e.Y8G("ngForOf",null==n.teamAttendance?null:n.teamAttendance.attendance)}}function D(t,o){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3,"Team Attendance Report"),e.k0s(),e.j41(4,"ion-datetime",34),e.mxI("ngModelChange",function(i){e.eBV(n);const r=e.XpG();return e.DH7(r.selectedDate,i)||(r.selectedDate=i),e.Njj(i)}),e.bIt("ionChange",function(i){e.eBV(n);const r=e.XpG();return e.Njj(r.onDateChange(i))}),e.k0s()(),e.DNE(5,C,5,0,"ion-card",12)(6,b,25,4,"div",35)(7,$,7,0,"ion-card",12)(8,O,8,4,"ion-card",12)(9,G,2,1,"div",12),e.k0s()}if(2&t){const n=e.XpG();e.R7$(4),e.R50("ngModel",n.selectedDate),e.Y8G("max",n.selectedDate),e.R7$(),e.Y8G("ngIf",n.isLoadingAttendance),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance&&n.teamAttendance&&n.teamAttendance.summary),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance&&n.teamAttendance&&0===n.teamAttendance.summary.total_team),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance&&n.teamAttendance&&n.teamAttendance.summary.total_team>0&&0===(null==n.teamAttendance.attendance?null:n.teamAttendance.attendance.length)),e.R7$(),e.Y8G("ngIf",!n.isLoadingAttendance)}}function N(t,o){1&t&&(e.j41(0,"ion-card")(1,"ion-card-content",16),e.nrm(2,"ion-icon",44),e.j41(3,"p"),e.EFF(4,"No team members found"),e.k0s()()())}function w(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",33),e.j41(2,"span")(3,"strong"),e.EFF(4,"Designation:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.designation_name,"")}}function S(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",54),e.j41(2,"span")(3,"strong"),e.EFF(4,"Department:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.department_name,"")}}function Y(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",50),e.j41(2,"span")(3,"strong"),e.EFF(4,"Location:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.location_name,"")}}function X(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",55),e.j41(2,"span")(3,"strong"),e.EFF(4,"Personal Email:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.PersonalEmail,"")}}function U(t,o){if(1&t&&(e.j41(0,"div",23),e.nrm(1,"ion-icon",56),e.j41(2,"span")(3,"strong"),e.EFF(4,"Contact:"),e.k0s(),e.EFF(5),e.k0s()()),2&t){const n=e.XpG().$implicit;e.R7$(5),e.SpI(" ",n.ContactNumber,"")}}function B(t,o){if(1&t){const n=e.RV6();e.j41(0,"ion-card",53),e.bIt("click",function(){const i=e.eBV(n).$implicit,r=e.XpG(2);return e.Njj(r.viewMemberDetails(i))}),e.j41(1,"ion-card-header")(2,"div",19)(3,"div")(4,"ion-card-title"),e.EFF(5),e.k0s(),e.j41(6,"p",20),e.EFF(7),e.k0s()(),e.j41(8,"ion-badge",30),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"div",22),e.DNE(12,w,6,1,"div",32)(13,S,6,1,"div",32)(14,Y,6,1,"div",32)(15,X,6,1,"div",32)(16,U,6,1,"div",32),e.k0s()()()}if(2&t){const n=o.$implicit;e.R7$(5),e.Lme("",n.FirstName," ",n.LastName,""),e.R7$(2),e.Lme("",n.EmployeeNumber," \u2022 ",n.WorkEmail,""),e.R7$(),e.Y8G("color","active"===n.status?"success":"medium"),e.R7$(),e.JRh(n.status),e.R7$(3),e.Y8G("ngIf",n.designation_name),e.R7$(),e.Y8G("ngIf",n.department_name),e.R7$(),e.Y8G("ngIf",n.location_name),e.R7$(),e.Y8G("ngIf",n.PersonalEmail),e.R7$(),e.Y8G("ngIf",n.ContactNumber)}}function V(t,o){if(1&t&&(e.j41(0,"div")(1,"div",13)(2,"h3"),e.EFF(3),e.k0s(),e.j41(4,"ion-badge",21),e.EFF(5),e.k0s()(),e.DNE(6,N,5,0,"ion-card",12)(7,B,17,11,"ion-card",52),e.k0s()),2&t){const n=e.XpG();e.R7$(3),e.JRh((null==n.teamInfo?null:n.teamInfo.message)||"Team Members"),e.R7$(2),e.JRh(n.teamMembers.length),e.R7$(),e.Y8G("ngIf",0===n.teamMembers.length),e.R7$(),e.Y8G("ngForOf",n.teamMembers)}}let W=(()=>{class t{constructor(n,a,i){this.http=n,this.toastController=a,this.alertController=i,this.selectedSegment="leaves",this.pendingLeaves=[],this.pendingTimesheets=[],this.teamMembers=[],this.teamInfo=null,this.teamAttendance={team_members:[],attendance:[],date:(new Date).toISOString().split("T")[0],summary:{total_team:0,present:0,absent:0,on_leave:0}},this.selectedDate=(new Date).toISOString().split("T")[0],this.isLoading=!1,this.isLoadingAttendance=!1,(0,v.d)({checkmarkCircleOutline:s.gz2,closeCircleOutline:s.p9N,timeOutline:s.CVk,calendarOutline:s.RXF,documentTextOutline:s.pXZ,peopleOutline:s.wx_,briefcaseOutline:s.vOb,businessOutline:s.FL4,locationOutline:s.UN$,mailOutline:s.SM1,callOutline:s.bNN,analyticsOutline:s.jwg,hourglassOutline:s.pGP,fingerPrintOutline:s.RBE,checkmarkCircle:s.AUS,closeCircle:s.P0k,calendar:s.BJj,sunny:s.clu,bed:s.M1M,helpCircle:s.MGW})}ngOnInit(){this.loadData()}ionViewWillEnter(){this.loadData()}segmentChanged(n){this.selectedSegment=n.detail.value}loadData(){this.loadPendingLeaves(),this.loadPendingTimesheets(),this.loadTeamMembers(),this.loadTeamAttendance()}loadPendingLeaves(){this.http.get(`${m.c.apiUrl}/leaves/pending`).subscribe({next:n=>{this.pendingLeaves=n,console.log("Pending leaves:",n)},error:n=>{console.error("Error loading pending leaves:",n),this.showToast("Error loading pending leaves","danger")}})}loadPendingTimesheets(){this.http.get(`${m.c.apiUrl}/timesheets/manager/pending-timesheets`).subscribe({next:n=>{this.pendingTimesheets=n,console.log("Pending timesheets:",n)},error:n=>{console.error("Error loading pending timesheets:",n),this.showToast("Error loading pending timesheets","danger")}})}loadTeamMembers(){console.log("Loading team members from:",`${m.c.apiUrl}/employees/my-team/list`),this.http.get(`${m.c.apiUrl}/employees/my-team/list`).subscribe({next:n=>{console.log("Team members loaded successfully:",n),this.teamMembers=n.team||[],this.teamInfo=n},error:n=>{console.error("Error loading team members:",n),console.error("Error status:",n.status),console.error("Error message:",n.message),console.error("Error details:",n.error),this.showToast(n.error?.error||n.message||"Error loading team members","danger")}})}viewMemberDetails(n){console.log("View member details:",n),this.showToast(`Viewing ${n.FirstName} ${n.LastName}`,"primary")}approveLeave(n){var a=this;return(0,_.A)(function*(){yield(yield a.alertController.create({header:"Approve Leave",message:`Approve leave request for ${n.FirstName} ${n.LastName}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:()=>{a.isLoading=!0,a.http.put(`${m.c.apiUrl}/leaves/approve/${n.id}`,{}).subscribe({next:()=>{a.isLoading=!1,a.showToast("Leave approved successfully","success"),a.loadPendingLeaves()},error:r=>{a.isLoading=!1,a.showToast(r.error?.error||"Error approving leave","danger")}})}}]})).present()})()}rejectLeave(n){var a=this;return(0,_.A)(function*(){yield(yield a.alertController.create({header:"Reject Leave",message:`Reject leave request for ${n.FirstName} ${n.LastName}?`,inputs:[{name:"rejection_reason",type:"textarea",placeholder:"Rejection reason (optional)"}],buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",handler:r=>{a.isLoading=!0,a.http.put(`${m.c.apiUrl}/leaves/reject/${n.id}`,{rejection_reason:r.rejection_reason}).subscribe({next:()=>{a.isLoading=!1,a.showToast("Leave rejected","success"),a.loadPendingLeaves()},error:l=>{a.isLoading=!1,a.showToast(l.error?.error||"Error rejecting leave","danger")}})}}]})).present()})()}approveTimesheet(n){var a=this;return(0,_.A)(function*(){yield(yield a.alertController.create({header:"Approve Timesheet",message:`Approve timesheet for ${n.FirstName} ${n.LastName}?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Approve",handler:()=>{a.isLoading=!0,console.log("Approving timesheet:",n),a.http.put(`${m.c.apiUrl}/timesheets/manager/approve/${n.id}`,{}).subscribe({next:r=>{console.log("Approval response:",r),a.isLoading=!1,a.showToast("Timesheet verified successfully","success"),a.loadPendingTimesheets()},error:r=>{console.error("Approval error:",r),a.isLoading=!1,a.showToast(r.error?.error||r.error?.message||r.message||"Error approving timesheet","danger")}})}}]})).present()})()}rejectTimesheet(n){var a=this;return(0,_.A)(function*(){yield(yield a.alertController.create({header:"Reject Timesheet",message:`Reject timesheet for ${n.FirstName} ${n.LastName}?`,inputs:[{name:"rejection_reason",type:"textarea",placeholder:"Rejection reason (required)",attributes:{required:!0}}],buttons:[{text:"Cancel",role:"cancel"},{text:"Reject",handler:r=>r.rejection_reason?.trim()?(a.isLoading=!0,console.log("Rejecting timesheet:",n),a.http.put(`${m.c.apiUrl}/timesheets/manager/reject/${n.id}`,{rejection_reason:r.rejection_reason}).subscribe({next:l=>{console.log("Rejection response:",l),a.isLoading=!1,a.showToast("Timesheet rejected","success"),a.loadPendingTimesheets()},error:l=>{console.error("Rejection error:",l),a.isLoading=!1,a.showToast(l.error?.error||l.error?.message||l.message||"Error rejecting timesheet","danger")}}),!0):(a.showToast("Rejection reason is required","warning"),!1)}]})).present()})()}handleRefresh(n){this.loadData(),setTimeout(()=>n.target.complete(),1e3)}loadTeamAttendance(){this.isLoadingAttendance=!0,console.log(`Fetching team attendance for date: ${this.selectedDate}`),this.http.get(`${m.c.apiUrl}/attendance/report/team?date=${this.selectedDate}`).subscribe({next:n=>{this.teamAttendance=n||{team_members:[],attendance:[],date:this.selectedDate,summary:{total_team:0,present:0,absent:0,on_leave:0}},this.isLoadingAttendance=!1,console.log("Team attendance loaded:",this.teamAttendance),console.log("Summary:",this.teamAttendance.summary),console.log("Attendance records:",this.teamAttendance.attendance?.length||0)},error:n=>{this.isLoadingAttendance=!1,console.error("Error loading team attendance:",n),console.error("Error details:",n.error),this.showToast(`Error loading team attendance: ${n.error?.error||n.message}`,"danger")}})}onDateChange(n){this.selectedDate=n.detail.value.split("T")[0],this.loadTeamAttendance()}getAttendanceStatusColor(n){return{present:"success",absent:"danger","on-leave":"warning",holiday:"medium","week-off":"medium"}[n]||"medium"}getAttendanceStatusIcon(n){return{present:"checkmark-circle",absent:"close-circle","on-leave":"calendar",holiday:"sunny","week-off":"bed"}[n]||"help-circle"}showToast(n,a){var i=this;return(0,_.A)(function*(){yield(yield i.toastController.create({message:n,duration:3e3,color:a,position:"top"})).present()})()}static{this.\u0275fac=function(a){return new(a||t)(e.rXU(h.Qq),e.rXU(c.K_),e.rXU(c.hG))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-manager-approvals"]],standalone:!0,features:[e.aNF],decls:29,vars:6,consts:[[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"approvals-container"],[3,"ionChange","value"],["value","leaves"],["name","calendar-outline"],["value","timesheets"],["name","time-outline"],["value","attendance"],["name","checkmark-circle-outline"],["value","team"],["name","people-outline"],[4,"ngIf"],[1,"section-header"],["color","warning"],["class","approval-card",4,"ngFor","ngForOf"],[1,"empty-state"],["name","checkmark-circle-outline","size","large","color","success"],[1,"approval-card"],[1,"card-header-content"],[1,"employee-details"],["color","primary"],[1,"leave-details"],[1,"detail-row"],["name","document-text-outline"],[1,"action-buttons"],["expand","block","color","success",3,"click","disabled"],["slot","start","name","checkmark-circle-outline"],["expand","block","color","danger","fill","outline",3,"click","disabled"],["slot","start","name","close-circle-outline"],[3,"color"],[1,"timesheet-details"],["class","detail-row",4,"ngIf"],["name","briefcase-outline"],["presentation","date","size","small",3,"ngModelChange","ionChange","ngModel","max"],["class","summary-grid",4,"ngIf"],["name","hourglass-outline","size","large","color","primary"],[1,"summary-grid"],[1,"summary-card"],[1,"summary-value"],[1,"summary-label"],[1,"summary-card","present"],[1,"summary-card","absent"],[1,"summary-card","on-leave"],["name","people-outline","size","large","color","medium"],["name","calendar-outline","size","large","color","medium"],["slot","start",3,"name"],["name","time-outline","color","success"],["name","time-outline","color","danger"],["name","hourglass-outline"],["name","location-outline"],["name","finger-print-outline"],["class","approval-card","button","",3,"click",4,"ngFor","ngForOf"],["button","",1,"approval-card",3,"click"],["name","business-outline"],["name","mail-outline"],["name","call-outline"]],template:function(a,i){1&a&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Team Approvals"),e.k0s()()(),e.j41(4,"ion-content",0)(5,"ion-refresher",1),e.bIt("ionRefresh",function(l){return i.handleRefresh(l)}),e.nrm(6,"ion-refresher-content"),e.k0s(),e.j41(7,"div",2)(8,"ion-segment",3),e.bIt("ionChange",function(l){return i.segmentChanged(l)}),e.j41(9,"ion-segment-button",4),e.nrm(10,"ion-icon",5),e.j41(11,"ion-label"),e.EFF(12,"Leave Requests"),e.k0s()(),e.j41(13,"ion-segment-button",6),e.nrm(14,"ion-icon",7),e.j41(15,"ion-label"),e.EFF(16,"Timesheets"),e.k0s()(),e.j41(17,"ion-segment-button",8),e.nrm(18,"ion-icon",9),e.j41(19,"ion-label"),e.EFF(20,"Attendance"),e.k0s()(),e.j41(21,"ion-segment-button",10),e.nrm(22,"ion-icon",11),e.j41(23,"ion-label"),e.EFF(24,"My Team"),e.k0s()()(),e.DNE(25,M,8,3,"div",12)(26,R,8,3,"div",12)(27,D,10,7,"div",12)(28,V,8,4,"div",12),e.k0s()()),2&a&&(e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(4),e.Y8G("value",i.selectedSegment),e.R7$(17),e.Y8G("ngIf","leaves"===i.selectedSegment),e.R7$(),e.Y8G("ngIf","timesheets"===i.selectedSegment),e.R7$(),e.Y8G("ngIf","attendance"===i.selectedSegment),e.R7$(),e.Y8G("ngIf","team"===i.selectedSegment))},dependencies:[p.MD,p.Sq,p.bT,p.PV,p.vh,g.YN,g.BC,g.vS,c.W9,c.eU,c.BC,c.ai,c.Gp,c.eP,c.b_,c.ME,c.tN,c.I9,c.he,c.In,c.Jm,c.iq,c.To,c.Ki,c.A9],styles:[".approvals-container[_ngcontent-%COMP%]{padding:16px;max-width:800px;margin:0 auto}ion-segment[_ngcontent-%COMP%]{margin-bottom:20px}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:20px 0 12px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600}.approval-card[_ngcontent-%COMP%]{margin-bottom:16px}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:18px;margin-bottom:4px}.approval-card[_ngcontent-%COMP%]   .card-header-content[_ngcontent-%COMP%]   .employee-details[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin:0}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]{margin:16px 0}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-bottom:12px}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:20px;flex-shrink:0;margin-top:2px}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;line-height:1.5}.approval-card[_ngcontent-%COMP%]   .leave-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .approval-card[_ngcontent-%COMP%]   .timesheet-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-right:4px}.approval-card[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:20px}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin-bottom:20px}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{margin:0}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:16px;text-align:center}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:var(--ion-color-primary);margin-bottom:4px}.summary-grid[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);text-transform:uppercase}.summary-grid[_ngcontent-%COMP%]   .summary-card.present[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{color:var(--ion-color-success)}.summary-grid[_ngcontent-%COMP%]   .summary-card.absent[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.summary-grid[_ngcontent-%COMP%]   .summary-card.on-leave[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.section-header[_ngcontent-%COMP%]   ion-datetime[_ngcontent-%COMP%]{max-width:200px}"]})}}return t})()}}]);